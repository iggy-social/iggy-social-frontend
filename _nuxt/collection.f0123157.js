import{H as G,T as q,M as Q}from"./components.eed4080b.js";import{a as w,I as _,G as b,K as v,r as f,o as r,b as l,f as t,e as p,l as c,L as A,M as x,c as I,i as h,t as u,F as N,a0 as $,ai as S,C as J,w as T,aa as K,h as X}from"./entry.b3e49a4d.js";import{u as k,v as F}from"./ethers.be01c75b.js";import{C as Z}from"./ChatFeed.c7fe1707.js";import{C as ee}from"./ConnectWalletButton.e56906fa.js";import{I as U}from"./Image.ec74cddb.js";import{S as te}from"./SwitchChainButton.3d208c09.js";import{W as y}from"./WaitingToast.f0eb3191.js";import{a as E}from"./FileUploadModal.b9ad9f2e.js";import{g as se}from"./domainUtils.625d868b.js";import{a as ie}from"./ipfsUtils.5193581b.js";import{s as oe,b as ne,a as D,c as B}from"./storageUtils.5d0698c1.js";import{g as P}from"./textUtils.f60b0697.js";import"./composables.6c7f5bcf.js";import"./ChatPost.cf9bca2b.js";import"./user.a101a299.js";import"./MintedPostImage.76429a1d.js";import"./site.b9e3a73f.js";const ae={name:"AddImageToCollectionModal",props:["cAddress","mdAddress"],components:{FileUploadInput:E,Image:U},data(){return{componentId:null,imageUrl:null,waiting:!1}},mounted(){this.componentId=this.$.uid},methods:{async addNewImage(){this.waiting=!0;const o=new _(["function addImageToCollection(address nftAddress_, string memory imageUrl_) external"]),s=new b(this.mdAddress,o,this.signer);try{const a=await s.addImageToCollection(this.cAddress,this.imageUrl),i=this.toast({component:y,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),e=await a.wait();e.status===1?(this.toast.dismiss(i),this.toast("You have successfully added new image URL to the NFT collection.",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),this.imageUrl=null,document.getElementById("closeModal-"+this.componentId).click(),this.waiting=!1):(this.toast.dismiss(i),this.waiting=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),console.log(e))}catch(a){console.error(a);try{let i=a.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waiting=!1}},insertImageLink(o){this.imageUrl=o}},setup(){const{signer:o}=k(),s=v();return{signer:o,toast:s}}},re=["aria-labelledby"],le={class:"modal-dialog"},ce={class:"modal-content"},de={class:"modal-header"},he=["id"],me=["id"],ue={class:"modal-body"},pe={class:"mt-2"},ge={key:0},fe=t("p",null,"Upload additional image (and then click Submit below):",-1),_e=t("p",{class:"mt-3"},"Or paste image link here:",-1),be={key:1},ye={key:2,class:"mt-3"},we=t("br",null,null,-1),ve=t("small",null,"If image didn't appear above, then something is wrong with the link you added (wait until the loading indicator completes). If you have an IPFS link, it also helps to cut/paste the same link a couple of times.",-1),ke={class:"modal-footer"},Ce=["disabled"],Ie={key:0,class:"spinner-border spinner-border-sm mx-1",role:"status","aria-hidden":"true"};function Ae(o,s,a,i,e,n){const d=f("FileUploadInput"),m=f("Image");return r(),l("div",{class:"modal fade",id:"addImageToCollectionModal",tabindex:"-1","aria-labelledby":"modalLabel-"+e.componentId,"aria-hidden":"true"},[t("div",le,[t("div",ce,[t("div",de,[t("h1",{class:"modal-title fs-5",id:"modalLabel-"+e.componentId},"Add Image To Collection",8,he),t("button",{id:"closeModal-"+e.componentId,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,8,me)]),t("div",ue,[t("div",pe,[!e.imageUrl&&o.$config.fileUploadEnabled?(r(),l("div",ge,[fe,p(d,{btnCls:"btn btn-primary",storageType:"ipfs",maxFileSize:o.$config.fileUploadSizeLimit,onProcessUploadedFileUrl:n.insertImageLink},null,8,["maxFileSize","onProcessUploadedFileUrl"]),_e])):c("",!0),o.$config.fileUploadEnabled?c("",!0):(r(),l("p",be,"Paste image link here:")),A(t("input",{"onUpdate:modelValue":s[0]||(s[0]=g=>e.imageUrl=g),type:"text",class:"form-control",id:"addImageToCollectionInput"},null,512),[[x,e.imageUrl]]),e.imageUrl?(r(),l("div",ye,[(r(),I(m,{url:e.imageUrl,key:e.imageUrl,cls:"img-thumbnail img-fluid",style:{"max-width":"100px"}},null,8,["url"])),we,ve])):c("",!0)])]),t("div",ke,[t("button",{onClick:s[1]||(s[1]=(...g)=>n.addNewImage&&n.addNewImage(...g)),type:"button",class:"btn btn-primary",disabled:!e.imageUrl||e.waiting},[e.waiting?(r(),l("span",Ie)):c("",!0),h(" Submit to blockchain ")],8,Ce)])])])],8,re)}const xe=w(ae,[["render",Ae]]),Ue={name:"ChangeCollectionPreviewModal",props:["cAddress","mdAddress"],emits:["saveCollection"],components:{FileUploadInput:E,Image:U},data(){return{componentId:null,imageUrl:null,waiting:!1}},mounted(){this.componentId=this.$.uid},methods:{async updateImage(){this.waiting=!0;const o=new _(["function setCollectionPreview(address nftAddress_, string memory collectionPreview_) external"]),s=new b(this.mdAddress,o,this.signer);try{const a=await s.setCollectionPreview(this.cAddress,this.imageUrl),i=this.toast({component:y,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),e=await a.wait();e.status===1?(this.toast.dismiss(i),this.toast("You have updated the NFT collection preview image.",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),this.$emit("saveCollection",{image:this.imageUrl}),this.imageUrl=null,document.getElementById("closeModal-"+this.componentId).click(),this.waiting=!1):(this.toast.dismiss(i),this.waiting=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),console.log(e))}catch(a){console.error(a);try{let i=a.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waiting=!1}},insertImageLink(o){this.imageUrl=o}},setup(){const{signer:o}=k(),s=v();return{signer:o,toast:s}}},Te=["aria-labelledby"],Ne={class:"modal-dialog"},Me={class:"modal-content"},Se={class:"modal-header"},Fe=["id"],De=["id"],Be={class:"modal-body"},Pe=t("p",null,"Change your collection preview image.",-1),$e={class:"mt-4"},Ee={key:0},Le=t("p",null,"Upload new image (and then click Submit below):",-1),Oe=t("p",{class:"mt-3"},"Or paste image link here:",-1),Re={key:1},We={key:2,class:"mt-3"},je=t("br",null,null,-1),ze=t("small",null,"If image didn't appear above, then something is wrong with the link you added (wait until the loading indicator completes). If you have an IPFS link, it also helps to cut/paste the same link a couple of times.",-1),He={class:"modal-footer"},Ve=["disabled"],Ye={key:0,class:"spinner-border spinner-border-sm mx-1",role:"status","aria-hidden":"true"};function Ge(o,s,a,i,e,n){const d=f("FileUploadInput"),m=f("Image");return r(),l("div",{class:"modal fade",id:"changeCollectionPreviewModal",tabindex:"-1","aria-labelledby":"modalLabel-"+e.componentId,"aria-hidden":"true"},[t("div",Ne,[t("div",Me,[t("div",Se,[t("h1",{class:"modal-title fs-5",id:"modalLabel-"+e.componentId},"Change Collection Preview Image",8,Fe),t("button",{id:"closeModal-"+e.componentId,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,8,De)]),t("div",Be,[Pe,t("div",$e,[!e.imageUrl&&o.$config.fileUploadEnabled?(r(),l("div",Ee,[Le,p(d,{btnCls:"btn btn-primary",storageType:"ipfs",maxFileSize:o.$config.fileUploadSizeLimit,onProcessUploadedFileUrl:n.insertImageLink},null,8,["maxFileSize","onProcessUploadedFileUrl"]),Oe])):c("",!0),o.$config.fileUploadEnabled?c("",!0):(r(),l("p",Re,"Paste image link here:")),A(t("input",{"onUpdate:modelValue":s[0]||(s[0]=g=>e.imageUrl=g),type:"text",class:"form-control"},null,512),[[x,e.imageUrl]]),e.imageUrl?(r(),l("div",We,[p(m,{url:e.imageUrl,cls:"img-thumbnail img-fluid",style:{"max-width":"100px"}},null,8,["url"]),je,ze])):c("",!0)])]),t("div",He,[t("button",{onClick:s[1]||(s[1]=(...g)=>n.updateImage&&n.updateImage(...g)),type:"button",class:"btn btn-primary",disabled:!e.imageUrl||e.waiting},[e.waiting?(r(),l("span",Ye)):c("",!0),h(" Submit to blockchain ")],8,Ve)])])])],8,Te)}const qe=w(Ue,[["render",Ge]]),Qe={name:"ChangeDescriptionModal",props:["cAddress","cDescription","mdAddress"],emits:["saveCollection"],data(){return{componentId:null,editDescription:null,waiting:!1}},mounted(){this.componentId=this.$.uid,this.editDescription=this.cDescription},methods:{async update(){this.waiting=!0;const o=new _(["function setDescription(address nftAddress_, string memory description_) external"]),s=new b(this.mdAddress,o,this.signer);try{const a=await s.setDescription(this.cAddress,this.editDescription.replace(/"/g,"'")),i=this.toast({component:y,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),e=await a.wait();e.status===1?(this.toast.dismiss(i),this.toast("You have updated the NFT description.",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),this.$emit("saveCollection",{description:this.editDescription.replace(/"/g,"'")}),this.editDescription=null,document.getElementById("closeModal-"+this.componentId).click(),this.waiting=!1):(this.toast.dismiss(i),this.waiting=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),console.log(e))}catch(a){console.error(a);try{let i=a.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waiting=!1}}},setup(){const{signer:o}=k(),s=v();return{signer:o,toast:s}},watch:{cDescription(){this.editDescription=this.cDescription}}},Je=["aria-labelledby"],Ke={class:"modal-dialog"},Xe={class:"modal-content"},Ze={class:"modal-header"},et=["id"],tt=["id"],st={class:"modal-body"},it=t("p",null,"Change your collection description.",-1),ot={class:"mt-4"},nt=["for"],at=t("strong",null," Enter new description: ",-1),rt=[at],lt=["id"],ct={class:"modal-footer"},dt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1),ht=["disabled"],mt={key:0,class:"spinner-border spinner-border-sm mx-1",role:"status","aria-hidden":"true"};function ut(o,s,a,i,e,n){return r(),l("div",{class:"modal fade",id:"changeDescriptionModal",tabindex:"-1","aria-labelledby":"modalLabel-"+e.componentId,"aria-hidden":"true"},[t("div",Ke,[t("div",Xe,[t("div",Ze,[t("h1",{class:"modal-title fs-5",id:"modalLabel-"+e.componentId},"Change description",8,et),t("button",{id:"closeModal-"+e.componentId,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,8,tt)]),t("div",st,[it,t("div",ot,[t("label",{for:"input-"+e.componentId,class:"form-label"},rt,8,nt),A(t("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>e.editDescription=d),type:"text",class:"form-control",id:"input-"+e.componentId},null,8,lt),[[x,e.editDescription]])])]),t("div",ct,[dt,t("button",{onClick:s[1]||(s[1]=(...d)=>n.update&&n.update(...d)),type:"button",class:"btn btn-primary",disabled:!e.editDescription||e.waiting},[e.waiting?(r(),l("span",mt)):c("",!0),h(" Submit ")],8,ht)])])])],8,Je)}const pt=w(Qe,[["render",ut]]),gt={name:"ChangeNftTypeModal",props:["cAddress","cType","mdAddress"],emits:["saveCollection"],data(){return{componentId:null,editImageMetadataUrl:null,editImageOptions:[{description:"0) Onchain image(s)"},{description:"1) Static metadata URL"},{description:"2) Generative metadata (.json)"},{description:"3) Generative metadata"}],editImagePreviewUrl:"",typeChoice:0,waitingMetadata:!1}},mounted(){this.componentId=this.$.uid},methods:{async updateMetadata(){this.waitingMetadata=!0;const o=new _(["function setMdTypeAndUrlOrImage(address nftAddress_, uint256 mdType_, string memory mdUrlOrImage_, string memory collectionImage_) external"]),s=new b(this.mdAddress,o,this.signer);this.typeChoice===0&&(this.editImagePreviewUrl=this.editImageMetadataUrl),this.editImagePreviewUrl===null&&(this.editImagePreviewUrl="");try{const a=await s.setMdTypeAndUrlOrImage(this.cAddress,this.typeChoice,this.editImageMetadataUrl,this.editImagePreviewUrl),i=this.toast({component:y,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),e=await a.wait();e.status===1?(this.toast.dismiss(i),this.toast("You have updated the NFT image and/or metadata URL.",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),this.$emit("saveCollection",{type:this.typeChoice,image:this.editImagePreviewUrl}),this.editImageMetadataUrl=null,this.editImagePreviewUrl="",document.getElementById("closeModal-"+this.componentId).click(),this.waitingMetadata=!1):(this.toast.dismiss(i),this.waitingMetadata=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),console.log(e))}catch(a){console.error(a);try{let i=a.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingMetadata=!1}}},setup(){const{signer:o}=k(),s=v();return{signer:o,toast:s}}},ft={class:"modal fade",id:"changeNftTypeModal",tabindex:"-1","aria-labelledby":"changeNftTypeModalLabel","aria-hidden":"true"},_t={class:"modal-dialog"},bt={class:"modal-content"},yt={class:"modal-header"},wt=t("h1",{class:"modal-title fs-5",id:"changeNftTypeModalLabel"},"Change NFT Type",-1),vt=["id"],kt={class:"modal-body"},Ct=t("p",null,[t("strong",null,"Pick one of these options:")],-1),It={class:"dropdown"},At={class:"btn btn-primary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},xt={class:"dropdown-menu text-break"},Ut=["onClick"],Tt={class:"mt-3"},Nt={key:0},Mt={key:1},St=t("strong",null,"file",-1),Ft={key:2},Dt=t("strong",null,"folder",-1),Bt={key:3},Pt=t("strong",null,"folder",-1),$t={class:"mt-4"},Et={for:"imageMetadataUrl",class:"form-label"},Lt={key:0},Ot={key:1},Rt={key:2},Wt={key:3},jt={key:0,class:"mt-4"},zt=t("label",{for:"collectionPreviewUrl",class:"form-label"},[t("strong",null," Change collection preview image (optional): ")],-1),Ht=t("div",{id:"previewImageHelp",class:"form-text"}," This is a preview image for the whole collection, not for individual NFTs. ",-1),Vt={class:"modal-footer"},Yt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1),Gt=["disabled"],qt={key:0,class:"spinner-border spinner-border-sm mx-1",role:"status","aria-hidden":"true"};function Qt(o,s,a,i,e,n){return r(),l("div",ft,[t("div",_t,[t("div",bt,[t("div",yt,[wt,t("button",{id:"closeModal-"+e.componentId,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,8,vt)]),t("div",kt,[t("p",null,"Current type of this NFT collection is: "+u(e.editImageOptions[a.cType].description)+".",1),Ct,t("div",It,[t("button",At,u(e.editImageOptions[e.typeChoice].description),1),t("div",xt,[(r(!0),l(N,null,$(e.editImageOptions,(d,m)=>(r(),l("span",{key:m,onClick:g=>e.typeChoice=m,class:"dropdown-item cursor-pointer"},u(d.description),9,Ut))),128))])]),t("div",Tt,[e.typeChoice==0?(r(),l("p",Nt,' The "Onchain image(s)" option means that metadata is stored onchain (within the smart contract itself). Use this option if you want to add an image URL in the field below (not a metadata file). This is the default option for NFTs created through this launchpad. ')):c("",!0),e.typeChoice==1?(r(),l("p",Mt,[h(' The "Static metadata URL" option means that all the NFTs in the collection have the same (static) image and meta data. The metadata is stored offchain, usually on IPFS or on a centralized server. Use this option if you have a URL of a single metadata '),St,h(" (all NFTs have the same metadata and image). ")])):c("",!0),e.typeChoice==2?(r(),l("p",Ft,[h(' The "Generative metadata (.json)" option means that all the NFTs in the collection have a different image and different meta data. The metadata is stored offchain, usually on IPFS or on a centralized server. Use this option if you have a metadata '),Dt,h(" URL with multiple metadata files in it, where these files HAVE a .json extension. ")])):c("",!0),e.typeChoice==3?(r(),l("p",Bt,[h(' The "Generative metadata" option means that all the NFTs in the collection have a different image and different meta data. The metadata is stored offchain, usually on IPFS or on a centralized server. Use this option if you have a metadata '),Pt,h(" URL with multiple metadata files in it, where these files DO NOT HAVE a .json extension. ")])):c("",!0)]),t("div",$t,[t("label",Et,[t("strong",null,[h(" Enter "),e.typeChoice==0?(r(),l("span",Lt,"image URL:")):c("",!0),e.typeChoice==1?(r(),l("span",Ot,"metadata file URL:")):c("",!0),e.typeChoice==2?(r(),l("span",Rt,"metadata folder URL:")):c("",!0),e.typeChoice==3?(r(),l("span",Wt,"metadata folder URL:")):c("",!0)])]),A(t("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>e.editImageMetadataUrl=d),type:"text",class:"form-control",id:"imageMetadataUrl"},null,512),[[x,e.editImageMetadataUrl]])]),e.typeChoice>0?(r(),l("div",jt,[zt,A(t("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>e.editImagePreviewUrl=d),type:"text",class:"form-control",id:"collectionPreviewUrl","aria-describedby":"previewImageHelp"},null,512),[[x,e.editImagePreviewUrl]]),Ht])):c("",!0)]),t("div",Vt,[Yt,t("button",{onClick:s[2]||(s[2]=(...d)=>n.updateMetadata&&n.updateMetadata(...d)),type:"button",class:"btn btn-primary",disabled:!e.editImageMetadataUrl||e.waitingMetadata},[e.waitingMetadata?(r(),l("span",qt)):c("",!0),h(" Submit ")],8,Gt)])])])])}const Jt=w(gt,[["render",Qt]]),Kt={name:"RemoveImageFromCollectionModal",props:["cAddress","mdAddress"],data(){return{componentId:null,images:[],imageUrl:null,waitingLoad:!1,waitingRemove:!1}},components:{Image:U},mounted(){this.componentId=this.$.uid},methods:{async loadImages(){this.waitingLoad=!0;const o=new _(["function getCollectionImages(address nftAddress_) external view returns (string[] memory)"]),s=new b(this.mdAddress,o,this.signer);try{this.images=await s.getCollectionImages(this.cAddress),this.waitingLoad=!1}catch(a){console.error(a),this.waitingLoad=!1}},async removeImage(o){this.waitingRemove=!0;const s=new _(["function removeImageFromCollectionByIndex(address nftAddress_, uint256 index_) external"]),a=new b(this.mdAddress,s,this.signer);try{const i=await a.removeImageFromCollectionByIndex(this.cAddress,o),e=this.toast({component:y,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+i.hash,"_blank").focus()}),n=await i.wait();if(n.status===1){this.toast.dismiss(e),this.toast("You have successfully removed an image from the NFT collection.",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+i.hash,"_blank").focus()}),this.imageUrl=null;const d=[...this.images];d.splice(o,1),this.images=d,this.waitingRemove=!1}else this.toast.dismiss(e),this.waitingRemove=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+i.hash,"_blank").focus()}),console.log(n)}catch(i){console.error(i);try{let e=i.message.split("reason=")[1];e=e.split(", method=")[0],e=e.replace(/"/g,""),e=e.replace("execution reverted:","Error:"),console.log(e),this.toast(e,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingRemove=!1}}},setup(){const{signer:o}=k(),s=v();return{signer:o,toast:s}}},Xt=["aria-labelledby"],Zt={class:"modal-dialog"},es={class:"modal-content"},ts={class:"modal-header"},ss=["id"],is=["id"],os={class:"modal-body"},ns={class:"row"},as=["for"],rs=t("strong",null," Load images from collection: ",-1),ls=[rs],cs=["disabled"],ds={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},hs={key:0,class:"row mt-3"},ms={class:"card"},us={class:"card-body"},ps={class:"row"},gs=["onClick","disabled"],fs=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1);function _s(o,s,a,i,e,n){const d=f("Image");return r(),l("div",{class:"modal fade",id:"removeImageFromCollectionModal",tabindex:"-1","aria-labelledby":"modalLabel-"+e.componentId,"aria-hidden":"true"},[t("div",Zt,[t("div",es,[t("div",ts,[t("h1",{class:"modal-title fs-5",id:"modalLabel-"+e.componentId},"Remove Image From Collection",8,ss),t("button",{id:"closeModal-"+e.componentId,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,8,is)]),t("div",os,[t("div",ns,[t("label",{for:"input-"+e.componentId,class:"form-label"},ls,8,as)]),t("div",null,[t("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=(...m)=>n.loadImages&&n.loadImages(...m)),disabled:e.waitingLoad},[e.waitingLoad?(r(),l("span",ds)):c("",!0),h(" Load images ")],8,cs)]),e.images?(r(),l("div",hs,[(r(!0),l(N,null,$(e.images,(m,g)=>(r(),l("div",{key:m,class:"col-md-4 mb-3"},[t("div",ms,[p(d,{url:m,alt:"Image",cls:"card-img-top"},null,8,["url"]),t("div",us,[t("div",ps,[t("button",{class:"btn btn-danger",onClick:M=>n.removeImage(g),disabled:e.waitingRemove||e.images.length==1}," Delete ",8,gs)])])])]))),128))])):c("",!0)]),fs])])],8,Xt)}const bs=w(Kt,[["render",_s]]),ys={name:"NftCollection",data(){return{cAuthorAddress:null,cAuthorDomain:null,cDescription:null,cImage:null,cName:null,cSupply:null,cType:0,mdAddress:null,nativeNft:!0,priceBuyWei:null,priceSellWei:null,userTokenId:null,waitingBuy:!1,waitingData:!1,waitingSell:!1}},components:{AddImageToCollectionModal:xe,ChangeCollectionPreviewModal:qe,ChangeDescriptionModal:pt,ChangeNftTypeModal:Jt,ChatFeed:Z,ConnectWalletButton:ee,Image:U,RemoveImageFromCollectionModal:bs,SwitchChainButton:te,WaitingToast:y},mounted(){if(this.cAddress){if(!S(this.cAddress))return this.toast("Invalid NFT address.",{type:"error"}),this.$router.push({path:"/"});this.getCollectionDetails()}},computed:{cAddress(){return this.$route.query?.id?this.$route.query.id:null},collectionExplorerLink(){return this.$config.blockExplorerBaseUrl+"/token/"+this.cAddress},collectionMarketplaceLink(){return this.$config.marketplaceNftCollectionBaseUrl+this.cAddress},getUsernameOrFullAddress(){if(this.cAuthorDomain){let o=String(this.cAuthorDomain).replace(this.$config.tldName,"");return P(o)+this.$config.tldName}else return this.cAuthorAddress},getUsernameOrShortAddress(){if(this.cAuthorAddress)if(this.cAuthorDomain){let o=String(this.cAuthorDomain).replace(this.$config.tldName,"");return P(o)+this.$config.tldName}else return F(this.cAuthorAddress);return null},isCurrentAddressOwner(){return this.cAuthorAddress&&this.address?String(this.cAuthorAddress).toLowerCase()===String(this.address).toLowerCase():!1},isSupportedChain(){return this.chainId===this.$config.supportedChainId}},methods:{getDomainName:se,async buyNft(){this.waitingBuy=!0;const o=new _(["function getBurnPrice() public view returns (uint256)","function getMintPrice() public view returns (uint256)","function mint(address to) external payable returns (uint256)","function tokenOfOwnerByIndex(address owner, uint256 index) public view returns (uint256)","function totalSupply() public view returns (uint256)"]),s=new b(this.cAddress,o,this.signer);this.priceBuyWei=await s.getMintPrice();try{const a=await s.mint(this.address,{value:this.priceBuyWei}),i=this.toast({component:y,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),e=await a.wait();if(e.status===1){this.toast.dismiss(i),this.toast("You have successfully bought the NFT! Congrats!",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),this.priceBuyWei=await s.getMintPrice(),this.priceSellWei=await s.getBurnPrice();try{this.userTokenId=await s.tokenOfOwnerByIndex(this.address,0)}catch{this.userTokenId=null}this.cSupply=await s.totalSupply(),this.waitingBuy=!1}else this.toast.dismiss(i),this.waitingBuy=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),console.log(e)}catch(a){console.error(a);try{let i=a.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingBuy=!1}},async fetchUserDomain(){if(this.cAuthorAddress){const o=this.$getFallbackProvider(this.$config.supportedChainId),s=await this.getDomainName(this.cAuthorAddress,o);s&&(this.cAuthorDomain=s,oe(window,this.cAuthorAddress,s+this.$config.tldName))}},formatPrice(o){if(o===null)return null;const s=Number(J(o));return s>100?s.toFixed(0):s>1?s.toFixed(2):s>.1?s.toFixed(4):s>.01?s.toFixed(5):s>.001?s.toFixed(6):s>1e-4?s.toFixed(7):s>1e-5?s.toFixed(8):s>1e-6?s.toFixed(9):s},async getCollectionDetails(o=!1){this.waitingData=!0;let s=ne(window,this.cAddress);o&&(console.log("Refreshing collection metadata..."),s=null);let a=this.$getFallbackProvider(this.$config.supportedChainId);this.isActivated&&this.chainId===this.$config.supportedChainId&&(a=this.signer);const i=new _(["function getBurnPrice() public view returns (uint256)","function getMintPrice() public view returns (uint256)","function metadataAddress() public view returns (address)","function name() public view returns (string memory)","function owner() public view returns (address)","function tokenOfOwnerByIndex(address owner, uint256 index) public view returns (uint256)","function totalSupply() public view returns (uint256)"]),e=new b(this.cAddress,i,a);if(console.log("Fetching collection details..."),s?.mdAddress)this.mdAddress=s.mdAddress;else try{this.mdAddress=await e.metadataAddress()}catch{return this.getCollectionDetailsFallback()}const n=new _(["function getCollectionDescription(address) public view returns (string memory)","function getCollectionMetadataType(address nftAddress_) external view returns (uint256)","function getCollectionPreviewImage(address) public view returns (string memory)"]),d=new b(this.mdAddress,n,a);try{this.priceBuyWei=await e.getMintPrice(),this.priceSellWei=await e.getBurnPrice()}catch{return this.getCollectionDetailsFallback()}s?.image?this.cImage=s.image:this.cImage=await d.getCollectionPreviewImage(this.cAddress);const m=ie(this.cImage);m&&(this.cImage=m),s?.description&&s.description!==""&&s.description!==null?this.cDescription=s.description:this.cDescription=await d.getCollectionDescription(this.cAddress),s?.type>=0?this.cType=s.type:this.cType=Number(await d.getCollectionMetadataType(this.cAddress)),s?.name?this.cName=s.name:this.cName=await e.name();try{this.userTokenId=await e.tokenOfOwnerByIndex(this.address,0)}catch{this.userTokenId=null}this.waitingData=!1,this.cSupply=await e.totalSupply(),s?.authorAddress?(this.cAuthorAddress=s.authorAddress,this.cAuthorDomain=s.authorDomain):this.cAuthorAddress=await e.owner(),this.cAuthorDomain=D(window,this.cAuthorAddress),this.cAuthorDomain||this.fetchUserDomain(),s={address:this.cAddress,authorAddress:this.cAuthorAddress,authorDomain:this.cAuthorDomain,description:this.cDescription,image:this.cImage,mdAddress:this.mdAddress,name:this.cName,type:this.cType},B(window,this.cAddress,s)},async getCollectionDetailsFallback(){console.log("Fetching collection details via fallback method..."),this.nativeNft=!1;let o=this.$getFallbackProvider(this.$config.supportedChainId);this.isActivated&&this.chainId===this.$config.supportedChainId&&(o=this.signer);const s=new _(["function name() public view returns (string memory)","function owner() public view returns (address)","function tokenURI(uint256 tokenId) public view returns (string memory)","function totalSupply() public view returns (uint256)","function uri(uint256 tokenId) public view returns (string memory)"]),a=new b(this.cAddress,s,o);this.cName=await a.name();let i;try{i=await a.tokenURI(1)}catch{i=await a.uri(1)}if(i.startsWith("data:application/json;")){const e=JSON.parse(atob(i.replace("data:application/json;base64,","")));!this.cName&&e?.name&&(this.cName=e.name.replace("#1","")),e?.description&&(this.cDescription=e.description),e?.image&&(this.cImage=e.image),e?.external_url&&(this.cExternalUrl=e.external_url),e?.audio_url&&(this.audioUrl=e.audio_url),e?.animation_url&&(this.videoUrl=e.animation_url),e?.youtube_url&&(this.youtubeUrl=e.youtube_url)}else try{const n=(await axios.get(i)).data;!this.cName&&n?.name&&(this.cName=n.name.replace("#1","")),n?.description&&(this.cDescription=n.description),n?.image&&(this.cImage=n.image),n?.external_url&&(this.cExternalUrl=n.external_url),n?.audio_url&&(this.audioUrl=n.audio_url),n?.animation_url&&(this.videoUrl=n.animation_url),n?.youtube_url&&(this.youtubeUrl=n.youtube_url)}catch(e){console.error(e)}try{this.cSupply=await a.totalSupply()}catch{console.log("No totalSupply function in the contract.")}try{this.cAuthorAddress=await a.owner(),this.cAuthorDomain=D(window,this.cAuthorAddress),this.cAuthorDomain||this.fetchUserDomain()}catch{console.log("No owner variable in the contract.")}this.waitingData=!1},saveCollection(o){o?.type&&(this.cType=o.type),o?.description&&(this.cDescription=o.description),o?.image&&(this.cImage=o.image);const s={address:this.cAddress,authorAddress:this.cAuthorAddress,authorDomain:this.cAuthorDomain,description:this.cDescription,image:this.cImage,mdAddress:this.mdAddress,name:this.cName,type:this.cType};B(window,this.cAddress,s)},async sellNft(){this.waitingSell=!0;const o=new _(["function getBurnPrice() public view returns (uint256)","function getMintPrice() public view returns (uint256)","function burn(uint256 tokenId) external returns (uint256)","function tokenOfOwnerByIndex(address owner, uint256 index) public view returns (uint256)","function totalSupply() public view returns (uint256)"]),s=new b(this.cAddress,o,this.signer);try{const a=await s.burn(this.userTokenId),i=this.toast({component:y,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),e=await a.wait();if(e.status===1){this.toast.dismiss(i),this.toast("You have dumped the NFT.",{type:"success",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),this.priceBuyWei=await s.getMintPrice(),this.priceSellWei=await s.getBurnPrice();try{this.userTokenId=await s.tokenOfOwnerByIndex(this.address,0)}catch{this.userTokenId=null}this.cSupply=await s.totalSupply(),this.waitingSell=!1}else this.toast.dismiss(i),this.waitingSell=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.blockExplorerBaseUrl+"/tx/"+a.hash,"_blank").focus()}),console.log(e)}catch(a){console.error(a);try{let i=a.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingSell=!1}}},setup(){const{address:o,chainId:s,isActivated:a,signer:i}=k(),e=v();return{address:o,chainId:s,isActivated:a,shortenAddress:F,signer:i,toast:e}},watch:{address(o,s){s&&s!==o&&!this.waitingData&&this.getCollectionDetails()},chainId(o,s){o==this.$config.supportedChainId&&s!==o&&!this.waitingData&&this.getCollectionDetails()},cAddress(o,s){if(o&&s&&o!==s&&this.cAddress&&this.$route.path==="/nft/collection"){if(!S(this.cAddress))return this.toast("Invalid NFT address.",{type:"error"}),this.$router.push({path:"/"});this.getCollectionDetails()}}}},ws={class:"card border"},vs={class:"card-body"},ks={class:"fs-3"},Cs={key:0,class:"mb-3 mt-3"},Is={key:1,class:"mb-3 mt-3"},As={key:2,class:"d-flex justify-content-center mb-3"},xs=t("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1),Us=[xs],Ts={class:"row"},Ns={class:"col-md-5 text-center mb-3"},Ms={key:1,class:"dropdown mt-3"},Ss=t("button",{class:"btn btn-outline-primary btn-sm dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Actions ",-1),Fs={class:"dropdown-menu"},Ds={key:0},Bs=t("span",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#changeDescriptionModal"}," Change description ",-1),Ps=[Bs],$s={key:1},Es=t("span",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#changeCollectionPreviewModal"}," Change collection preview image ",-1),Ls=[Es],Os={key:2},Rs=t("span",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#addImageToCollectionModal"}," Add additional image to collection ",-1),Ws=[Rs],js={key:3},zs=t("span",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#removeImageFromCollectionModal"}," Remove image from collection ",-1),Hs=[zs],Vs={key:4},Ys=t("span",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#changeNftTypeModal"}," Change collection type ",-1),Gs=[Ys],qs={class:"col-md-7"},Qs={class:"mt-1 mb-4 muted-text",style:{"font-size":"14px"}},Js={class:"me-4"},Ks=t("i",{class:"bi bi-file-earmark-text-fill me-1"},null,-1),Xs={key:0,class:"me-4"},Zs=t("i",{class:"bi bi-coin me-1"},null,-1),ei={class:"me-4"},ti=t("i",{class:"bi bi-file-earmark-binary me-1"},null,-1),si={class:"me-4"},ii=t("i",{class:"bi bi-box-arrow-up-right me-2"},null,-1),oi=["href"],ni={key:0},ai={key:1,class:"dropdown"},ri=t("i",{class:"bi bi-box-arrow-up-right me-2"},null,-1),li=t("span",{class:"dropdown-toggle","data-bs-toggle":"dropdown",role:"button","aria-haspopup":"true","aria-expanded":"false"},[t("span",null,"See all NFTs in the collection")],-1),ci={class:"dropdown-menu dropdown-menu-end"},di=["href"],hi=t("i",{class:"bi bi-box-arrow-up-right me-1"},null,-1),mi=["href"],ui=t("i",{class:"bi bi-box-arrow-up-right me-1"},null,-1),pi={key:0,class:"row mb-3"},gi={key:0,class:"d-grid gap-2 col"},fi={key:1,class:"d-grid gap-2 col"},_i=["disabled"],bi={key:0,class:"spinner-border spinner-border-sm mx-1",role:"status","aria-hidden":"true"},yi={key:2,class:"d-grid gap-2 col"},wi=["disabled"],vi={key:0,class:"spinner-border spinner-border-sm mx-1",role:"status","aria-hidden":"true"},ki={key:1},Ci={key:0,class:"card border mt-3 scroll-500"},Ii=X('<div class="card-body"><h5 class="mb-2 mt-3 text-center">Buy an NFT to see the chat</h5><div class="d-flex justify-content-center"><div class="col-12 col-lg-8"><p class="text-break text-center mt-3 mb-4"> This NFT&#39;s chat is open only for NFT holders. Buy an NFT to see the chat and talk with the NFT creator and other NFT holders. </p></div></div></div>',1),Ai=[Ii];function xi(o,s,a,i,e,n){const d=q,m=Q,g=G,M=f("Image"),L=K,O=f("ConnectWalletButton"),R=f("SwitchChainButton"),W=f("ChatFeed"),j=f("AddImageToCollectionModal"),z=f("ChangeCollectionPreviewModal"),H=f("ChangeDescriptionModal"),V=f("ChangeNftTypeModal"),Y=f("RemoveImageFromCollectionModal");return r(),l(N,null,[p(g,null,{default:T(()=>[p(d,null,{default:T(()=>[h("NFT Collection Details | "+u(o.$config.projectMetadataTitle),1)]),_:1}),p(m,{property:"og:title",content:"NFT Collection Details | "+o.$config.projectMetadataTitle},null,8,["content"]),p(m,{name:"description",content:"Check this NFT collection on "+o.$config.projectName+"!"},null,8,["content"]),p(m,{property:"og:image",content:o.$config.projectUrl+o.$config.previewImageNftCollection},null,8,["content"]),p(m,{property:"og:description",content:"Check this NFT collection on "+o.$config.projectName+"!"},null,8,["content"]),p(m,{name:"twitter:image",content:o.$config.projectUrl+o.$config.previewImageNftCollection},null,8,["content"]),p(m,{name:"twitter:description",content:"Check this NFT collection on "+o.$config.projectName+"!"},null,8,["content"])]),_:1}),t("div",ws,[t("div",vs,[t("p",ks,[t("i",{onClick:s[0]||(s[0]=C=>o.$router.push({path:"/nft"})),class:"bi bi-arrow-left-circle cursor-pointer"})]),e.cName?c("",!0):(r(),l("h3",Cs,"NFT Collection Details")),e.cName?(r(),l("h3",Is,u(e.cName),1)):c("",!0),e.waitingData?(r(),l("div",As,Us)):c("",!0),t("div",Ts,[t("div",Ns,[e.cImage?(r(),I(M,{url:e.cImage,cls:"img-fluid img-thumbnail rounded col-12",alt:e.cName,key:e.cImage},null,8,["url","alt"])):c("",!0),e.nativeNft?(r(),l("div",Ms,[Ss,t("ul",Fs,[n.isCurrentAddressOwner?(r(),l("li",Ds,Ps)):c("",!0),n.isCurrentAddressOwner?(r(),l("li",$s,Ls)):c("",!0),n.isCurrentAddressOwner&&e.cType==0?(r(),l("li",Os,Ws)):c("",!0),n.isCurrentAddressOwner&&e.cType==0?(r(),l("li",js,Hs)):c("",!0),n.isCurrentAddressOwner?(r(),l("li",Vs,Gs)):c("",!0),t("li",null,[t("span",{class:"dropdown-item cursor-pointer",onClick:s[1]||(s[1]=C=>n.getCollectionDetails(!0))},"Refresh metadata")])])])):c("",!0)]),t("div",qs,[t("div",Qs,[t("p",Js,[Ks,h(" "+u(e.cDescription),1)]),e.nativeNft?(r(),l("p",Xs,[Zs,h(" Buy/Sell price: "+u(n.formatPrice(e.priceBuyWei))+" "+u(o.$config.tokenSymbol)+" / "+u(n.formatPrice(e.priceSellWei))+" "+u(o.$config.tokenSymbol),1)])):c("",!0),t("p",ei,[ti,h(" "+u(e.cSupply)+" NFTs minted ",1)]),t("p",si,[ii,t("a",{href:o.$config.blockExplorerBaseUrl+"/address/"+n.cAddress,target:"_blank",style:{"text-decoration":"none"}},u(i.shortenAddress(n.cAddress)),9,oi),n.getUsernameOrShortAddress?(r(),l("span",ni,[h(" by "),p(L,{to:"/profile/?id="+String(n.getUsernameOrFullAddress)},{default:T(()=>[h(u(n.getUsernameOrShortAddress),1)]),_:1},8,["to"])])):c("",!0)]),n.cAddress?(r(),l("div",ai,[ri,li,t("div",ci,[t("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:n.collectionMarketplaceLink},[hi,h(" See NFTs on NFT marketplace ")],8,di),t("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:n.collectionExplorerLink},[ui,h(" See NFTs on block explorer ")],8,mi)])])):c("",!0)]),e.nativeNft?(r(),l("div",pi,[!i.isActivated||!n.isSupportedChain?(r(),l("div",gi,[i.isActivated?c("",!0):(r(),I(O,{key:0,class:"btn btn-primary",btnText:"Connect wallet"})),i.isActivated&&!n.isSupportedChain?(r(),I(R,{key:1})):c("",!0)])):c("",!0),i.isActivated&&n.isSupportedChain?(r(),l("div",fi,[t("button",{onClick:s[2]||(s[2]=(...C)=>n.buyNft&&n.buyNft(...C)),class:"btn btn-primary",type:"button",disabled:e.waitingData||e.waitingBuy},[e.waitingBuy?(r(),l("span",bi)):c("",!0),h(" Buy for "+u(n.formatPrice(e.priceBuyWei))+" "+u(o.$config.tokenSymbol),1)],8,_i)])):c("",!0),i.isActivated&&n.isSupportedChain?(r(),l("div",yi,[t("button",{onClick:s[3]||(s[3]=(...C)=>n.sellNft&&n.sellNft(...C)),class:"btn btn-primary",type:"button",disabled:e.waitingData||e.waitingSell||!e.userTokenId||e.priceSellWei==0},[e.waitingSell?(r(),l("span",vi)):c("",!0),h(" Sell for "+u(n.formatPrice(e.priceSellWei))+" "+u(o.$config.tokenSymbol),1)],8,wi)])):c("",!0)])):c("",!0),i.isActivated&&n.isSupportedChain&&e.nativeNft?(r(),l("small",ki,[t("em",null," (Price may still change after pressing the button, so make sure to check the "+u(o.$config.tokenSymbol)+" amount in wallet.) ",1)])):c("",!0)])])])]),!e.userTokenId&&e.nativeNft?(r(),l("div",Ci,Ai)):c("",!0),o.$config.chatChannels.nftLaunchpad&&e.userTokenId?(r(),I(W,{key:n.cAddress,class:"mt-3 scroll-500",showQuotedPost:o.$config.showRepliesOnHomepage,orbisContext:o.$config.chatChannels.nftLaunchpad+":"+n.cAddress},null,8,["showQuotedPost","orbisContext"])):c("",!0),p(j,{cAddress:n.cAddress,mdAddress:e.mdAddress},null,8,["cAddress","mdAddress"]),p(z,{cAddress:n.cAddress,mdAddress:e.mdAddress,onSaveCollection:n.saveCollection},null,8,["cAddress","mdAddress","onSaveCollection"]),p(H,{cAddress:n.cAddress,cDescription:e.cDescription,mdAddress:e.mdAddress,onSaveCollection:n.saveCollection},null,8,["cAddress","cDescription","mdAddress","onSaveCollection"]),p(V,{mdAddress:e.mdAddress,cType:e.cType,cAddress:n.cAddress,onSaveCollection:n.saveCollection},null,8,["mdAddress","cType","cAddress","onSaveCollection"]),p(Y,{mdAddress:e.mdAddress,cAddress:n.cAddress},null,8,["mdAddress","cAddress"])],64)}const Vi=w(ys,[["render",xi]]);export{Vi as default};
