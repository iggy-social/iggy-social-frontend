import{a as u,s as b,o as r,b as d,f as e,z as c,y as m,i as g,t as p,F as f}from"./entry.1a1e635f.js";const h={name:"Web3StorageImageUpload",props:["buttonText","cls","icon"],emits:["insertImage"],data(){return{file:null,maxSize:this.$config.maxImageUploadSizeMb*1024*1024,waitingUpload:!1}},computed:{getButtonText(){return this.buttonText||"IMG"},getIcon(){return this.icon||"bi bi-file-earmark-image-fill"}},methods:{handleFileInput(a){const t=a.target.files[0];this.file=t},async uploadToWeb3Storage(){this.waitingUpload=!0;const a=this.file;if(!a){console.error("No file selected"),this.toast("No file selected",{type:"error"});return}if(a.size>this.maxSize){console.error("File is too large (max size is "+this.$config.maxImageUploadSizeMb+" MB)"),this.toast("File is too large (max size is "+this.$config.maxImageUploadSizeMb+" MB)",{type:"error"});return}const t=new FormData;t.append("file",a);const l={method:"POST",headers:{accept:"application/json",Authorization:"Bearer "+this.$config.web3storageKey,"X-NAME":encodeURIComponent(a.name)},body:t};try{const s=await fetch("https://api.web3.storage/upload",l);if(!s.ok)console.error("Failed to upload image:",s),this.toast("Failed to upload image",{type:"error"});else{const i=await s.json();this.waitingUpload=!1,document.getElementById("closeImageUploadModal").click(),this.$emit("insertImage","https://"+i.cid+".ipfs.w3s.link?.img")}}catch(s){this.waitingUpload=!1,console.error("Error uploading image:",s),this.toast("Error uploading image",{type:"error"})}}},setup(){return{toast:b()}}},_={class:"modal fade",id:"imageUploadModal",tabindex:"-1","aria-labelledby":"imageUploadModalLabel","aria-hidden":"true"},U={class:"modal-dialog"},y={class:"modal-content"},I=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"imageUploadModalLabel"},"Upload an image"),e("button",{id:"closeImageUploadModal",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},M={for:"formFileLg",class:"form-label"},z={class:"modal-footer"},F=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1),S=["disabled"],w={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function B(a,t,l,s,i,o){return r(),d(f,null,[e("a",{"data-bs-toggle":"modal","data-bs-target":"#imageUploadModal",class:c(l.cls)},[o.getIcon?(r(),d("i",{key:0,class:c(o.getIcon)},null,2)):m("",!0),g(" "+p(o.getButtonText),1)],2),e("div",_,[e("div",U,[e("div",y,[I,e("div",x,[e("div",null,[e("label",M,"Upload an image (max "+p(a.$config.maxImageUploadSizeMb)+" MB size)",1),e("input",{onChange:t[0]||(t[0]=(...n)=>o.handleFileInput&&o.handleFileInput(...n)),class:"form-control form-control-lg",id:"formFileLg",type:"file"},null,32)])]),e("div",z,[F,e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=(...n)=>o.uploadToWeb3Storage&&o.uploadToWeb3Storage(...n)),disabled:i.waitingUpload},[i.waitingUpload?(r(),d("span",w)):m("",!0),g(" Upload image ")],8,S)])])])])],64)}const k=u(h,[["render",B]]);export{k as W};
