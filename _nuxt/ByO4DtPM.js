import{_ as U,W as v,S as P,C as q,r as h,c as p,o as c,b as d,a as i,w as N,T as A,d as C,t as l,M,H as B,g as u,f as I,n as f,v as b,p as y,q as w,F as L,l as H,j as V,i as j,Z as x,x as E,m as W}from"#entry";import{I as R}from"./C628wGYq.js";import{F as z}from"./Db4Bzha7.js";import"./DunJuDhm.js";const K={name:"NftCreate",data(){return{cDescription:null,cImage:null,cName:null,cSymbol:null,isMounted:!1,launchpadPaused:null,nftName:null,createPriceWei:null,ratio:null,uniqueId:null,waitingCreate:!1,waitingData:!1}},components:{ConnectWalletButton:q,FileUploadModal:z,Image:R,SwitchChainButton:P,WaitingToast:v},mounted(){this.isMounted=!0,this.ratio=this.$config.public.nftDefaultRatio,this.fetchData()},computed:{cleanDescription(){return this.cDescription?this.cDescription.replace(/"/g,"'"):null},createPrice(){if(!this.createPriceWei)return null;const t=Number(W(this.createPriceWei));return t>.01?Number.parseFloat(t.toFixed(5)):t>1e-4?Number.parseFloat(t.toFixed(7)):Number.parseFloat(t)},fieldsValid(){return this.cName&&this.cSymbol&&this.cImage&&this.cDescription&&this.ratio},isSupportedChain(){return this.chainId===this.$config.public.supportedChainId}},methods:{calculatePrice(t,e){const a=Number(t)-1;return(a*(a+1)*(2*a+1)-(a-1)*a*(2*(a-1)+1))*1e4/42069*Number(e)/31337},async createCollection(){this.waitingCreate=!0;let t;if(this.isActivated)try{const e=[{name:"launch",type:"function",stateMutability:"payable",inputs:[{name:"contractOwner_",type:"address"},{name:"referrer_",type:"address"},{name:"mdDescription_",type:"string"},{name:"mdImage_",type:"string"},{name:"mdName_",type:"string"},{name:"name_",type:"string"},{name:"symbol_",type:"string"},{name:"uniqueId_",type:"string"},{name:"ratio_",type:"uint256"}],outputs:[]}],a={address:this.$config.public.nftLaunchpadBondingAddress,abi:e,functionName:"launch",args:[this.address,x(window),this.cleanDescription,this.cImage,this.cName,this.cName,this.cSymbol,this.uniqueId,E(String(this.ratio))],value:BigInt(this.createPriceWei)},r=await this.writeData(a);t=this.toast({component:v,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+r,"_blank").focus()});const n=await this.waitForTxReceipt(r);if(n.status==="success"){this.toast.dismiss(t),this.toast("You have successfully created an NFT collection!",{type:"success",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+r,"_blank").focus()});const s=[{name:"getNftContractAddress",type:"function",stateMutability:"view",inputs:[{name:"_uniqueId",type:"string"}],outputs:[{name:"",type:"address"}]}],g=await this.readData({address:this.$config.public.nftLaunchpadBondingAddress,abi:s,functionName:"getNftContractAddress",args:[this.uniqueId]});this.$router.push({path:"/nft/collection",query:{id:g}}),this.waitingCreate=!1}else this.toast.dismiss(t),this.waitingCreate=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+r,"_blank").focus()}),console.log(n)}catch(e){console.error(e);try{let a=e.message.split("Details:")[1];a=a.split("Version: viem")[0],a=a.replace(/"/g,""),a=a.replace("execution reverted:","Error:"),console.log(a),this.toast(a,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingCreate=!1}finally{this.toast.dismiss(t),this.waitingCreate=!1}this.waitingCreate=!1},async fetchData(){this.waitingData=!0;try{const t=[{name:"paused",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"bool"}]},{name:"isUniqueIdAvailable",type:"function",stateMutability:"view",inputs:[{name:"_uniqueId",type:"string"}],outputs:[{name:"",type:"bool"}]},{name:"price",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"uint256"}]}];this.launchpadPaused=await this.readData({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"paused",args:[]}),this.uniqueId=Math.random().toString(36).slice(2),await this.readData({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"isUniqueIdAvailable",args:[this.uniqueId]})||(this.uniqueId=Math.random().toString(36).slice(10)),this.createPriceWei=await this.readData({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"price",args:[]}),this.waitingData=!1}catch(t){console.error("Error fetching data:",t),this.waitingData=!1}},insertImage(t){this.cImage=t.replace("?.img","")}},setup(){const{address:t,chainId:e,isActivated:a}=H(),{readData:r,writeData:n,waitForTxReceipt:s}=V(),g=j();return{address:t,chainId:e,isActivated:a,readData:r,writeData:n,waitForTxReceipt:s,toast:g}}},O={class:"card border scroll-500"},Y={class:"card-body"},Z={class:"fs-3"},G={key:0,class:"d-flex justify-content-center mb-3"},J={key:1,class:"mb-4"},Q={class:"mb-4"},X={class:"mb-4"},_={class:"mb-2"},$={class:"input-group","aria-describedby":"cImageHelp",id:"cImage"},ee=["data-bs-target"],te={key:2,class:"mb-4"},ie={class:"mb-4"},ne={class:"mb-4"},ae={class:"mb-4"},se={id:"ratioHelp",class:"form-text"},oe={class:"d-flex justify-content-center mt-5 mb-5"},le=["disabled"],re={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},ce={key:1,disabled:!0,class:"btn btn-primary"};function ue(t,e,a,r,n,s){const g=A,m=M,D=B,k=h("Image"),S=h("ConnectWalletButton"),T=h("SwitchChainButton"),F=h("FileUploadModal");return c(),p(L,null,[d(D,null,{default:N(()=>[d(g,null,{default:N(()=>[C("Create NFT Collection | "+l(t.$config.public.projectMetadataTitle),1)]),_:1}),d(m,{property:"og:title",content:"Create NFT Collection | "+t.$config.public.projectMetadataTitle},null,8,["content"]),d(m,{name:"description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"]),d(m,{property:"og:image",content:t.$config.public.projectUrl+t.$config.public.previewImageNftCreate},null,8,["content"]),d(m,{property:"og:description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"]),d(m,{name:"twitter:image",content:t.$config.public.projectUrl+t.$config.public.previewImageNftCreate},null,8,["content"]),d(m,{name:"twitter:description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"])]),_:1}),i("div",O,[i("div",Y,[i("p",Z,[i("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:e[0]||(e[0]=o=>t.$router.back())})]),e[23]||(e[23]=i("h3",{class:"mb-4 mt-3"},"Create NFT Collection",-1)),n.waitingData?(c(),p("div",G,[...e[8]||(e[8]=[i("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1)])])):u("",!0),s.createPrice?(c(),p("p",J," Price for creating a collection is "+l(s.createPrice)+" "+l(t.$config.public.tokenSymbol)+". ",1)):u("",!0),i("div",Q,[e[9]||(e[9]=i("label",{for:"cName",class:"form-label"},"Collection Name",-1)),f(i("input",{type:"text",class:"form-control",id:"cName","aria-describedby":"cNameHelp",placeholder:"e.g. Crypto Punks","onUpdate:modelValue":e[1]||(e[1]=o=>n.cName=o)},null,512),[[b,n.cName]]),e[10]||(e[10]=i("div",{id:"cNameHelp",class:"form-text"},"This is not a token name, but the whole collection name.",-1))]),i("div",X,[e[11]||(e[11]=i("label",{for:"cSymbol",class:"form-label"},"Collection Symbol",-1)),f(i("input",{type:"text",class:"form-control",id:"cSymbol","aria-describedby":"cSymbolHelp",placeholder:"e.g. PUNKS","onUpdate:modelValue":e[2]||(e[2]=o=>n.cSymbol=o)},null,512),[[b,n.cSymbol]]),e[12]||(e[12]=i("div",{id:"cSymbolHelp",class:"form-text"}," Collection symbol (required by the ERC-721 smart contract, but not really important). ",-1))]),i("div",_,[e[14]||(e[14]=i("label",{for:"cImage",class:"form-label"},"Collection Image (can be changed later)",-1)),i("div",$,[f(i("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>n.cImage=o),type:"text",class:"form-control",placeholder:"Enter image URL or click the upload button"},null,512),[[b,n.cImage]]),r.isActivated&&t.$config.public.fileUploadEnabled!==""?(c(),p("button",{key:0,class:"btn btn-outline-secondary rounded-end-2","data-bs-toggle":"modal","data-bs-target":"#fileUploadModal"+t.$.uid},[...e[13]||(e[13]=[i("i",{class:"bi bi-file-earmark-image-fill"},null,-1),C(" Upload ",-1)])],8,ee)):u("",!0)]),e[15]||(e[15]=i("div",{id:"cImageHelp",class:"form-text"}," Even if you want a generative PFP collection, put a single preview image for now and you will change it to a metadata link later. ",-1))]),n.cImage?(c(),p("div",te,[d(k,{url:n.cImage,alt:"Image",cls:"img-thumbnail img-fluid",style:{"max-width":"100px"}},null,8,["url"]),e[16]||(e[16]=i("br",null,null,-1)),e[17]||(e[17]=i("small",null,"If image didn't appear above, then something is wrong with the link you added (wait until the loading indicator completes). If you have an IPFS link, it also helps to cut/paste the same link a couple of times.",-1))])):u("",!0),i("div",ie,[e[18]||(e[18]=i("label",{for:"cDescription",class:"form-label"},"Collection Description (can be changed later)",-1)),f(i("input",{type:"text",class:"form-control",id:"cDescription","aria-describedby":"cDescriptionHelp",placeholder:"Keep it short and sweet.","onUpdate:modelValue":e[4]||(e[4]=o=>n.cDescription=o)},null,512),[[b,n.cDescription]]),e[19]||(e[19]=i("div",{id:"cDescriptionHelp",class:"form-text"},"Too long description means higher gas cost for storing it.",-1))]),i("div",ne,[e[20]||(e[20]=i("label",{for:"uniqueId",class:"form-label"},"Unique ID (store it - just in case)",-1)),f(i("input",{type:"text",class:"form-control",id:"uniqueId","aria-describedby":"uniqueIdHelp",disabled:"",readonly:"","onUpdate:modelValue":e[5]||(e[5]=o=>n.uniqueId=o)},null,512),[[b,n.uniqueId]]),e[21]||(e[21]=i("div",{id:"uniqueIdHelp",class:"form-text"}," This is just in case the frontend will not show you the NFT collection address and you'll need to find it manually. ",-1))]),i("div",ae,[e[22]||(e[22]=i("label",{for:"ratio",class:"form-label"},"Bonding Curve Ratio",-1)),f(i("input",{type:"text",class:"form-control",id:"ratio","aria-describedby":"ratioHelp","onUpdate:modelValue":e[6]||(e[6]=o=>n.ratio=o)},null,512),[[b,n.ratio]]),i("div",se," Price for mint #1 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(w))(s.calculatePrice(2,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", for mint #5 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(w))(s.calculatePrice(5,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", for mint #15 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(w))(s.calculatePrice(15,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", for mint #30 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(w))(s.calculatePrice(30,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", etc. ",1)]),i("div",oe,[r.isActivated&&s.isSupportedChain&&!n.launchpadPaused?(c(),p("button",{key:0,disabled:n.waitingCreate||!s.fieldsValid,class:"btn btn-primary",type:"button",onClick:e[7]||(e[7]=(...o)=>s.createCollection&&s.createCollection(...o))},[n.waitingData||n.waitingCreate?(c(),p("span",re)):u("",!0),C(" Create NFT Collection for "+l(s.createPrice)+" "+l(t.$config.public.tokenSymbol),1)],8,le)):u("",!0),r.isActivated&&s.isSupportedChain&&n.launchpadPaused?(c(),p("button",ce," Paused ")):u("",!0),!r.isActivated&&!s.isSupportedChain?(c(),I(S,{key:2,class:"btn-primary",btnText:"Connect wallet"})):u("",!0),r.isActivated&&!s.isSupportedChain?(c(),I(T,{key:3})):u("",!0)]),n.isMounted?(c(),I(F,{key:3,onProcessFileUrl:s.insertImage,title:"Upload your NFT image",infoText:"Upload the NFT image.",storageType:t.$config.public.fileUploadStorageType,componentId:t.$.uid,maxFileSize:t.$config.public.fileUploadSizeLimit},null,8,["onProcessFileUrl","storageType","componentId","maxFileSize"])):u("",!0)])])],64)}const be=U(K,[["render",ue]]);export{be as default};
