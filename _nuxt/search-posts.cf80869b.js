import{H as y,T as x,M as P}from"./components.2c55861d.js";import{C as w}from"./ChatPost.77b45a5e.js";import{a as m,K as v,r as u,o as i,b as a,f as e,L as k,M as T,P as L,t as p,F as _,Q as S,c as N,l as c,e as l,w as h,i as M}from"./entry.39daa801.js";import"./composables.7e1a0599.js";import"./ethers.59ee7f23.js";import"./user.7e7ee046.js";import"./Image.433c0e29.js";import"./ipfsUtils.81ae052c.js";import"./domainUtils.d7040107.js";import"./SwitchChainButton.dcd004e3.js";import"./WaitingToast.dacce1f6.js";import"./textUtils.f8cc0baf.js";import"./storageUtils.35c1ef31.js";import"./MintedPostImage.b9b2fad6.js";const j={name:"SearchPosts",data(){return{orbisPosts:[],pageCounter:0,queryTerm:null,searched:!1,selectedContext:this.$config.chatChannels.general,selectedContextName:"General discussion",showLoadMore:!1,waitingLoadPosts:!1}},components:{ChatPost:w},methods:{chooseContext(r){switch(this.orbisPosts=[],this.pageCounter=0,this.searched=!1,this.selectedContext=this.$config.chatChannels[r],console.log(this.selectedContext),r){case"general":this.selectedContextName="General discussion";break;case"memesImages":this.selectedContextName="Share Images & NFTs";break;case"shill":this.selectedContextName="Shill & discuss projects";break}},async search(){this.waitingLoadPosts=!0;let{data:r,error:t}=await this.$orbis.getPosts({context:this.selectedContext,term:this.queryTerm},this.pageCounter,this.$config.getPostsLimit,!1);t&&(this.toast("Error fetching posts from the Orbis/Ceramic node.",{type:"error"}),console.log(t)),r.length<this.$config.getPostsLimit?this.showLoadMore=!1:r.length===this.$config.getPostsLimit&&(this.showLoadMore=!0),this.orbisPosts.push(...r),this.pageCounter++,this.waitingLoadPosts=!1,this.searched=!0}},setup(){return{toast:v()}},watch:{queryTerm(r,t){r!==t&&(this.orbisPosts=[],this.pageCounter=0,this.searched=!1)}}},q={class:"input-group mb-3"},$={class:"dropdown d-flex justify-content-center mb-4"},V={class:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},B={class:"dropdown-menu"},F={class:"text-center"},G=["disabled"],H={key:0},I={key:1,class:"d-flex justify-content-center mt-5 mb-4"},K=e("p",null,"No posts. Try a different query.",-1),D=[K],E={key:2,class:"d-flex justify-content-center mb-3"},O=e("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1),Q=[O],U={key:3,class:"d-grid gap-2 col-6 mx-auto mb-5"};function z(r,t,f,g,s,n){const d=u("ChatPost");return i(),a("div",null,[e("div",q,[k(e("input",{type:"text",class:"form-control text-center",placeholder:"enter a search term","onUpdate:modelValue":t[0]||(t[0]=o=>s.queryTerm=o),onKeyup:t[1]||(t[1]=L((...o)=>n.search&&n.search(...o),["enter"]))},null,544),[[T,s.queryTerm]])]),e("div",$,[e("button",V,p(s.selectedContextName),1),e("ul",B,[e("li",null,[e("button",{class:"dropdown-item",onClick:t[2]||(t[2]=o=>n.chooseContext("general"))},"General discussion")]),e("li",null,[e("button",{class:"dropdown-item",onClick:t[3]||(t[3]=o=>n.chooseContext("memesImages"))},"Share Images & NFTs")]),e("li",null,[e("button",{class:"dropdown-item",onClick:t[4]||(t[4]=o=>n.chooseContext("shill"))},"Shill & discuss projects")])])]),e("div",F,[e("button",{class:"btn btn-primary mt-2 mb-4",disabled:!s.queryTerm||s.waitingLoadPosts,onClick:t[5]||(t[5]=(...o)=>n.search&&n.search(...o))}," Search ",8,G)]),s.orbisPosts?(i(),a("div",H,[(i(!0),a(_,null,S(s.orbisPosts,o=>(i(),N(d,{key:o.stream_id,post:o,orbisContext:s.selectedContext},null,8,["post","orbisContext"]))),128))])):c("",!0),s.searched&&s.queryTerm&&s.orbisPosts.length===0&&!s.waitingLoadPosts?(i(),a("div",I,D)):c("",!0),s.waitingLoadPosts?(i(),a("div",E,Q)):c("",!0),s.showLoadMore?(i(),a("div",U,[e("button",{class:"btn btn-primary",type:"button",onClick:t[6]||(t[6]=(...o)=>n.search&&n.search(...o))},"Load more posts")])):c("",!0)])}const A=m(j,[["render",z]]),J={name:"SearchPostsPage",components:{SearchPosts:A}},R={class:"scroll-500"},W={class:"card border"},X={class:"card-body mb-3"},Y={class:"fs-3"},Z=e("h3",{class:"mt-3"},"Search posts",-1),ee={class:"d-flex justify-content-center mt-5"},te={class:"col-12 col-lg-8"};function se(r,t,f,g,s,n){const d=x,o=P,b=y,C=u("SearchPosts",!0);return i(),a(_,null,[l(b,null,{default:h(()=>[l(d,null,{default:h(()=>[M("Search posts | "+p(r.$config.projectMetadataTitle),1)]),_:1}),l(o,{property:"og:title",content:"Search posts | "+r.$config.projectMetadataTitle},null,8,["content"])]),_:1}),e("div",R,[e("div",W,[e("div",X,[e("p",Y,[e("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:t[0]||(t[0]=oe=>r.$router.back())})]),Z,e("div",ee,[e("div",te,[l(C)])])])])])],64)}const be=m(J,[["render",se]]);export{be as default};
