var Hn=Object.defineProperty;var zn=(t,e,r)=>e in t?Hn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var pt=(t,e,r)=>(zn(t,typeof e!="symbol"?e+"":e,r),r);import{u as Vn}from"./site.da7161ce.js";import{a9 as fn,aa as bn,ab as Gn,ac as hn,ad as ut,Y as qn,ae as Ut,af as Jn,ag as Yn,V as Xn,E as Qn,a as xn,o as B,b as L,f as S,l as Y,i as Zn,N as vt,t as Tt,F as er,r as tr,e as nr,L as rr,M as ir}from"./entry.dcc8b99f.js";function sr(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}const or=Object.freeze(Object.defineProperty({__proto__:null,equals:sr},Symbol.toStringTag,{value:"Module"}));function X(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?X=function(e){return typeof e}:X=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(t)}function ar(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jt(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lr(t,e,r){return e&&Jt(t.prototype,e),r&&Jt(t,r),t}function pn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,i)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yt(Object(r),!0).forEach(function(i){pn(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yt(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var cr="2.0.0",U={MANDATORY_INITIALIZATION_MISSING:{message:"Missing urlEndpoint during SDK initialization",help:""},INVALID_TRANSFORMATION_POSITION:{message:"Invalid transformationPosition parameter",help:""},PRIVATE_KEY_CLIENT_SIDE:{message:"privateKey should not be passed on the client side",help:""},MISSING_UPLOAD_DATA:{message:"Missing data for upload",help:""},MISSING_UPLOAD_FILE_PARAMETER:{message:"Missing file parameter for upload",help:""},MISSING_UPLOAD_FILENAME_PARAMETER:{message:"Missing fileName parameter for upload",help:""},MISSING_AUTHENTICATION_ENDPOINT:{message:"Missing authentication endpoint for upload",help:""},MISSING_PUBLIC_KEY:{message:"Missing public key for upload",help:""},AUTH_ENDPOINT_TIMEOUT:{message:"The authenticationEndpoint you provided timed out in 60 seconds",help:""},AUTH_ENDPOINT_NETWORK_ERROR:{message:"Request to authenticationEndpoint failed due to network error",help:""},AUTH_INVALID_RESPONSE:{message:"Invalid response from authenticationEndpoint. The SDK expects a JSON response with three fields i.e. signature, token and expire.",help:""},UPLOAD_ENDPOINT_NETWORK_ERROR:{message:"Request to ImageKit upload endpoint failed due to network error",help:""},INVALID_UPLOAD_OPTIONS:{message:"Invalid uploadOptions parameter",help:""},MISSING_SIGNATURE:{message:"Missing signature for upload. The SDK expects token, sginature and expire for authentication.",help:""},MISSING_TOKEN:{message:"Missing token for upload. The SDK expects token, sginature and expire for authentication.",help:""},MISSING_EXPIRE:{message:"Missing expire for upload. The SDK expects token, sginature and expire for authentication.",help:""}};function O(t,e,r){typeof r=="function"&&(t?r(e,null):r(null,e))}function ur(t){var e={},r=t.getAllResponseHeaders();return Object.keys(r).length&&r.trim().split(/[\r\n]+/).map(function(i){return i.split(/: /)}).forEach(function(i){e[i[0].trim()]=i[1].trim()}),e}var Xt=function(e,r){var i=$({},e),s={statusCode:r.status,headers:ur(r)};return Object.defineProperty(i,"$ResponseMetadata",{value:s,enumerable:!1,writable:!1}),i},dr=function(e,r,i){fr(e,r).then(function(s){return O(!1,s,i)},function(s){return O(!0,s,i)})},fr=function(e,r){return new Promise(function(i,s){e.open("POST","https://upload.imagekit.io/api/v1/files/upload"),e.onerror=function(a){return s(U.UPLOAD_ENDPOINT_NETWORK_ERROR)},e.onload=function(){if(e.status===200)try{var a=JSON.parse(e.responseText),o=Xt(a,e);return i(o)}catch(b){return s(b)}else try{var a=JSON.parse(e.responseText),d=Xt(a,e);return s(d)}catch(b){return s(b)}},e.send(r)})},br=function(e,r,i,s){if(!r.file){O(!0,U.MISSING_UPLOAD_FILE_PARAMETER,s);return}if(!r.fileName){O(!0,U.MISSING_UPLOAD_FILENAME_PARAMETER,s);return}if(!i.publicKey){O(!0,U.MISSING_PUBLIC_KEY,s);return}if(!r.token){O(!0,U.MISSING_TOKEN,s);return}if(!r.signature){O(!0,U.MISSING_SIGNATURE,s);return}if(!r.expire){O(!0,U.MISSING_EXPIRE,s);return}var a=new FormData,o;for(o in r)o&&(o==="file"&&typeof r.file!="string"?a.append("file",r.file,String(r.fileName)):o==="tags"&&Array.isArray(r.tags)?a.append("tags",r.tags.join(",")):o==="signature"?a.append("signature",r.signature):o==="expire"?a.append("expire",String(r.expire)):o==="token"?a.append("token",r.token):o==="responseFields"&&Array.isArray(r.responseFields)?a.append("responseFields",r.responseFields.join(",")):o==="extensions"&&Array.isArray(r.extensions)?a.append("extensions",JSON.stringify(r.extensions)):o==="customMetadata"&&X(r.customMetadata)==="object"&&!Array.isArray(r.customMetadata)&&r.customMetadata!==null?a.append("customMetadata",JSON.stringify(r.customMetadata)):r[o]!==void 0&&a.append(o,String(r[o])));a.append("publicKey",i.publicKey),dr(e,a,s)},Qt={width:"w",height:"h",aspectRatio:"ar",quality:"q",crop:"c",cropMode:"cm",focus:"fo",x:"x",y:"y",format:"f",radius:"r",background:"bg",border:"b",rotation:"rt",rotate:"rt",blur:"bl",named:"n",overlayImage:"oi",overlayImageAspectRatio:"oiar",overlayImageBackground:"oibg",overlayImageBorder:"oib",overlayImageDPR:"oidpr",overlayImageQuality:"oiq",overlayImageCropping:"oic",overlayImageTrim:"oit",overlayX:"ox",overlayY:"oy",overlayFocus:"ofo",overlayHeight:"oh",overlayWidth:"ow",overlayText:"ot",overlayTextFontSize:"ots",overlayTextFontFamily:"otf",overlayTextColor:"otc",overlayTextTransparency:"oa",overlayAlpha:"oa",overlayTextTypography:"ott",overlayBackground:"obg",overlayTextEncoded:"ote",overlayTextWidth:"otw",overlayTextBackground:"otbg",overlayTextPadding:"otp",overlayTextInnerAlignment:"otia",overlayRadius:"or",progressive:"pr",lossless:"lo",trim:"t",metadata:"md",colorProfile:"cp",defaultImage:"di",dpr:"dpr",effectSharpen:"e-sharpen",effectUSM:"e-usm",effectContrast:"e-contrast",effectGray:"e-grayscale",original:"orig",raw:"raw"},mn="path",gn="query",hr=[mn,gn],xr=":",pr=",",mr="-",P={getDefault:function(){return mn},addAsQueryParameter:function(e){return e.transformationPosition===gn},validParameters:function(e){return typeof e.transformationPosition>"u"?!1:hr.indexOf(e.transformationPosition)!=-1},getTransformKey:function(e){return e&&(Qt[e]||Qt[e.toLowerCase()])||""},getChainTransformDelimiter:function(){return xr},getTransformDelimiter:function(){return pr},getTransformKeyValueDelimiter:function(){return mr}},Zt="tr";function gr(t){return typeof t=="string"&&t[t.length-1]=="/"&&(t=t.substring(0,t.length-1)),t}function kr(t){return typeof t=="string"&&t[0]=="/"&&(t=t.slice(1)),t}function et(t,e){var r=e||"/",i=new RegExp(r+"{1,}","g");return t.join(r).replace(i,r)}var yr=function(e){if(!e.path&&!e.src)return"";var r,i,s;try{e.path?(s=new URL(e.urlEndpoint).pathname,r=new URL(et([e.urlEndpoint.replace(s,""),e.path]))):(r=new URL(e.src),i=!0)}catch(d){return console.error(d),""}for(var a in e.queryParameters)r.searchParams.append(a,String(e.queryParameters[a]));var o=wr(e.transformation);return o&&o.length&&(P.addAsQueryParameter(e)||i?r.searchParams.append(Zt,o):r.pathname=et([Zt+P.getChainTransformDelimiter()+o,r.pathname])),s?r.pathname=et([s,r.pathname]):r.pathname=et([r.pathname]),r.href};function wr(t){if(!Array.isArray(t))return"";for(var e=[],r=0,i=t.length;r<i;r++){var s=[];for(var a in t[r]){var o=P.getTransformKey(a);if(o||(o=a),t[r][a]==="-")s.push(o);else if(a==="raw")s.push(t[r][a]);else{var d=t[r][a];(o==="oi"||o==="di")&&(d=gr(kr(d||"")),d=d.replace(/\//g,"@@")),s.push([o,d].join(P.getTransformKeyValueDelimiter()))}}e.push(s.join(P.getTransformDelimiter()))}return e.join(P.getChainTransformDelimiter())}var vr=function(e,r){return yr($($({},r),e))};function Tr(t){return t.urlEndpoint}var _r=function(e,r){return function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];if(s.length===r.length&&typeof s[s.length-1]<"u"){if(typeof s[s.length-1]!="function")throw new Error("Callback must be a function.");r.call.apply(r,[e].concat(s))}else return new Promise(function(o,d){var b=function(y){if(y)return d(y);for(var h=arguments.length,v=new Array(h>1?h-1:0),I=1;I<h;I++)v[I-1]=arguments[I];o(v.length>1?v:v[0])};s.pop(),s.push(b),r.call.apply(r,[e].concat(s))})}},Sr=function(){function t(e){if(ar(this,t),pn(this,"options",{sdkVersion:"javascript-".concat(cr),publicKey:"",urlEndpoint:"",transformationPosition:P.getDefault()}),this.options=$($({},this.options),e||{}),!Tr(this.options))throw U.MANDATORY_INITIALIZATION_MISSING;if(!P.validParameters(this.options))throw U.INVALID_TRANSFORMATION_POSITION}return lr(t,[{key:"url",value:function(r){return vr(r,this.options)}},{key:"upload",value:function(r,i,s){var a;if(typeof i=="function"?a=i:s=i||{},!r||X(r)!=="object")return O(!0,U.INVALID_UPLOAD_OPTIONS,a);var o=$($({},this.options),s),d=r||{},b=d.xhr;delete r.xhr;var m=b||new XMLHttpRequest;return _r(this,br)(m,r,o,a)}}]),t}(),kn={exports:{}},z={};const yn=fn,{toString:Ir}=bn,{fromString:Ar}=Gn;var wn={numberToUint8Array:Er,uint8ArrayToNumber:vn,varintUint8ArrayEncode:Nr,varintEncode:Ur};function vn(t){return parseInt(Ir(t,"base16"),16)}function Er(t){let e=t.toString(16);return e.length%2===1&&(e="0"+e),Ar(e,"base16")}function Nr(t){return Uint8Array.from(yn.encode(vn(t)))}function Ur(t){return Uint8Array.from(yn.encode(t))}const Or=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"eth-receipt-log-trie":153,"eth-reciept-log":154,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,"caip-50":202,streamid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,thread:406,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,noise:454,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,"swhid-1-snp":496,json:512,messagepack:513,"libp2p-peer-record":769,"libp2p-relay-rsvp":770,"car-index-sorted":1024,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,"secp256k1-priv":4865,"x25519-priv":4866,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056,"arweave-ns":11704592});var Fr={baseTable:Or};const{baseTable:_t}=Fr,Cr=wn.varintEncode,Ot={},Ft={},rt={};for(const t in _t){const e=t,r=_t[e];Ot[e]=Cr(r);const i=e.toUpperCase().replace(/-/g,"_");Ft[i]=r,rt[r]||(rt[r]=e)}Object.freeze(Ot);Object.freeze(Ft);Object.freeze(rt);const Rr=Object.freeze(_t);var Dr={nameToVarint:Ot,constantToCode:Ft,nameToCode:Rr,codeToName:rt};const it=fn,{concat:Pr}=hn,Tn=wn,{nameToVarint:st,constantToCode:Mr,nameToCode:_n,codeToName:Ct}=Dr;function Br(t,e){let r;if(t instanceof Uint8Array)r=Tn.varintUint8ArrayEncode(t);else if(st[t])r=st[t];else throw new Error("multicodec not recognized");return Pr([r,e],r.length+e.length)}function Lr(t){return it.decode(t),t.slice(it.decode.bytes)}function Sn(t){const e=it.decode(t),r=Ct[e];if(r===void 0)throw new Error(`Code "${e}" not found`);return r}function In(t){return Ct[t]}function An(t){const e=_n[t];if(e===void 0)throw new Error(`Codec "${t}" not found`);return e}function En(t){return it.decode(t)}function Nn(t){const e=st[t];if(e===void 0)throw new Error(`Codec "${t}" not found`);return e}function Un(t){return Tn.varintEncode(t)}function $r(t){return Sn(t)}function Wr(t){return In(t)}function Kr(t){return An(t)}function jr(t){return En(t)}function Hr(t){return Nn(t)}function zr(t){return Array.from(Un(t))}var Vr={addPrefix:Br,rmPrefix:Lr,getNameFromData:Sn,getNameFromCode:In,getCodeFromName:An,getCodeFromData:En,getVarintFromName:Nn,getVarintFromCode:Un,getCodec:$r,getName:Wr,getNumber:Kr,getCode:jr,getCodeVarint:Hr,getVarint:zr,...Mr,nameToVarint:st,nameToCode:_n,codeToName:Ct};const Gr=ut,qr={checkCIDComponents:function(t){if(t==null)return"null values are not valid CIDs";if(!(t.version===0||t.version===1))return"Invalid version, must be a number equal to 1 or 0";if(typeof t.codec!="string")return"codec must be string";if(t.version===0){if(t.codec!=="dag-pb")return"codec must be 'dag-pb' for CIDv0";if(t.multibaseName!=="base58btc")return"multibaseName must be 'base58btc' for CIDv0"}if(!(t.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{Gr.validate(t.multihash)}catch(e){let r=e.message;return r||(r="Multihash validation failed"),r}}};var Jr=qr;const Yr=qn(or),tt=ut,mt=Ut.exports,M=Vr,Xr=Jr,{concat:en}=hn,{toString:Qr}=bn,{equals:Zr}=Yr,ot=M.nameToCode,ei=Object.keys(ot).reduce((t,e)=>(t[ot[e]]=e,t),{}),tn=Symbol.for("@ipld/js-cid/CID");class N{constructor(e,r,i,s){if(this.version,this.codec,this.multihash,Object.defineProperty(this,tn,{value:!0}),N.isCID(e)){const a=e;this.version=a.version,this.codec=a.codec,this.multihash=a.multihash,this.multibaseName=a.multibaseName||(a.version===0?"base58btc":"base32");return}if(typeof e=="string"){const a=mt.isEncoded(e);if(a){const o=mt.decode(e);this.version=parseInt(o[0].toString(),16),this.codec=M.getCodec(o.slice(1)),this.multihash=M.rmPrefix(o.slice(1)),this.multibaseName=a}else this.version=0,this.codec="dag-pb",this.multihash=tt.fromB58String(e),this.multibaseName="base58btc";N.validateCID(this),Object.defineProperty(this,"string",{value:e});return}if(e instanceof Uint8Array){const a=parseInt(e[0].toString(),16);if(a===1){const o=e;this.version=a,this.codec=M.getCodec(o.slice(1)),this.multihash=M.rmPrefix(o.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";N.validateCID(this);return}this.version=e,typeof r=="number"&&(r=ei[r]),this.codec=r,this.multihash=i,this.multibaseName=s||(e===0?"base58btc":"base32"),N.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(this.version===0)e=this.multihash;else if(this.version===1){const r=M.getCodeVarint(this.codec);e=en([[1],r,this.multihash],1+r.byteLength+this.multihash.byteLength)}else throw new Error("unsupported version");Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){const e=M.getCodeVarint(this.codec),r=tt.prefix(this.multihash);return en([[this.version],e,r],1+e.byteLength+r.byteLength)}get code(){return ot[this.codec]}toV0(){if(this.codec!=="dag-pb")throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:e,length:r}=tt.decode(this.multihash);if(e!=="sha2-256")throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(r!==32)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new N(0,this.codec,this.multihash)}toV1(){return new N(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(e=this.multibaseName){if(this.string&&this.string.length!==0&&e===this.multibaseName)return this.string;let r;if(this.version===0){if(e!=="base58btc")throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");r=tt.toB58String(this.multihash)}else if(this.version===1)r=Qr(mt.encode(e,this.bytes));else throw new Error("unsupported version");return e===this.multibaseName&&Object.defineProperty(this,"string",{value:r}),r}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&Zr(this.multihash,e.multihash)}static validateCID(e){const r=Xr.checkCIDComponents(e);if(r)throw new Error(r)}static isCID(e){return e instanceof N||Boolean(e&&e[tn])}}N.codecs=ot;var Rt=N,Dt={exports:{}};function nn(t){if(t.stack&&t.name&&t.message)return t.stack.substring(t.name.length+3+t.message.length).split(`
`);if(t.stack)return t.stack.split(`
`)}function ti(t,e){return t.filter(function(r){return!~e.indexOf(r)})}Dt.exports=function(t,e){if(!(t.stack&&t.name&&t.message))return console.error(new Error("stackless error")),t;var r=new Error(e),i=ti(nn(r).slice(1),nn(t)).join(`
`);return r.__proto__=t,r.stack=r.name+": "+r.message+`
`+i+`
  `+t.stack,r};const ni=Rt,ri=Dt.exports;var ii=function(e){try{e=new ni(e)}catch(r){throw ri(r,`invalid cid: ${e}`)}return e.version!==1&&(e=e.toV1()),e.toBaseEncodedString("base32")};const si=Ut.exports;var On=function(){const e=[];for(const r of Object.values(si.names))e.push({name:r.name,code:r.code});return e};const oi=Rt;var Fn=function(){const e=[];for(const[r,i]of Object.entries(oi.codecs))e.push({name:r,code:i});return e};const{bases:rn}=Jn;function Cn(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const sn=Cn("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),gt=Cn("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),ai={utf8:sn,"utf-8":sn,hex:rn.base16,latin1:gt,ascii:gt,binary:gt,...rn};var li=ai;const ci=li;function ui(t,e="utf8"){const r=ci[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var di=ui;const fi=Rt,bi=On,hi=Fn,xi=Dt.exports,St=Ut.exports,j=ut,J=di;var pi=function(e,r){r=r||{};let i=r.format||"%s";if(i==="prefix"&&(i="%P"),!on(i)||i.indexOf("%")===-1)throw new Error(`invalid format string: ${i}`);const s=e;try{e=new fi(e)}catch(o){throw xi(o,`invalid cid: ${e}`)}if(r.cidVersion!=null&&e.version!==r.cidVersion)if(r.cidVersion===0)e=e.toV0();else if(r.cidVersion===1)e=e.toV1();else throw new Error(`invalid cid version: ${r.cidVersion}`);let a="base58btc";return r.base?a=Rn(r.base).name:on(s)&&(a=St.isEncoded(s)||a),i.replace(/%([a-zA-Z%])/g,mi(e,a))};function on(t){return Object.prototype.toString.call(t)==="[object String]"}function mi(t,e){return(i,s)=>{switch(s){case"%":return"%";case"b":return e;case"B":return Rn(e).code;case"v":return`cidv${t.version}`;case"V":return t.version.toString();case"c":return t.codec;case"C":return gi(t).toString();case"h":return j.decode(t.multihash).name;case"H":return j.decode(t.multihash).code.toString();case"L":return j.decode(t.multihash).length.toString();case"m":return J(St.encode(e,t.multihash));case"M":return J(t.multihash,e);case"d":return J(St.encode(e,j.decode(t.multihash).digest));case"D":return J(j.decode(t.multihash).digest,e);case"s":return t.toString(e);case"S":return t.version===1?t.toString(e).slice(1):J(t.bytes,e);case"P":return ki(t);default:throw new Error(`unrecognized specifier in format string: ${s}`)}}}function Rn(t){const e=bi().find(r=>r.code===t||r.name===t);if(!e)throw new Error(`invalid multibase: ${t}`);return e}function gi(t){const e=hi().find(r=>r.name===t.codec);if(!e)throw new Error(`invalid codec: ${t.codec}`);return e.code}function ki(t){const{name:e,length:r}=j.decode(t.multihash);return`cidv${t.version}-${t.codec}-${e}-${r}`}const yi=ut;var wi=function(){const e=[];for(const[r,i]of Object.entries(yi.names))e.push({name:r,code:i});return e};z.base32=ii;z.bases=On;z.codecs=Fn;z.format=pi;z.hashes=wi;(function(t){t.exports=z})(kn);const vi=Yn(kn.exports);function Ti(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Dn(t,...e){if(!Ti(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function an(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function _i(t,e){Dn(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const kt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),E=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Si(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Pn(t){return typeof t=="string"&&(t=Si(t)),Dn(t),t}class Ii{clone(){return this._cloneInto()}}function Ai(t){const e=i=>t().update(Pn(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Ei(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const s=BigInt(32),a=BigInt(4294967295),o=Number(r>>s&a),d=Number(r&a),b=i?4:0,m=i?0:4;t.setUint32(e+b,o,i),t.setUint32(e+m,d,i)}const Ni=(t,e,r)=>t&e^~t&r,Ui=(t,e,r)=>t&e^t&r^e&r;class Oi extends Ii{constructor(e,r,i,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=kt(this.buffer)}update(e){an(this);const{view:r,buffer:i,blockLen:s}=this;e=Pn(e);const a=e.length;for(let o=0;o<a;){const d=Math.min(s-this.pos,a-o);if(d===s){const b=kt(e);for(;s<=a-o;o+=s)this.process(b,o);continue}i.set(e.subarray(o,o+d),this.pos),this.pos+=d,o+=d,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){an(this),_i(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:s,isLE:a}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(i,0),o=0);for(let h=o;h<s;h++)r[h]=0;Ei(i,s-8,BigInt(this.length*8),a),this.process(i,0);const d=kt(e),b=this.outputLen;if(b%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=b/4,y=this.get();if(m>y.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<m;h++)d.setUint32(4*h,y[h],a)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:s,finished:a,destroyed:o,pos:d}=this;return e.length=s,e.pos=d,e.finished=a,e.destroyed=o,s%r&&e.buffer.set(i),e}}const Fi=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),R=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),D=new Uint32Array(64);class Ci extends Oi{constructor(){super(64,32,8,!1),this.A=R[0]|0,this.B=R[1]|0,this.C=R[2]|0,this.D=R[3]|0,this.E=R[4]|0,this.F=R[5]|0,this.G=R[6]|0,this.H=R[7]|0}get(){const{A:e,B:r,C:i,D:s,E:a,F:o,G:d,H:b}=this;return[e,r,i,s,a,o,d,b]}set(e,r,i,s,a,o,d,b){this.A=e|0,this.B=r|0,this.C=i|0,this.D=s|0,this.E=a|0,this.F=o|0,this.G=d|0,this.H=b|0}process(e,r){for(let h=0;h<16;h++,r+=4)D[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){const v=D[h-15],I=D[h-2],A=E(v,7)^E(v,18)^v>>>3,W=E(I,17)^E(I,19)^I>>>10;D[h]=W+D[h-7]+A+D[h-16]|0}let{A:i,B:s,C:a,D:o,E:d,F:b,G:m,H:y}=this;for(let h=0;h<64;h++){const v=E(d,6)^E(d,11)^E(d,25),I=y+v+Ni(d,b,m)+Fi[h]+D[h]|0,W=(E(i,2)^E(i,13)^E(i,22))+Ui(i,s,a)|0;y=m,m=b,b=d,d=o+I|0,o=a,a=s,s=i,i=I+W|0}i=i+this.A|0,s=s+this.B|0,a=a+this.C|0,o=o+this.D|0,d=d+this.E|0,b=b+this.F|0,m=m+this.G|0,y=y+this.H|0,this.set(i,s,a,o,d,b,m,y)}roundClean(){D.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ri=Ai(()=>new Ci);var Di={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.9.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2023
 * @license MIT
 */(function(t){(function(){var e="input is invalid type",r="finalize already called",i=typeof window=="object",s=i?window:{};s.JS_SHA3_NO_WINDOW&&(i=!1);var a=!i&&typeof self=="object",o=!s.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?s=Xn:a&&(s=self);for(var d=!s.JS_SHA3_NO_COMMON_JS&&!0&&t.exports,b=!s.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",m="0123456789abcdef".split(""),y=[31,7936,2031616,520093696],h=[4,1024,262144,67108864],v=[1,256,65536,16777216],I=[6,1536,393216,100663296],A=[0,8,16,24],W=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],Bt=[224,256,384,512],dt=[128,256],Lt=["hex","buffer","arrayBuffer","array","digest"],$t={128:168,256:136},Ln=s.JS_SHA3_NO_NODE_JS||!Array.isArray?function(n){return Object.prototype.toString.call(n)==="[object Array]"}:Array.isArray,$n=b&&(s.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)?function(n){return typeof n=="object"&&n.buffer&&n.buffer.constructor===ArrayBuffer}:ArrayBuffer.isView,ft=function(n){var l=typeof n;if(l==="string")return[n,!0];if(l!=="object"||n===null)throw new Error(e);if(b&&n.constructor===ArrayBuffer)return[new Uint8Array(n),!1];if(!Ln(n)&&!$n(n))throw new Error(e);return[n,!1]},Wt=function(n){return ft(n)[0].length===0},bt=function(n){for(var l=[],c=0;c<n.length;++c)l[c]=n[c];return l},Kt=function(n,l,c){return function(u){return new T(n,l,n).update(u)[c]()}},jt=function(n,l,c){return function(u,f){return new T(n,l,f).update(u)[c]()}},Ht=function(n,l,c){return function(u,f,x,g){return F["cshake"+n].update(u,f,x,g)[c]()}},zt=function(n,l,c){return function(u,f,x,g){return F["kmac"+n].update(u,f,x,g)[c]()}},Z=function(n,l,c,u){for(var f=0;f<Lt.length;++f){var x=Lt[f];n[x]=l(c,u,x)}return n},Vt=function(n,l){var c=Kt(n,l,"hex");return c.create=function(){return new T(n,l,n)},c.update=function(u){return c.create().update(u)},Z(c,Kt,n,l)},Wn=function(n,l){var c=jt(n,l,"hex");return c.create=function(u){return new T(n,l,u)},c.update=function(u,f){return c.create(f).update(u)},Z(c,jt,n,l)},Kn=function(n,l){var c=$t[n],u=Ht(n,l,"hex");return u.create=function(f,x,g){return Wt(x)&&Wt(g)?F["shake"+n].create(f):new T(n,l,f).bytepad([x,g],c)},u.update=function(f,x,g,p){return u.create(x,g,p).update(f)},Z(u,Ht,n,l)},jn=function(n,l){var c=$t[n],u=zt(n,l,"hex");return u.create=function(f,x,g){return new xt(n,l,x).bytepad(["KMAC",g],c).bytepad([f],c)},u.update=function(f,x,g,p){return u.create(f,g,p).update(x)},Z(u,zt,n,l)},Gt=[{name:"keccak",padding:v,bits:Bt,createMethod:Vt},{name:"sha3",padding:I,bits:Bt,createMethod:Vt},{name:"shake",padding:y,bits:dt,createMethod:Wn},{name:"cshake",padding:h,bits:dt,createMethod:Kn},{name:"kmac",padding:h,bits:dt,createMethod:jn}],F={},V=[],C=0;C<Gt.length;++C)for(var K=Gt[C],ee=K.bits,G=0;G<ee.length;++G){var ht=K.name+"_"+ee[G];if(V.push(ht),F[ht]=K.createMethod(ee[G],K.padding),K.name!=="sha3"){var qt=K.name+ee[G];V.push(qt),F[qt]=F[ht]}}function T(n,l,c){this.blocks=[],this.s=[],this.padding=l,this.outputBits=c,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(n<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=c>>5,this.extraBytes=(c&31)>>3;for(var u=0;u<50;++u)this.s[u]=0}T.prototype.update=function(n){if(this.finalized)throw new Error(r);var l=ft(n);n=l[0];for(var c=l[1],u=this.blocks,f=this.byteCount,x=n.length,g=this.blockCount,p=0,_=this.s,k,w;p<x;){if(this.reset)for(this.reset=!1,u[0]=this.block,k=1;k<g+1;++k)u[k]=0;if(c)for(k=this.start;p<x&&k<f;++p)w=n.charCodeAt(p),w<128?u[k>>2]|=w<<A[k++&3]:w<2048?(u[k>>2]|=(192|w>>6)<<A[k++&3],u[k>>2]|=(128|w&63)<<A[k++&3]):w<55296||w>=57344?(u[k>>2]|=(224|w>>12)<<A[k++&3],u[k>>2]|=(128|w>>6&63)<<A[k++&3],u[k>>2]|=(128|w&63)<<A[k++&3]):(w=65536+((w&1023)<<10|n.charCodeAt(++p)&1023),u[k>>2]|=(240|w>>18)<<A[k++&3],u[k>>2]|=(128|w>>12&63)<<A[k++&3],u[k>>2]|=(128|w>>6&63)<<A[k++&3],u[k>>2]|=(128|w&63)<<A[k++&3]);else for(k=this.start;p<x&&k<f;++p)u[k>>2]|=n[p]<<A[k++&3];if(this.lastByteIndex=k,k>=f){for(this.start=k-f,this.block=u[g],k=0;k<g;++k)_[k]^=u[k];q(_),this.reset=!0}else this.start=k}return this},T.prototype.encode=function(n,l){var c=n&255,u=1,f=[c];for(n=n>>8,c=n&255;c>0;)f.unshift(c),n=n>>8,c=n&255,++u;return l?f.push(u):f.unshift(u),this.update(f),f.length},T.prototype.encodeString=function(n){var l=ft(n);n=l[0];var c=l[1],u=0,f=n.length;if(c)for(var x=0;x<n.length;++x){var g=n.charCodeAt(x);g<128?u+=1:g<2048?u+=2:g<55296||g>=57344?u+=3:(g=65536+((g&1023)<<10|n.charCodeAt(++x)&1023),u+=4)}else u=f;return u+=this.encode(u*8),this.update(n),u},T.prototype.bytepad=function(n,l){for(var c=this.encode(l),u=0;u<n.length;++u)c+=this.encodeString(n[u]);var f=(l-c%l)%l,x=[];return x.length=f,this.update(x),this},T.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,l=this.lastByteIndex,c=this.blockCount,u=this.s;if(n[l>>2]|=this.padding[l&3],this.lastByteIndex===this.byteCount)for(n[0]=n[c],l=1;l<c+1;++l)n[l]=0;for(n[c-1]|=2147483648,l=0;l<c;++l)u[l]^=n[l];q(u)}},T.prototype.toString=T.prototype.hex=function(){this.finalize();for(var n=this.blockCount,l=this.s,c=this.outputBlocks,u=this.extraBytes,f=0,x=0,g="",p;x<c;){for(f=0;f<n&&x<c;++f,++x)p=l[f],g+=m[p>>4&15]+m[p&15]+m[p>>12&15]+m[p>>8&15]+m[p>>20&15]+m[p>>16&15]+m[p>>28&15]+m[p>>24&15];x%n===0&&(l=bt(l),q(l),f=0)}return u&&(p=l[f],g+=m[p>>4&15]+m[p&15],u>1&&(g+=m[p>>12&15]+m[p>>8&15]),u>2&&(g+=m[p>>20&15]+m[p>>16&15])),g},T.prototype.arrayBuffer=function(){this.finalize();var n=this.blockCount,l=this.s,c=this.outputBlocks,u=this.extraBytes,f=0,x=0,g=this.outputBits>>3,p;u?p=new ArrayBuffer(c+1<<2):p=new ArrayBuffer(g);for(var _=new Uint32Array(p);x<c;){for(f=0;f<n&&x<c;++f,++x)_[x]=l[f];x%n===0&&(l=bt(l),q(l))}return u&&(_[x]=l[f],p=p.slice(0,g)),p},T.prototype.buffer=T.prototype.arrayBuffer,T.prototype.digest=T.prototype.array=function(){this.finalize();for(var n=this.blockCount,l=this.s,c=this.outputBlocks,u=this.extraBytes,f=0,x=0,g=[],p,_;x<c;){for(f=0;f<n&&x<c;++f,++x)p=x<<2,_=l[f],g[p]=_&255,g[p+1]=_>>8&255,g[p+2]=_>>16&255,g[p+3]=_>>24&255;x%n===0&&(l=bt(l),q(l))}return u&&(p=x<<2,_=l[f],g[p]=_&255,u>1&&(g[p+1]=_>>8&255),u>2&&(g[p+2]=_>>16&255)),g};function xt(n,l,c){T.call(this,n,l,c)}xt.prototype=new T,xt.prototype.finalize=function(){return this.encode(this.outputBits,!0),T.prototype.finalize.call(this)};var q=function(n){var l,c,u,f,x,g,p,_,k,w,te,ne,re,ie,se,oe,ae,le,ce,ue,de,fe,be,he,xe,pe,me,ge,ke,ye,we,ve,Te,_e,Se,Ie,Ae,Ee,Ne,Ue,Oe,Fe,Ce,Re,De,Pe,Me,Be,Le,$e,We,Ke,je,He,ze,Ve,Ge,qe,Je,Ye,Xe,Qe,Ze;for(u=0;u<48;u+=2)f=n[0]^n[10]^n[20]^n[30]^n[40],x=n[1]^n[11]^n[21]^n[31]^n[41],g=n[2]^n[12]^n[22]^n[32]^n[42],p=n[3]^n[13]^n[23]^n[33]^n[43],_=n[4]^n[14]^n[24]^n[34]^n[44],k=n[5]^n[15]^n[25]^n[35]^n[45],w=n[6]^n[16]^n[26]^n[36]^n[46],te=n[7]^n[17]^n[27]^n[37]^n[47],ne=n[8]^n[18]^n[28]^n[38]^n[48],re=n[9]^n[19]^n[29]^n[39]^n[49],l=ne^(g<<1|p>>>31),c=re^(p<<1|g>>>31),n[0]^=l,n[1]^=c,n[10]^=l,n[11]^=c,n[20]^=l,n[21]^=c,n[30]^=l,n[31]^=c,n[40]^=l,n[41]^=c,l=f^(_<<1|k>>>31),c=x^(k<<1|_>>>31),n[2]^=l,n[3]^=c,n[12]^=l,n[13]^=c,n[22]^=l,n[23]^=c,n[32]^=l,n[33]^=c,n[42]^=l,n[43]^=c,l=g^(w<<1|te>>>31),c=p^(te<<1|w>>>31),n[4]^=l,n[5]^=c,n[14]^=l,n[15]^=c,n[24]^=l,n[25]^=c,n[34]^=l,n[35]^=c,n[44]^=l,n[45]^=c,l=_^(ne<<1|re>>>31),c=k^(re<<1|ne>>>31),n[6]^=l,n[7]^=c,n[16]^=l,n[17]^=c,n[26]^=l,n[27]^=c,n[36]^=l,n[37]^=c,n[46]^=l,n[47]^=c,l=w^(f<<1|x>>>31),c=te^(x<<1|f>>>31),n[8]^=l,n[9]^=c,n[18]^=l,n[19]^=c,n[28]^=l,n[29]^=c,n[38]^=l,n[39]^=c,n[48]^=l,n[49]^=c,ie=n[0],se=n[1],Pe=n[11]<<4|n[10]>>>28,Me=n[10]<<4|n[11]>>>28,ge=n[20]<<3|n[21]>>>29,ke=n[21]<<3|n[20]>>>29,Ye=n[31]<<9|n[30]>>>23,Xe=n[30]<<9|n[31]>>>23,Fe=n[40]<<18|n[41]>>>14,Ce=n[41]<<18|n[40]>>>14,_e=n[2]<<1|n[3]>>>31,Se=n[3]<<1|n[2]>>>31,oe=n[13]<<12|n[12]>>>20,ae=n[12]<<12|n[13]>>>20,Be=n[22]<<10|n[23]>>>22,Le=n[23]<<10|n[22]>>>22,ye=n[33]<<13|n[32]>>>19,we=n[32]<<13|n[33]>>>19,Qe=n[42]<<2|n[43]>>>30,Ze=n[43]<<2|n[42]>>>30,He=n[5]<<30|n[4]>>>2,ze=n[4]<<30|n[5]>>>2,Ie=n[14]<<6|n[15]>>>26,Ae=n[15]<<6|n[14]>>>26,le=n[25]<<11|n[24]>>>21,ce=n[24]<<11|n[25]>>>21,$e=n[34]<<15|n[35]>>>17,We=n[35]<<15|n[34]>>>17,ve=n[45]<<29|n[44]>>>3,Te=n[44]<<29|n[45]>>>3,he=n[6]<<28|n[7]>>>4,xe=n[7]<<28|n[6]>>>4,Ve=n[17]<<23|n[16]>>>9,Ge=n[16]<<23|n[17]>>>9,Ee=n[26]<<25|n[27]>>>7,Ne=n[27]<<25|n[26]>>>7,ue=n[36]<<21|n[37]>>>11,de=n[37]<<21|n[36]>>>11,Ke=n[47]<<24|n[46]>>>8,je=n[46]<<24|n[47]>>>8,Re=n[8]<<27|n[9]>>>5,De=n[9]<<27|n[8]>>>5,pe=n[18]<<20|n[19]>>>12,me=n[19]<<20|n[18]>>>12,qe=n[29]<<7|n[28]>>>25,Je=n[28]<<7|n[29]>>>25,Ue=n[38]<<8|n[39]>>>24,Oe=n[39]<<8|n[38]>>>24,fe=n[48]<<14|n[49]>>>18,be=n[49]<<14|n[48]>>>18,n[0]=ie^~oe&le,n[1]=se^~ae&ce,n[10]=he^~pe&ge,n[11]=xe^~me&ke,n[20]=_e^~Ie&Ee,n[21]=Se^~Ae&Ne,n[30]=Re^~Pe&Be,n[31]=De^~Me&Le,n[40]=He^~Ve&qe,n[41]=ze^~Ge&Je,n[2]=oe^~le&ue,n[3]=ae^~ce&de,n[12]=pe^~ge&ye,n[13]=me^~ke&we,n[22]=Ie^~Ee&Ue,n[23]=Ae^~Ne&Oe,n[32]=Pe^~Be&$e,n[33]=Me^~Le&We,n[42]=Ve^~qe&Ye,n[43]=Ge^~Je&Xe,n[4]=le^~ue&fe,n[5]=ce^~de&be,n[14]=ge^~ye&ve,n[15]=ke^~we&Te,n[24]=Ee^~Ue&Fe,n[25]=Ne^~Oe&Ce,n[34]=Be^~$e&Ke,n[35]=Le^~We&je,n[44]=qe^~Ye&Qe,n[45]=Je^~Xe&Ze,n[6]=ue^~fe&ie,n[7]=de^~be&se,n[16]=ye^~ve&he,n[17]=we^~Te&xe,n[26]=Ue^~Fe&_e,n[27]=Oe^~Ce&Se,n[36]=$e^~Ke&Re,n[37]=We^~je&De,n[46]=Ye^~Qe&He,n[47]=Xe^~Ze&ze,n[8]=fe^~ie&oe,n[9]=be^~se&ae,n[18]=ve^~he&pe,n[19]=Te^~xe&me,n[28]=Fe^~_e&Ie,n[29]=Ce^~Se&Ae,n[38]=Ke^~Re&Pe,n[39]=je^~De&Me,n[48]=Qe^~He&Ve,n[49]=Ze^~ze&Ge,n[0]^=W[u],n[1]^=W[u+1]};if(d)t.exports=F;else for(C=0;C<V.length;++C)s[V[C]]=F[V[C]]})()})(Di);const Pi=Object.prototype.toString,Mi="[object Uint8Array]";function Bi(t){return t?t.constructor===Uint8Array?!0:Pi.call(t)===Mi:!1}function Li(t){if(!Bi(t))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof t}\``)}const $i=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Wi(t){Li(t);let e="";for(let r=0;r<t.length;r++)e+=$i[t[r]];return e}function Ki(t){return Ri(t)}function ji(t){return Wi(Ki(t))}var Hi=typeof self=="object"?self.FormData:window.FormData;function zi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return typeof process<"u"&&process.env[t]?process.env[t]:e}const Mn=".ipfscdn.io",Vi=".thirdwebstorage-staging.com",Gi=[`https://{clientId}${Mn}/ipfs/{cid}/{path}`];function yt(t){const e=new URL(t).hostname;return e.endsWith(Mn)?!0:e.endsWith(Vi)}const qi=["https://{cid}.ipfs.cf-ipfs.com/{path}","https://{cid}.ipfs.dweb.link/{path}","https://ipfs.io/ipfs/{cid}/{path}","https://cloudflare-ipfs.com/ipfs/{cid}/{path}","https://{cid}.ipfs.w3s.link/{path}","https://w3s.link/ipfs/{cid}/{path}","https://nftstorage.link/ipfs/{cid}/{path}","https://gateway.pinata.cloud/ipfs/{cid}/{path}"],Ji={"ipfs://":[...Gi,...qi]},Yi=zi("CUSTOM_UPLOAD_SERVER_URL","https://storage.thirdweb.com");function Xi(t){return Array.isArray(t)?{"ipfs://":t}:t||{}}function Qi(t,e,r){const i=e.split("/"),s=es(i[0]),a=i.slice(1).join("/");let o=t;if(t.includes("{cid}")&&t.includes("{path}")?o=o.replace("{cid}",s).replace("{path}",a):t.includes("{cid}")?o=o.replace("{cid}",s):o+=`${s}/${a}`,t.includes("{clientId}")){if(!r)throw new Error("Cannot use {clientId} in gateway URL without providing a client ID");o=o.replace("{clientId}",r)}return o}function Zi(t,e,r){const i={...Ji,...t};for(const s of Object.keys(i)){const a=i[s].map(o=>{if(e&&o.includes("{clientId}"))return o.replace("{clientId}",e);if(r&&o.includes("{clientId}")){if(typeof window<"u")throw new Error("Cannot use secretKey in browser context");const b=ji(r).slice(0,32);return o.replace("{clientId}",b)}else return o.includes("{clientId}")?void 0:o}).filter(o=>o!==void 0);i[s]=a}return i}function es(t){let e="";try{const r=t.split("/")[0];e=vi.base32(r)}catch{throw new Error(`The CID ${t} is not valid.`)}return e}function ln(){return typeof window<"u"}function at(t){return globalThis.File&&t instanceof File}function H(t){return globalThis.Buffer&&t instanceof Buffer}function lt(t){return!!(t&&t.name&&t.data&&typeof t.name=="string"&&(typeof t.data=="string"||H(t.data)))}function Q(t){return at(t)||H(t)||lt(t)}function ts(t,e){if(at(t)&&at(e)){if(t.name===e.name&&t.lastModified===e.lastModified&&t.size===e.size)return!0}else{if(H(t)&&H(e))return t.equals(e);if(lt(t)&&lt(e)&&t.name===e.name){if(typeof t.data=="string"&&typeof e.data=="string")return t.data===e.data;if(H(t.data)&&H(e.data))return t.data.equals(e.data)}}return!1}function ns(t,e){const r=t.replace("{cid}","(?<hash>[^/]+)").replace("{path}","(?<path>[^?#]+)"),i=new RegExp(r),s=e.match(i);if(s){const a=s.groups?.hash,o=s.groups?.path,d=e.includes("?")?e.substring(e.indexOf("?")+1):"";return{hash:a,path:o,query:d}}}function rs(t,e){for(const r of Object.keys(e))for(const i of e[r])if(i.includes("{cid}")){const s=ns(i,t);if(s?.hash&&s?.path){const a=s?.query?`?${s?.query}`:"";return`${r}${s?.hash}/${s?.path}${a}`}else return t}else if(t.startsWith(i))return t.replace(i,r);return t}function Pt(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=Object.keys(e).find(d=>t.startsWith(d)),a=s?e[s]:[];if(!s&&r>0||s&&r>=a.length)return;if(!s)return t;const o=t.replace(s,"");try{return Qi(a[r],o,i)}catch{console.warn(`The IPFS uri: ${o} is not valid.`);return}}function It(t,e){return typeof t=="string"?rs(t,e):typeof t=="object"?!t||Q(t)?t:Array.isArray(t)?t.map(r=>It(r,e)):Object.fromEntries(Object.entries(t).map(r=>{let[i,s]=r;return[i,It(s,e)]})):t}function ct(t,e,r){return typeof t=="string"?Pt(t,e,0,r):typeof t=="object"?!t||Q(t)?t:Array.isArray(t)?t.map(i=>ct(i,e,r)):Object.fromEntries(Object.entries(t).map(i=>{let[s,a]=i;return[s,ct(a,e,r)]})):t}function At(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(Q(t))return e.push(t),e;if(typeof t=="object"){if(!t)return e;Array.isArray(t)?t.forEach(r=>At(r,e)):Object.keys(t).map(r=>At(t[r],e))}return e}function Et(t,e){if(Q(t)){if(e.length)return t=e.shift(),t;console.warn("Not enough URIs to replace all files in object.")}return typeof t=="object"?t&&(Array.isArray(t)?t.map(r=>Et(r,e)):Object.fromEntries(Object.entries(t).map(r=>{let[i,s]=r;return[i,Et(s,e)]}))):t}var nt={name:"@thirdweb-dev/storage",version:"2.0.15",main:"dist/thirdweb-dev-storage.cjs.js",module:"dist/thirdweb-dev-storage.esm.js",exports:{".":{module:"./dist/thirdweb-dev-storage.esm.js",default:"./dist/thirdweb-dev-storage.cjs.js"},"./package.json":"./package.json"},repository:"https://github.com/thirdweb-dev/js/tree/main/legacy_packages/storage",author:"thirdweb eng <eng@thirdweb.com>",license:"Apache-2.0",sideEffects:!1,scripts:{format:"prettier --write 'src/**/*'",lint:"eslint src/",fix:"eslint src/ --fix",clean:"rm -rf dist/",build:"tsc && preconstruct build",test:"vitest run",push:"yalc push",typedoc:"node scripts/typedoc.mjs"},files:["dist/"],preconstruct:{exports:!0},devDependencies:{"@microsoft/api-documenter":"^7.24.1","@microsoft/api-extractor":"^7.43.0","@microsoft/tsdoc":"^0.14.2","@preconstruct/cli":"2.7.0","@swc-node/register":"^1.9.0","@thirdweb-dev/tsconfig":"^0.1.7","@types/uuid":"^9.0.8",eslint:"8.57.0","eslint-config-thirdweb":"^0.1.9","eslint-plugin-tsdoc":"^0.2.17",esm:"^3.2.25",rimraf:"5.0.5","typedoc-gen":"^1.0.2",typescript:"5.4.4"},dependencies:{"@thirdweb-dev/crypto":"0.2.6","cid-tool":"^3.0.0","form-data":"^4.0.0",uuid:"^9.0.1"},engines:{node:">=18"}};const cn=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function is(t){for(let e=0,r=cn.length;e<r;e++){const i=cn[e];if(!i)continue;const[s,a]=i;if(a.exec(t))return s}return null}function un(){if(typeof navigator<"u"&&navigator.product==="ReactNative")return"";if(typeof window<"u"){const t=navigator.userAgent;return is(t)||""}else return process.platform}function Bn(t){const e=Mt();t["x-sdk-version"]=e.x_sdk_version,t["x-sdk-name"]=e.x_sdk_name,t["x-sdk-platform"]=e.x_sdk_platform,t["x-sdk-os"]=e.x_sdk_os,e.app_bundle_id&&(t["x-bundle-id"]=e.app_bundle_id)}function ss(t){const e=Mt();t.setRequestHeader("x-sdk-version",e.x_sdk_version),t.setRequestHeader("x-sdk-os",e.x_sdk_os),t.setRequestHeader("x-sdk-name",e.x_sdk_name),t.setRequestHeader("x-sdk-platform",e.x_sdk_platform),e.app_bundle_id&&t.setRequestHeader("x-bundle-id",e.app_bundle_id)}function Mt(){return typeof globalThis>"u"?{x_sdk_name:nt.name,x_sdk_platform:dn(),x_sdk_version:nt.version,x_sdk_os:un(),app_bundle_id:void 0}:(globalThis.X_SDK_NAME===void 0&&(globalThis.X_SDK_NAME=nt.name,globalThis.X_SDK_PLATFORM=dn(),globalThis.X_SDK_VERSION=nt.version,globalThis.X_SDK_OS=un(),globalThis.APP_BUNDLE_ID=void 0),{x_sdk_name:globalThis.X_SDK_NAME,x_sdk_platform:globalThis.X_SDK_PLATFORM,x_sdk_version:globalThis.X_SDK_VERSION,x_sdk_os:globalThis.X_SDK_OS,app_bundle_id:globalThis.APP_BUNDLE_ID||""})}function dn(){return typeof navigator<"u"&&navigator.product==="ReactNative"?"mobile":typeof window<"u"?"browser":"node"}class os{constructor(e){pt(this,"DEFAULT_TIMEOUT_IN_SECONDS",60);pt(this,"DEFAULT_MAX_RETRIES",3);this.secretKey=e.secretKey,this.clientId=e.clientId,this.defaultTimeout=e.timeoutInSeconds||this.DEFAULT_TIMEOUT_IN_SECONDS}async download(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=i?.maxRetries||this.DEFAULT_MAX_RETRIES;if(s>a)return console.error("[FAILED_TO_DOWNLOAD_ERROR] Failed to download from URI - too many attempts failed."),new Response(JSON.stringify({error:"Not Found"}),{status:404,headers:{"Content-Type":"application/json"}});let o=Pt(e,r,s,this.clientId);if(o)s>0&&console.warn(`Retrying download with backup gateway URL: ${o}`);else return console.error("[FAILED_TO_DOWNLOAD_ERROR] Unable to download from URI - all gateway URLs failed to respond."),new Response(JSON.stringify({error:"Not Found"}),{status:404,headers:{"Content-Type":"application/json"}});let d={};if(yt(o)){const v=Mt().app_bundle_id;this.secretKey?d={"x-secret-key":this.secretKey}:this.clientId&&(!o.includes("bundleId")&&v&&(o=o+(v?`?bundleId=${v}`:"")),d["x-client-Id"]=this.clientId),typeof globalThis<"u"&&"TW_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_AUTH_TOKEN=="string"&&(d={...d,authorization:`Bearer ${globalThis.TW_AUTH_TOKEN}`}),typeof globalThis<"u"&&"TW_CLI_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_CLI_AUTH_TOKEN=="string"&&(d={...d,authorization:`Bearer ${globalThis.TW_CLI_AUTH_TOKEN}`},d["x-authorize-wallet"]="true"),Bn(d)}if(as(o))return this.download(e,r,i,s+1);const b=new AbortController,m=i?.timeoutInSeconds||this.defaultTimeout,y=setTimeout(()=>b.abort(),m*1e3),h=await fetch(o,{headers:d,signal:b.signal}).catch(v=>v);if(y&&clearTimeout(y),!("status"in h))throw new Error(`Request timed out after ${m} seconds. ${yt(o)?"You can update the timeoutInSeconds option to increase the timeout.":"You're using a public IPFS gateway, pass in a clientId or secretKey for a reliable IPFS gateway."}`);return h.ok?h:h.status===429?(ls(o,h),this.download(e,r,i,s+1)):h.status===410?(console.error(`Request to ${o} failed because this content seems to be blocklisted. Search VirusTotal for this URL to confirm: ${o} `),h):(console.warn(`Request to ${o} failed with status ${h.status} - ${h.statusText}`),h.status===404&&yt(o)||h.status!==408&&h.status!==429&&h.status<500?h:this.download(e,r,i,s+1))}}const Nt=new Map;function as(t){return Nt.has(t)}const wt=new Map;function ls(t,e){wt.has(t)&&clearTimeout(wt.get(t));const r=e.headers.get("Retry-After");let i=5e3;if(r){const s=parseInt(r);isNaN(s)||(i=s*1e3)}Nt.set(t,!0),wt.set(t,setTimeout(()=>Nt.delete(t),i))}class cs{constructor(e){this.uploadWithGatewayUrl=e?.uploadWithGatewayUrl||!1,this.uploadServerUrl=e?.uploadServerUrl||Yi,this.clientId=e?.clientId,this.secretKey=e?.secretKey}async uploadBatch(e,r){if(r?.uploadWithoutDirectory&&e.length>1)throw new Error("[UPLOAD_WITHOUT_DIRECTORY_ERROR] Cannot upload more than one file or object without directory!");const i=new Hi,{form:s,fileNames:a}=this.buildFormData(i,e,r);return ln()?this.uploadBatchBrowser(s,a,r):this.uploadBatchNode(s,a,r)}buildFormData(e,r,i){const s=new Map,a=[];for(let d=0;d<r.length;d++){const b=r[d];let m="",y=b;if(at(b))if(i?.rewriteFileNames){let v="";if(b.name){const I=b.name.lastIndexOf(".");I>-1&&(v=b.name.substring(I))}m=`${d+i.rewriteFileNames.fileStartNumber}${v}`}else m=`${b.name}`;else lt(b)?(y=b.data,i?.rewriteFileNames?m=`${d+i.rewriteFileNames.fileStartNumber}`:m=`${b.name}`):i?.rewriteFileNames?m=`${d+i.rewriteFileNames.fileStartNumber}`:m=`${d}`;const h=i?.uploadWithoutDirectory?"files":`files/${m}`;if(s.has(m)){if(ts(s.get(m),b)){a.push(m);continue}throw new Error(`[DUPLICATE_FILE_NAME_ERROR] File name ${m} was passed for more than one different file.`)}s.set(m,b),a.push(m),ln()?e.append("file",new Blob([y]),h):e.append("file",y,{filepath:h})}const o={name:"Storage SDK",keyvalues:{...i?.metadata}};return e.append("pinataMetadata",JSON.stringify(o)),i?.uploadWithoutDirectory&&e.append("pinataOptions",JSON.stringify({wrapWithDirectory:!1})),{form:e,fileNames:a.map(d=>encodeURIComponent(d))}}async uploadBatchBrowser(e,r,i){return new Promise((s,a)=>{const o=new XMLHttpRequest;let d=setTimeout(()=>{o.abort(),a(new Error("Request to upload timed out! No upload progress received in 30s"))},3e4);o.upload.addEventListener("loadstart",()=>{console.log(`[${Date.now()}] [IPFS] Started`)}),o.upload.addEventListener("progress",b=>{console.log(`[IPFS] Progress Event ${b.loaded}/${b.total}`),clearTimeout(d),b.loaded<b.total?d=setTimeout(()=>{o.abort(),a(new Error("Request to upload timed out! No upload progress received in 30s"))},3e4):console.log(`[${Date.now()}] [IPFS] Uploaded files. Waiting for response.`),b.lengthComputable&&i?.onProgress&&i?.onProgress({progress:b.loaded,total:b.total})}),o.addEventListener("load",()=>{if(console.log(`[${Date.now()}] [IPFS] Load`),clearTimeout(d),o.status>=200&&o.status<300){let b;try{b=JSON.parse(o.responseText)}catch{return a(new Error("Failed to parse JSON from upload response"))}const m=b.IpfsHash;if(!m)throw new Error("Failed to get IPFS hash from upload response");return i?.uploadWithoutDirectory?s([`ipfs://${m}`]):s(r.map(y=>`ipfs://${m}/${y}`))}return a(new Error(`Upload failed with status ${o.status} - ${o.responseText}`))}),o.addEventListener("error",()=>(console.log("[IPFS] Load"),clearTimeout(d),o.readyState!==0&&o.readyState!==4||o.status===0?a(new Error("Upload failed due to a network error.")):a(new Error("Unknown upload error occured")))),o.open("POST",`${this.uploadServerUrl}/ipfs/upload`),this.secretKey?o.setRequestHeader("x-secret-key",this.secretKey):this.clientId&&o.setRequestHeader("x-client-id",this.clientId),ss(o),typeof globalThis<"u"&&"TW_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_AUTH_TOKEN=="string"&&o.setRequestHeader("authorization",`Bearer ${globalThis.TW_AUTH_TOKEN}`),typeof globalThis<"u"&&"TW_CLI_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_CLI_AUTH_TOKEN=="string"&&(o.setRequestHeader("authorization",`Bearer ${globalThis.TW_CLI_AUTH_TOKEN}`),o.setRequestHeader("x-authorize-wallet","true")),o.send(e)})}async uploadBatchNode(e,r,i){i?.onProgress&&console.warn("The onProgress option is only supported in the browser");const s={};this.secretKey?s["x-secret-key"]=this.secretKey:this.clientId&&(s["x-client-id"]=this.clientId),typeof globalThis<"u"&&"TW_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_AUTH_TOKEN=="string"&&(s.authorization=`Bearer ${globalThis.TW_AUTH_TOKEN}`),typeof globalThis<"u"&&"TW_CLI_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_CLI_AUTH_TOKEN=="string"&&(s.authorization=`Bearer ${globalThis.TW_CLI_AUTH_TOKEN}`,s["x-authorize-wallet"]="true"),Bn(s);const a=await fetch(`${this.uploadServerUrl}/ipfs/upload`,{method:"POST",headers:{...s,...e.getHeaders()},body:e.getBuffer()});if(!a.ok)throw a.status===401?new Error("Unauthorized - You don't have permission to use this service."):new Error(`Failed to upload files to IPFS - ${a.status} - ${a.statusText} - ${await a.text()}`);const d=(await a.json()).IpfsHash;if(!d)throw new Error("Failed to upload files to IPFS - Bad CID");return i?.uploadWithoutDirectory?[`ipfs://${d}`]:r.map(b=>`ipfs://${d}/${b}`)}}class us{constructor(e){this.uploader=e?.uploader||new cs({clientId:e?.clientId,secretKey:e?.secretKey,uploadServerUrl:e?.uploadServerUrl}),this.downloader=e?.downloader||new os({secretKey:e?.secretKey,clientId:e?.clientId}),this.gatewayUrls=Zi(Xi(e?.gatewayUrls),e?.clientId,e?.secretKey),this.clientId=e?.clientId}resolveScheme(e){return Pt(e,this.gatewayUrls,0,this.clientId)}async download(e,r){return this.downloader.download(e,this.gatewayUrls,r)}async downloadJSON(e,r){const s=await(await this.download(e,r)).json();return ct(s,this.gatewayUrls,this.clientId)}async upload(e,r){const[i]=await this.uploadBatch([e],r);return i}async uploadBatch(e,r){if(e=e.filter(a=>a!==void 0),!e.length)return[];const i=e.map(a=>Q(a)||typeof a=="string").every(a=>!!a);let s=[];if(i)s=await this.uploader.uploadBatch(e,r);else{const a=(await this.uploadAndReplaceFilesWithHashes(e,r)).map(o=>typeof o=="string"?o:JSON.stringify(o));s=await this.uploader.uploadBatch(a,r)}return r?.uploadWithGatewayUrl||this.uploader.uploadWithGatewayUrl?s.map(a=>this.resolveScheme(a)):s}getGatewayUrls(){return this.gatewayUrls}async uploadAndReplaceFilesWithHashes(e,r){let i=e;i=It(i,this.gatewayUrls);const s=At(i);if(s.length){const a=await this.uploader.uploadBatch(s,r);i=Et(i,a)}return(r?.uploadWithGatewayUrl||this.uploader.uploadWithGatewayUrl)&&(i=ct(i,this.gatewayUrls,this.clientId)),i}}async function ds(t){const e=Qn();return await new us({clientId:e.thirdwebClientId}).upload(t)}const fs={name:"FileUploadInput",props:["btnCls","maxFileSize","storageType"],emits:["processUploadedFileUrl"],data(){return{componentId:null,file:null,newFileName:null,uploadedFileSize:null,uploadToken:null,waitingUpload:!1}},mounted(){this.componentId=this.$.uid},computed:{fileTooBig(){if(this.uploadedFileSize)return this.maxFileSize&&this.uploadedFileSize>this.maxFileSize}},methods:{async fallbackUpload(){const t=window.location.origin;let e;this.$config.fileUploadTokenService==="netlify"?e=t+"/.netlify/functions/imageUploaderFallback":this.$config.fileUploadTokenService==="vercel"&&(e=t+"/api/imageUploaderFallback");const r=await $fetch(e).catch(o=>o.data);let i=r;typeof r=="string"&&(i=JSON.parse(r));const a=await new Sr({publicKey:this.$config.imagekitPublicKey,urlEndpoint:this.$config.imagekitEndpoint}).upload({file:this.file,fileName:this.newFileName,tags:[this.$config.projectName,this.$config.projectUrl],token:i.data.token,signature:i.data.signature,expire:i.data.expire});this.$emit("processUploadedFileUrl",a.url),this.waitingUpload=!1},handleFileInput(t){const e=t.target.files[0];if(this.uploadedFileSize=e.size,this.maxFileSize&&e.size>this.maxFileSize){const a=this.maxFileSize/1024/1024;console.error("File is too large (max size is "+a+" MB)");return}const i=e.name.split(".").pop();this.newFileName=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+"."+i;const s=new File([e],this.newFileName,{type:e.type});this.file=s},async uploadFile(){if(this.waitingUpload=!0,this.storageType==="ipfs")try{const t=await ds(this.file);this.$emit("processUploadedFileUrl",t)}catch(t){console.error("Error uploading file to IPFS",t),console.log("Falling back to centralized storage service"),await this.fallbackUpload()}else await this.fallbackUpload();this.waitingUpload=!1}}},bs=["id"],hs=["disabled"],xs={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},ps={key:0,class:"alert alert-danger mt-3",role:"alert"};function ms(t,e,r,i,s,a){return B(),L(er,null,[S("input",{onChange:e[0]||(e[0]=(...o)=>a.handleFileInput&&a.handleFileInput(...o)),type:"file",class:"form-control form-control-lg mb-3",id:"file-input-"+s.componentId},null,40,bs),S("button",{type:"button",class:vt(r.btnCls),onClick:e[1]||(e[1]=(...o)=>a.uploadFile&&a.uploadFile(...o)),disabled:s.waitingUpload||!s.file||a.fileTooBig},[s.waitingUpload?(B(),L("span",xs)):Y("",!0),Zn(" Upload ")],10,hs),a.fileTooBig?(B(),L("div",ps," File is too big (max size is "+Tt(r.maxFileSize/1024/1024)+" MB). ",1)):Y("",!0)],64)}const gs=xn(fs,[["render",ms]]),ks={name:"FileUploadModal",props:["title","componentId","infoText","maxFileSize","storageType"],emits:["processFileUrl"],components:{FileUploadInput:gs},data(){return{currentTab:"upload",pastedLink:null}},mounted(){this.fileUploadEnabled||(this.currentTab="paste")},computed:{fileUploadEnabled(){return this.siteStore.getFileUploadEnabled},getTitle(){return this.title||"Upload file"}},methods:{processUploadedFileUrl(t){this.$emit("processFileUrl",t),document.getElementById("closeFileUploadModal"+this.componentId).click()}},setup(){return{siteStore:Vn()}},watch:{fileUploadEnabled(){this.fileUploadEnabled?this.currentTab="upload":this.currentTab="paste"}}},ys=["id","aria-labelledby"],ws={class:"modal-dialog"},vs={class:"modal-content"},Ts={class:"modal-header"},_s=["id"],Ss=["id"],Is={class:"modal-body mb-4"},As={class:"nav nav-tabs nav-fill"},Es={class:"nav-item"},Ns=["disabled"],Us={class:"nav-item"},Os={class:"tab-content mt-3"},Fs={key:0},Cs={key:0},Rs={key:1},Ds=S("p",null,"Paste file link",-1),Ps=["disabled"];function Ms(t,e,r,i,s,a){const o=tr("FileUploadInput");return B(),L("div",{class:"modal fade",id:"fileUploadModal"+r.componentId,tabindex:"-1","aria-labelledby":"fileUploadModalLabel"+r.componentId,"aria-hidden":"true"},[S("div",ws,[S("div",vs,[S("div",Ts,[S("h1",{class:"modal-title fs-5",id:"fileUploadModalLabel"+r.componentId},Tt(a.getTitle),9,_s),S("button",{id:"closeFileUploadModal"+r.componentId,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,8,Ss)]),S("div",Is,[S("ul",As,[S("li",Es,[S("button",{disabled:!this.fileUploadEnabled,class:vt(["nav-link",s.currentTab==="upload"?"active":""]),onClick:e[0]||(e[0]=d=>s.currentTab="upload")}," Upload ",10,Ns)]),S("li",Us,[S("button",{class:vt(["nav-link",s.currentTab==="paste"?"active":""]),onClick:e[1]||(e[1]=d=>s.currentTab="paste")}," Paste Link ",2)])]),S("div",Os,[s.currentTab==="upload"?(B(),L("div",Fs,[r.infoText?(B(),L("p",Cs,Tt(r.infoText),1)):Y("",!0),nr(o,{btnCls:"btn btn-primary",maxFileSize:r.maxFileSize,storageType:"ipfs",onProcessUploadedFileUrl:a.processUploadedFileUrl},null,8,["maxFileSize","onProcessUploadedFileUrl"])])):Y("",!0),s.currentTab==="paste"?(B(),L("div",Rs,[Ds,rr(S("input",{"onUpdate:modelValue":e[2]||(e[2]=d=>s.pastedLink=d),type:"text",class:"form-control mb-3",placeholder:"Enter http link to file"},null,512),[[ir,s.pastedLink]]),S("button",{class:"btn btn-primary",onClick:e[3]||(e[3]=d=>a.processUploadedFileUrl(s.pastedLink)),disabled:!s.pastedLink}," Submit link ",8,Ps)])):Y("",!0)])])])])],8,ys)}const Ws=xn(ks,[["render",Ms]]);export{Ws as F,gs as a};
