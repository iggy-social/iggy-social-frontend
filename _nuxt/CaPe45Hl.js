import{_ as F,W as v,S as q,I as A,r as b,c as m,o as c,b as u,a as i,w as S,T as M,d as I,t as r,M as B,H,g as d,p as g,f as N,v as f,a3 as L,q as h,s as y,F as x,x as V,y as j,i as E,j as w,a4 as W,C as R,l as z,m as K,n as O}from"#entry";import{I as Y}from"./BRYG_3z3.js";import{F as G}from"./jep2RLa4.js";import"./CudJIIoR.js";const J={name:"NftCreate",data(){return{cDescription:null,cImage:null,cName:null,cSymbol:null,isMounted:!1,launchpadPaused:null,nftName:null,createPriceWei:null,ratio:null,showAdvancedSettings:!1,uniqueId:null,waitingCreate:!1,waitingData:!1}},components:{ConnectWalletButton:A,FileUploadModal:G,Image:Y,SwitchChainButton:q,WaitingToast:v},mounted(){this.isMounted=!0,this.ratio=this.$config.public.nftDefaultRatio,this.fetchData()},computed:{cleanDescription(){return this.cDescription?this.cDescription.replace(/"/g,"'"):null},createPrice(){if(!this.createPriceWei)return null;const t=Number(O(this.createPriceWei));return t>.01?Number.parseFloat(t.toFixed(5)):t>1e-4?Number.parseFloat(t.toFixed(7)):Number.parseFloat(t)},fieldsValid(){return this.cName&&this.cSymbol&&this.cImage&&this.cDescription&&this.ratio},isSupportedChain(){return this.chainId===this.$config.public.supportedChainId}},methods:{calculatePrice(t,e){const l=Number(t)-1;return(l*(l+1)*(2*l+1)-(l-1)*l*(2*(l-1)+1))*1e4/42069*Number(e)/31337},async createCollection(){const t=this.toast({component:v,props:{text:"Please confirm the transaction."}},{type:"info"});this.waitingCreate=!0;let e;if(this.isConnected)try{const l=[{name:"launch",type:"function",stateMutability:"payable",inputs:[{name:"contractOwner_",type:"address"},{name:"referrer_",type:"address"},{name:"mdDescription_",type:"string"},{name:"mdImage_",type:"string"},{name:"mdName_",type:"string"},{name:"name_",type:"string"},{name:"symbol_",type:"string"},{name:"uniqueId_",type:"string"},{name:"ratio_",type:"uint256"}],outputs:[]}],o={address:this.$config.public.nftLaunchpadBondingAddress,abi:l,functionName:"launch",args:[this.address,W(window),this.cleanDescription,this.cImage,this.cName,this.cName,this.cSymbol,this.uniqueId,R(String(this.ratio))],value:BigInt(this.createPriceWei)},n=await z(o);this.toast.dismiss(t),e=this.toast({component:v,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+n,"_blank").focus()});const s=await K(n);if(s.status==="success"){this.toast.dismiss(e),this.toast("You have successfully created an NFT collection!",{type:"success",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+n,"_blank").focus()});const C=[{name:"getNftContractAddress",type:"function",stateMutability:"view",inputs:[{name:"_uniqueId",type:"string"}],outputs:[{name:"",type:"address"}]}],p=await w({address:this.$config.public.nftLaunchpadBondingAddress,abi:C,functionName:"getNftContractAddress",args:[this.uniqueId]});this.$router.push({path:"/nft/collection",query:{id:p}}),this.waitingCreate=!1}else this.toast.dismiss(e),this.waitingCreate=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+n,"_blank").focus()}),console.log(s)}catch(l){console.error(l);try{let o=l.message.split("Details:")[1];o=o.split("Version: viem")[0],o=o.replace(/"/g,""),o=o.replace("execution reverted:","Error:"),console.log(o),this.toast(o,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingCreate=!1}finally{this.toast.dismiss(t),this.toast.dismiss(e),this.waitingCreate=!1}this.waitingCreate=!1},async fetchData(){this.waitingData=!0;try{const t=[{name:"paused",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"bool"}]},{name:"isUniqueIdAvailable",type:"function",stateMutability:"view",inputs:[{name:"_uniqueId",type:"string"}],outputs:[{name:"",type:"bool"}]},{name:"price",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"uint256"}]}];this.launchpadPaused=await w({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"paused",args:[]}),this.uniqueId=Math.random().toString(36).slice(2),await w({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"isUniqueIdAvailable",args:[this.uniqueId]})||(this.uniqueId=Math.random().toString(36).slice(10)),this.createPriceWei=await w({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"price",args:[]}),this.waitingData=!1}catch(t){console.error("Error fetching data:",t),this.waitingData=!1}},insertImage(t){this.cImage=t.replace("?.img","")},toggleAdvancedSettings(){this.showAdvancedSettings=!this.showAdvancedSettings}},setup(){const t=V(),{address:e,chainId:l,isConnected:o}=j({config:t}),n=E();return{address:e,chainId:l,isConnected:o,toast:n}}},Q={class:"card border scroll-500"},X={class:"card-body"},Z={class:"fs-3"},_={key:0,class:"d-flex justify-content-center mb-3"},$={key:1,class:"mb-4"},ee={class:"mb-4"},te={class:"mb-4"},ie={class:"mb-2"},ne={class:"input-group","aria-describedby":"cImageHelp",id:"cImage"},se=["data-bs-target"],oe={key:2,class:"mb-4"},ae={class:"mb-4"},le={class:"mb-4 mt-4"},re={class:"mb-4"},ce={id:"ratioHelp",class:"form-text"},de={class:"d-flex justify-content-center mt-4 mb-5"},ue=["disabled"],pe={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},me={key:1,disabled:!0,class:"btn btn-primary"};function ge(t,e,l,o,n,s){const C=M,p=B,k=H,D=b("Image"),T=b("ConnectWalletButton"),P=b("SwitchChainButton"),U=b("FileUploadModal");return c(),m(x,null,[u(k,null,{default:S(()=>[u(C,null,{default:S(()=>[I("Create NFT Collection | "+r(t.$config.public.projectMetadataTitle),1)]),_:1}),u(p,{property:"og:title",content:"Create NFT Collection | "+t.$config.public.projectMetadataTitle},null,8,["content"]),u(p,{name:"description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"]),u(p,{property:"og:image",content:t.$config.public.projectUrl+t.$config.public.previewImageNftCreate},null,8,["content"]),u(p,{property:"og:description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"]),u(p,{name:"twitter:image",content:t.$config.public.projectUrl+t.$config.public.previewImageNftCreate},null,8,["content"]),u(p,{name:"twitter:description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"])]),_:1}),i("div",Q,[i("div",X,[i("p",Z,[i("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:e[0]||(e[0]=a=>t.$router.back())})]),e[24]||(e[24]=i("h3",{class:"mb-4 mt-3"},"Create NFT Collection",-1)),n.waitingData?(c(),m("div",_,[...e[9]||(e[9]=[i("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1)])])):d("",!0),s.createPrice?(c(),m("p",$," Price for creating a collection is "+r(s.createPrice)+" "+r(t.$config.public.tokenSymbol)+". ",1)):d("",!0),i("div",ee,[e[10]||(e[10]=i("label",{for:"cName",class:"form-label"},"Collection Name",-1)),g(i("input",{type:"text",class:"form-control",id:"cName","aria-describedby":"cNameHelp",placeholder:"e.g. Crypto Punks","onUpdate:modelValue":e[1]||(e[1]=a=>n.cName=a)},null,512),[[f,n.cName]]),e[11]||(e[11]=i("div",{id:"cNameHelp",class:"form-text"},"This is not a token name, but the whole collection name.",-1))]),i("div",te,[e[12]||(e[12]=i("label",{for:"cSymbol",class:"form-label"},"Collection Symbol",-1)),g(i("input",{type:"text",class:"form-control",id:"cSymbol","aria-describedby":"cSymbolHelp",placeholder:"e.g. PUNKS","onUpdate:modelValue":e[2]||(e[2]=a=>n.cSymbol=a)},null,512),[[f,n.cSymbol]]),e[13]||(e[13]=i("div",{id:"cSymbolHelp",class:"form-text"}," Collection symbol (required by the ERC-721 smart contract, but not really important). ",-1))]),i("div",ie,[e[15]||(e[15]=i("label",{for:"cImage",class:"form-label"},"Collection Image (can be changed later)",-1)),i("div",ne,[g(i("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>n.cImage=a),type:"text",class:"form-control",placeholder:"Enter image URL or click the upload button"},null,512),[[f,n.cImage]]),o.isConnected&&t.$config.public.fileUploadEnabled!==""?(c(),m("button",{key:0,class:"btn btn-outline-secondary rounded-end-2","data-bs-toggle":"modal","data-bs-target":"#fileUploadModal"+t.$.uid},[...e[14]||(e[14]=[i("i",{class:"bi bi-file-earmark-image-fill"},null,-1),I(" Upload ",-1)])],8,se)):d("",!0)]),e[16]||(e[16]=i("div",{id:"cImageHelp",class:"form-text"}," Even if you want a generative PFP collection, put a single preview image for now and you will change it to a metadata link later. ",-1))]),n.cImage?(c(),m("div",oe,[u(D,{url:n.cImage,alt:"Image",cls:"img-thumbnail img-fluid",style:{"max-width":"100px"}},null,8,["url"]),e[17]||(e[17]=i("br",null,null,-1)),e[18]||(e[18]=i("small",null,"If image didn't appear above, then something is wrong with the link you added (wait until the loading indicator completes). If you have an IPFS link, it also helps to cut/paste the same link a couple of times.",-1))])):d("",!0),i("div",ae,[e[19]||(e[19]=i("label",{for:"cDescription",class:"form-label"},"Collection Description (can be changed later)",-1)),g(i("input",{type:"text",class:"form-control",id:"cDescription","aria-describedby":"cDescriptionHelp",placeholder:"Keep it short and sweet.","onUpdate:modelValue":e[4]||(e[4]=a=>n.cDescription=a)},null,512),[[f,n.cDescription]]),e[20]||(e[20]=i("div",{id:"cDescriptionHelp",class:"form-text"},"Too long description means higher gas cost for storing it.",-1))]),i("div",null,[i("small",null,[i("em",null,[i("span",{class:"link-without-color cursor-pointer hover-color",onClick:e[5]||(e[5]=(...a)=>s.toggleAdvancedSettings&&s.toggleAdvancedSettings(...a)),style:{"text-decoration":"underline"}},r(n.showAdvancedSettings?"Hide":"Show")+" Advanced Settings ",1)])])]),g(i("div",null,[i("div",le,[e[21]||(e[21]=i("label",{for:"uniqueId",class:"form-label"},"Unique ID (store it - just in case)",-1)),g(i("input",{type:"text",class:"form-control",id:"uniqueId","aria-describedby":"uniqueIdHelp",disabled:"",readonly:"","onUpdate:modelValue":e[6]||(e[6]=a=>n.uniqueId=a)},null,512),[[f,n.uniqueId]]),e[22]||(e[22]=i("div",{id:"uniqueIdHelp",class:"form-text"}," This is just in case the frontend will not show you the NFT collection address and you'll need to find it manually. ",-1))]),i("div",re,[e[23]||(e[23]=i("label",{for:"ratio",class:"form-label"},"Bonding Curve Ratio",-1)),g(i("input",{type:"text",class:"form-control",id:"ratio","aria-describedby":"ratioHelp","onUpdate:modelValue":e[7]||(e[7]=a=>n.ratio=a)},null,512),[[f,n.ratio]]),i("div",ce," Price for mint #1 will be "+r(("getLessDecimals"in t?t.getLessDecimals:h(y))(s.calculatePrice(2,n.ratio)))+" "+r(t.$config.public.tokenSymbol)+", for mint #5 will be "+r(("getLessDecimals"in t?t.getLessDecimals:h(y))(s.calculatePrice(5,n.ratio)))+" "+r(t.$config.public.tokenSymbol)+", for mint #15 will be "+r(("getLessDecimals"in t?t.getLessDecimals:h(y))(s.calculatePrice(15,n.ratio)))+" "+r(t.$config.public.tokenSymbol)+", for mint #30 will be "+r(("getLessDecimals"in t?t.getLessDecimals:h(y))(s.calculatePrice(30,n.ratio)))+" "+r(t.$config.public.tokenSymbol)+", etc. ",1)])],512),[[L,n.showAdvancedSettings]]),i("div",de,[o.isConnected&&s.isSupportedChain&&!n.launchpadPaused?(c(),m("button",{key:0,disabled:n.waitingCreate||!s.fieldsValid,class:"btn btn-primary",type:"button",onClick:e[8]||(e[8]=(...a)=>s.createCollection&&s.createCollection(...a))},[n.waitingData||n.waitingCreate?(c(),m("span",pe)):d("",!0),I(" Create NFT Collection for "+r(s.createPrice)+" "+r(t.$config.public.tokenSymbol),1)],8,ue)):d("",!0),o.isConnected&&s.isSupportedChain&&n.launchpadPaused?(c(),m("button",me," Paused ")):d("",!0),!o.isConnected&&!s.isSupportedChain?(c(),N(T,{key:2,class:"btn-primary",btnText:"Connect wallet"})):d("",!0),o.isConnected&&!s.isSupportedChain?(c(),N(P,{key:3})):d("",!0)]),n.isMounted?(c(),N(U,{key:3,onProcessFileUrl:s.insertImage,title:"Upload your NFT image",infoText:"Upload the NFT image.",storageType:t.$config.public.fileUploadStorageType,componentId:t.$.uid,maxFileSize:t.$config.public.fileUploadSizeLimit},null,8,["onProcessFileUrl","storageType","componentId","maxFileSize"])):d("",!0)])])],64)}const we=F(J,[["render",ge]]);export{we as default};
