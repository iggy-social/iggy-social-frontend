import{H as y,T as x,M as P}from"./components.2e3fc91a.js";import{C as w}from"./ChatPost.3ddc263f.js";import{a as m,x as v,o as i,b as a,f as e,y as k,z as T,E as L,t as u,F as p,G as S,c as N,m as c,r as _,e as l,w as h,i as M}from"./entry.7de1064c.js";import"./composables.8c6fb2ba.js";import"./user.14b19209.js";import"./domainUtils.bc9e2318.js";import"./MintedPostImage.5cdf29c4.js";import"./WaitingToast.a0e7f801.js";import"./textUtils.6fc66bac.js";import"./storageUtils.b3563441.js";const j={name:"SearchPosts",data(){return{orbisPosts:[],pageCounter:0,queryTerm:null,searched:!1,selectedContext:this.$config.chatChannels.general,selectedContextName:"General discussion",showLoadMore:!1,waitingLoadPosts:!1}},components:{ChatPost:w},methods:{chooseContext(n){switch(this.orbisPosts=[],this.pageCounter=0,this.searched=!1,this.selectedContext=this.$config.chatChannels[n],console.log(this.selectedContext),n){case"general":this.selectedContextName="General discussion";break;case"memesImages":this.selectedContextName="Share Images & NFTs";break;case"shill":this.selectedContextName="Shill & discuss projects";break}},async search(){this.waitingLoadPosts=!0;let{data:n,error:t}=await this.$orbis.getPosts({context:this.selectedContext,term:this.queryTerm},this.pageCounter,this.$config.getPostsLimit,!1);t&&(this.toast("Error fetching posts from the Orbis/Ceramic node.",{type:"error"}),console.log(t)),n.length<this.$config.getPostsLimit?this.showLoadMore=!1:n.length===this.$config.getPostsLimit&&(this.showLoadMore=!0),this.orbisPosts.push(...n),this.pageCounter++,this.waitingLoadPosts=!1,this.searched=!0}},setup(){return{toast:v()}},watch:{queryTerm(n,t){n!==t&&(this.orbisPosts=[],this.pageCounter=0,this.searched=!1)}}},q={class:"input-group mb-3"},$={class:"dropdown d-flex justify-content-center mb-4"},V={class:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},B={class:"dropdown-menu"},F={class:"text-center"},G=["disabled"],E={key:0},H={key:1,class:"d-flex justify-content-center mt-5 mb-4"},I=e("p",null,"No posts. Try a different query.",-1),D=[I],K={key:2,class:"d-flex justify-content-center mb-3"},z=e("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1),O=[z],U={key:3,class:"d-grid gap-2 col-6 mx-auto mb-5"};function A(n,t,f,g,s,r){const d=_("ChatPost");return i(),a("div",null,[e("div",q,[k(e("input",{type:"text",class:"form-control text-center",placeholder:"enter a search term","onUpdate:modelValue":t[0]||(t[0]=o=>s.queryTerm=o),onKeyup:t[1]||(t[1]=L((...o)=>r.search&&r.search(...o),["enter"]))},null,544),[[T,s.queryTerm]])]),e("div",$,[e("button",V,u(s.selectedContextName),1),e("ul",B,[e("li",null,[e("button",{class:"dropdown-item",onClick:t[2]||(t[2]=o=>r.chooseContext("general"))},"General discussion")]),e("li",null,[e("button",{class:"dropdown-item",onClick:t[3]||(t[3]=o=>r.chooseContext("memesImages"))},"Share Images & NFTs")]),e("li",null,[e("button",{class:"dropdown-item",onClick:t[4]||(t[4]=o=>r.chooseContext("shill"))},"Shill & discuss projects")])])]),e("div",F,[e("button",{class:"btn btn-primary mt-2 mb-4",disabled:!s.queryTerm||s.waitingLoadPosts,onClick:t[5]||(t[5]=(...o)=>r.search&&r.search(...o))}," Search ",8,G)]),s.orbisPosts?(i(),a("div",E,[(i(!0),a(p,null,S(s.orbisPosts,o=>(i(),N(d,{key:o.stream_id,post:o,orbisContext:s.selectedContext},null,8,["post","orbisContext"]))),128))])):c("",!0),s.searched&&s.queryTerm&&s.orbisPosts.length===0&&!s.waitingLoadPosts?(i(),a("div",H,D)):c("",!0),s.waitingLoadPosts?(i(),a("div",K,O)):c("",!0),s.showLoadMore?(i(),a("div",U,[e("button",{class:"btn btn-primary",type:"button",onClick:t[6]||(t[6]=(...o)=>r.search&&r.search(...o))},"Load more posts")])):c("",!0)])}const J=m(j,[["render",A]]),Q={name:"SearchPostsPage",components:{SearchPosts:J}},R={class:"scroll-500"},W={class:"card border"},X={class:"card-body mb-3"},Y={class:"fs-3"},Z=e("h3",{class:"mt-3"},"Search posts",-1),ee={class:"d-flex justify-content-center mt-5"},te={class:"col-12 col-lg-8"};function se(n,t,f,g,s,r){const d=x,o=P,b=y,C=_("SearchPosts",!0);return i(),a(p,null,[l(b,null,{default:h(()=>[l(d,null,{default:h(()=>[M("Search posts | "+u(n.$config.projectMetadataTitle),1)]),_:1}),l(o,{property:"og:title",content:"Search posts | "+n.$config.projectMetadataTitle},null,8,["content"])]),_:1}),e("div",R,[e("div",W,[e("div",X,[e("p",Y,[e("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:t[0]||(t[0]=oe=>n.$router.back())})]),Z,e("div",ee,[e("div",te,[l(C)])])])])])],64)}const pe=m(Q,[["render",se]]);export{pe as default};
