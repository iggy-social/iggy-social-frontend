import{H as y,T as x,M as P}from"./components.181bece3.js";import{C as w}from"./ChatPost.ecad7bc3.js";import{a as m,K as v,r as u,o as i,b as a,f as e,L as k,M as T,O as L,t as p,F as _,P as S,c as N,l as c,e as l,w as h,i as M}from"./entry.7c042a75.js";import"./composables.780fa693.js";import"./ethers.3b8b80c6.js";import"./user.4f889728.js";import"./domainUtils.2ec8d682.js";import"./SwitchChainButton.f8bec162.js";import"./WaitingToast.d0edce34.js";import"./textUtils.e9422dff.js";import"./storageUtils.6673db6d.js";import"./MintedPostImage.79aec646.js";const j={name:"SearchPosts",data(){return{orbisPosts:[],pageCounter:0,queryTerm:null,searched:!1,selectedContext:this.$config.chatChannels.general,selectedContextName:"General discussion",showLoadMore:!1,waitingLoadPosts:!1}},components:{ChatPost:w},methods:{chooseContext(n){switch(this.orbisPosts=[],this.pageCounter=0,this.searched=!1,this.selectedContext=this.$config.chatChannels[n],console.log(this.selectedContext),n){case"general":this.selectedContextName="General discussion";break;case"memesImages":this.selectedContextName="Share Images & NFTs";break;case"shill":this.selectedContextName="Shill & discuss projects";break}},async search(){this.waitingLoadPosts=!0;let{data:n,error:t}=await this.$orbis.getPosts({context:this.selectedContext,term:this.queryTerm},this.pageCounter,this.$config.getPostsLimit,!1);t&&(this.toast("Error fetching posts from the Orbis/Ceramic node.",{type:"error"}),console.log(t)),n.length<this.$config.getPostsLimit?this.showLoadMore=!1:n.length===this.$config.getPostsLimit&&(this.showLoadMore=!0),this.orbisPosts.push(...n),this.pageCounter++,this.waitingLoadPosts=!1,this.searched=!0}},setup(){return{toast:v()}},watch:{queryTerm(n,t){n!==t&&(this.orbisPosts=[],this.pageCounter=0,this.searched=!1)}}},q={class:"input-group mb-3"},$={class:"dropdown d-flex justify-content-center mb-4"},V={class:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},B={class:"dropdown-menu"},F={class:"text-center"},G=["disabled"],H={key:0},I={key:1,class:"d-flex justify-content-center mt-5 mb-4"},K=e("p",null,"No posts. Try a different query.",-1),D=[K],E={key:2,class:"d-flex justify-content-center mb-3"},O=e("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1),U=[O],z={key:3,class:"d-grid gap-2 col-6 mx-auto mb-5"};function A(n,t,f,g,s,r){const d=u("ChatPost");return i(),a("div",null,[e("div",q,[k(e("input",{type:"text",class:"form-control text-center",placeholder:"enter a search term","onUpdate:modelValue":t[0]||(t[0]=o=>s.queryTerm=o),onKeyup:t[1]||(t[1]=L((...o)=>r.search&&r.search(...o),["enter"]))},null,544),[[T,s.queryTerm]])]),e("div",$,[e("button",V,p(s.selectedContextName),1),e("ul",B,[e("li",null,[e("button",{class:"dropdown-item",onClick:t[2]||(t[2]=o=>r.chooseContext("general"))},"General discussion")]),e("li",null,[e("button",{class:"dropdown-item",onClick:t[3]||(t[3]=o=>r.chooseContext("memesImages"))},"Share Images & NFTs")]),e("li",null,[e("button",{class:"dropdown-item",onClick:t[4]||(t[4]=o=>r.chooseContext("shill"))},"Shill & discuss projects")])])]),e("div",F,[e("button",{class:"btn btn-primary mt-2 mb-4",disabled:!s.queryTerm||s.waitingLoadPosts,onClick:t[5]||(t[5]=(...o)=>r.search&&r.search(...o))}," Search ",8,G)]),s.orbisPosts?(i(),a("div",H,[(i(!0),a(_,null,S(s.orbisPosts,o=>(i(),N(d,{key:o.stream_id,post:o,orbisContext:s.selectedContext},null,8,["post","orbisContext"]))),128))])):c("",!0),s.searched&&s.queryTerm&&s.orbisPosts.length===0&&!s.waitingLoadPosts?(i(),a("div",I,D)):c("",!0),s.waitingLoadPosts?(i(),a("div",E,U)):c("",!0),s.showLoadMore?(i(),a("div",z,[e("button",{class:"btn btn-primary",type:"button",onClick:t[6]||(t[6]=(...o)=>r.search&&r.search(...o))},"Load more posts")])):c("",!0)])}const J=m(j,[["render",A]]),Q={name:"SearchPostsPage",components:{SearchPosts:J}},R={class:"scroll-500"},W={class:"card border"},X={class:"card-body mb-3"},Y={class:"fs-3"},Z=e("h3",{class:"mt-3"},"Search posts",-1),ee={class:"d-flex justify-content-center mt-5"},te={class:"col-12 col-lg-8"};function se(n,t,f,g,s,r){const d=x,o=P,b=y,C=u("SearchPosts",!0);return i(),a(_,null,[l(b,null,{default:h(()=>[l(d,null,{default:h(()=>[M("Search posts | "+p(n.$config.projectMetadataTitle),1)]),_:1}),l(o,{property:"og:title",content:"Search posts | "+n.$config.projectMetadataTitle},null,8,["content"])]),_:1}),e("div",R,[e("div",W,[e("div",X,[e("p",Y,[e("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:t[0]||(t[0]=oe=>n.$router.back())})]),Z,e("div",ee,[e("div",te,[l(C)])])])])])],64)}const fe=m(Q,[["render",se]]);export{fe as default};
