import{_ as P,W as v,S as q,I as M,r as g,c as p,o as c,b as d,a as i,w as k,T as B,d as I,t as l,M as L,H,g as u,f as N,p as f,v as b,q as y,s as h,F as A,x as V,y as j,i as E,j as C,a3 as x,C as W,l as R,m as z,n as K}from"#entry";import{I as O}from"./BRYG_3z3.js";import{F as Y}from"./DDgOngC9.js";import"./B07vffDX.js";const G={name:"NftCreate",data(){return{cDescription:null,cImage:null,cName:null,cSymbol:null,isMounted:!1,launchpadPaused:null,nftName:null,createPriceWei:null,ratio:null,uniqueId:null,waitingCreate:!1,waitingData:!1}},components:{ConnectWalletButton:M,FileUploadModal:Y,Image:O,SwitchChainButton:q,WaitingToast:v},mounted(){this.isMounted=!0,this.ratio=this.$config.public.nftDefaultRatio,this.fetchData()},computed:{cleanDescription(){return this.cDescription?this.cDescription.replace(/"/g,"'"):null},createPrice(){if(!this.createPriceWei)return null;const t=Number(K(this.createPriceWei));return t>.01?Number.parseFloat(t.toFixed(5)):t>1e-4?Number.parseFloat(t.toFixed(7)):Number.parseFloat(t)},fieldsValid(){return this.cName&&this.cSymbol&&this.cImage&&this.cDescription&&this.ratio},isSupportedChain(){return this.chainId===this.$config.public.supportedChainId}},methods:{calculatePrice(t,e){const o=Number(t)-1;return(o*(o+1)*(2*o+1)-(o-1)*o*(2*(o-1)+1))*1e4/42069*Number(e)/31337},async createCollection(){this.waitingCreate=!0;let t;if(this.isConnected)try{const e=[{name:"launch",type:"function",stateMutability:"payable",inputs:[{name:"contractOwner_",type:"address"},{name:"referrer_",type:"address"},{name:"mdDescription_",type:"string"},{name:"mdImage_",type:"string"},{name:"mdName_",type:"string"},{name:"name_",type:"string"},{name:"symbol_",type:"string"},{name:"uniqueId_",type:"string"},{name:"ratio_",type:"uint256"}],outputs:[]}],o={address:this.$config.public.nftLaunchpadBondingAddress,abi:e,functionName:"launch",args:[this.address,x(window),this.cleanDescription,this.cImage,this.cName,this.cName,this.cSymbol,this.uniqueId,W(String(this.ratio))],value:BigInt(this.createPriceWei)},r=await R(o);t=this.toast({component:v,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+r,"_blank").focus()});const n=await z(r);if(n.status==="success"){this.toast.dismiss(t),this.toast("You have successfully created an NFT collection!",{type:"success",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+r,"_blank").focus()});const s=[{name:"getNftContractAddress",type:"function",stateMutability:"view",inputs:[{name:"_uniqueId",type:"string"}],outputs:[{name:"",type:"address"}]}],w=await C({address:this.$config.public.nftLaunchpadBondingAddress,abi:s,functionName:"getNftContractAddress",args:[this.uniqueId]});this.$router.push({path:"/nft/collection",query:{id:w}}),this.waitingCreate=!1}else this.toast.dismiss(t),this.waitingCreate=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+r,"_blank").focus()}),console.log(n)}catch(e){console.error(e);try{let o=e.message.split("Details:")[1];o=o.split("Version: viem")[0],o=o.replace(/"/g,""),o=o.replace("execution reverted:","Error:"),console.log(o),this.toast(o,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waitingCreate=!1}finally{this.toast.dismiss(t),this.waitingCreate=!1}this.waitingCreate=!1},async fetchData(){this.waitingData=!0;try{const t=[{name:"paused",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"bool"}]},{name:"isUniqueIdAvailable",type:"function",stateMutability:"view",inputs:[{name:"_uniqueId",type:"string"}],outputs:[{name:"",type:"bool"}]},{name:"price",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"uint256"}]}];this.launchpadPaused=await C({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"paused",args:[]}),this.uniqueId=Math.random().toString(36).slice(2),await C({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"isUniqueIdAvailable",args:[this.uniqueId]})||(this.uniqueId=Math.random().toString(36).slice(10)),this.createPriceWei=await C({address:this.$config.public.nftLaunchpadBondingAddress,abi:t,functionName:"price",args:[]}),this.waitingData=!1}catch(t){console.error("Error fetching data:",t),this.waitingData=!1}},insertImage(t){this.cImage=t.replace("?.img","")}},setup(){const t=V(),{address:e,chainId:o,isConnected:r}=j({config:t}),n=E();return{address:e,chainId:o,isConnected:r,toast:n}}},J={class:"card border scroll-500"},Q={class:"card-body"},X={class:"fs-3"},Z={key:0,class:"d-flex justify-content-center mb-3"},_={key:1,class:"mb-4"},$={class:"mb-4"},ee={class:"mb-4"},te={class:"mb-2"},ie={class:"input-group","aria-describedby":"cImageHelp",id:"cImage"},ne=["data-bs-target"],oe={key:2,class:"mb-4"},se={class:"mb-4"},ae={class:"mb-4"},le={class:"mb-4"},re={id:"ratioHelp",class:"form-text"},ce={class:"d-flex justify-content-center mt-5 mb-5"},ue=["disabled"],de={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},pe={key:1,disabled:!0,class:"btn btn-primary"};function me(t,e,o,r,n,s){const w=B,m=L,D=H,S=g("Image"),T=g("ConnectWalletButton"),U=g("SwitchChainButton"),F=g("FileUploadModal");return c(),p(A,null,[d(D,null,{default:k(()=>[d(w,null,{default:k(()=>[I("Create NFT Collection | "+l(t.$config.public.projectMetadataTitle),1)]),_:1}),d(m,{property:"og:title",content:"Create NFT Collection | "+t.$config.public.projectMetadataTitle},null,8,["content"]),d(m,{name:"description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"]),d(m,{property:"og:image",content:t.$config.public.projectUrl+t.$config.public.previewImageNftCreate},null,8,["content"]),d(m,{property:"og:description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"]),d(m,{name:"twitter:image",content:t.$config.public.projectUrl+t.$config.public.previewImageNftCreate},null,8,["content"]),d(m,{name:"twitter:description",content:"Create your very own NFT collection on "+t.$config.public.projectName+"!"},null,8,["content"])]),_:1}),i("div",J,[i("div",Q,[i("p",X,[i("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:e[0]||(e[0]=a=>t.$router.back())})]),e[23]||(e[23]=i("h3",{class:"mb-4 mt-3"},"Create NFT Collection",-1)),n.waitingData?(c(),p("div",Z,[...e[8]||(e[8]=[i("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1)])])):u("",!0),s.createPrice?(c(),p("p",_," Price for creating a collection is "+l(s.createPrice)+" "+l(t.$config.public.tokenSymbol)+". ",1)):u("",!0),i("div",$,[e[9]||(e[9]=i("label",{for:"cName",class:"form-label"},"Collection Name",-1)),f(i("input",{type:"text",class:"form-control",id:"cName","aria-describedby":"cNameHelp",placeholder:"e.g. Crypto Punks","onUpdate:modelValue":e[1]||(e[1]=a=>n.cName=a)},null,512),[[b,n.cName]]),e[10]||(e[10]=i("div",{id:"cNameHelp",class:"form-text"},"This is not a token name, but the whole collection name.",-1))]),i("div",ee,[e[11]||(e[11]=i("label",{for:"cSymbol",class:"form-label"},"Collection Symbol",-1)),f(i("input",{type:"text",class:"form-control",id:"cSymbol","aria-describedby":"cSymbolHelp",placeholder:"e.g. PUNKS","onUpdate:modelValue":e[2]||(e[2]=a=>n.cSymbol=a)},null,512),[[b,n.cSymbol]]),e[12]||(e[12]=i("div",{id:"cSymbolHelp",class:"form-text"}," Collection symbol (required by the ERC-721 smart contract, but not really important). ",-1))]),i("div",te,[e[14]||(e[14]=i("label",{for:"cImage",class:"form-label"},"Collection Image (can be changed later)",-1)),i("div",ie,[f(i("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>n.cImage=a),type:"text",class:"form-control",placeholder:"Enter image URL or click the upload button"},null,512),[[b,n.cImage]]),r.isConnected&&t.$config.public.fileUploadEnabled!==""?(c(),p("button",{key:0,class:"btn btn-outline-secondary rounded-end-2","data-bs-toggle":"modal","data-bs-target":"#fileUploadModal"+t.$.uid},[...e[13]||(e[13]=[i("i",{class:"bi bi-file-earmark-image-fill"},null,-1),I(" Upload ",-1)])],8,ne)):u("",!0)]),e[15]||(e[15]=i("div",{id:"cImageHelp",class:"form-text"}," Even if you want a generative PFP collection, put a single preview image for now and you will change it to a metadata link later. ",-1))]),n.cImage?(c(),p("div",oe,[d(S,{url:n.cImage,alt:"Image",cls:"img-thumbnail img-fluid",style:{"max-width":"100px"}},null,8,["url"]),e[16]||(e[16]=i("br",null,null,-1)),e[17]||(e[17]=i("small",null,"If image didn't appear above, then something is wrong with the link you added (wait until the loading indicator completes). If you have an IPFS link, it also helps to cut/paste the same link a couple of times.",-1))])):u("",!0),i("div",se,[e[18]||(e[18]=i("label",{for:"cDescription",class:"form-label"},"Collection Description (can be changed later)",-1)),f(i("input",{type:"text",class:"form-control",id:"cDescription","aria-describedby":"cDescriptionHelp",placeholder:"Keep it short and sweet.","onUpdate:modelValue":e[4]||(e[4]=a=>n.cDescription=a)},null,512),[[b,n.cDescription]]),e[19]||(e[19]=i("div",{id:"cDescriptionHelp",class:"form-text"},"Too long description means higher gas cost for storing it.",-1))]),i("div",ae,[e[20]||(e[20]=i("label",{for:"uniqueId",class:"form-label"},"Unique ID (store it - just in case)",-1)),f(i("input",{type:"text",class:"form-control",id:"uniqueId","aria-describedby":"uniqueIdHelp",disabled:"",readonly:"","onUpdate:modelValue":e[5]||(e[5]=a=>n.uniqueId=a)},null,512),[[b,n.uniqueId]]),e[21]||(e[21]=i("div",{id:"uniqueIdHelp",class:"form-text"}," This is just in case the frontend will not show you the NFT collection address and you'll need to find it manually. ",-1))]),i("div",le,[e[22]||(e[22]=i("label",{for:"ratio",class:"form-label"},"Bonding Curve Ratio",-1)),f(i("input",{type:"text",class:"form-control",id:"ratio","aria-describedby":"ratioHelp","onUpdate:modelValue":e[6]||(e[6]=a=>n.ratio=a)},null,512),[[b,n.ratio]]),i("div",re," Price for mint #1 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(h))(s.calculatePrice(2,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", for mint #5 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(h))(s.calculatePrice(5,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", for mint #15 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(h))(s.calculatePrice(15,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", for mint #30 will be "+l(("getLessDecimals"in t?t.getLessDecimals:y(h))(s.calculatePrice(30,n.ratio)))+" "+l(t.$config.public.tokenSymbol)+", etc. ",1)]),i("div",ce,[r.isConnected&&s.isSupportedChain&&!n.launchpadPaused?(c(),p("button",{key:0,disabled:n.waitingCreate||!s.fieldsValid,class:"btn btn-primary",type:"button",onClick:e[7]||(e[7]=(...a)=>s.createCollection&&s.createCollection(...a))},[n.waitingData||n.waitingCreate?(c(),p("span",de)):u("",!0),I(" Create NFT Collection for "+l(s.createPrice)+" "+l(t.$config.public.tokenSymbol),1)],8,ue)):u("",!0),r.isConnected&&s.isSupportedChain&&n.launchpadPaused?(c(),p("button",pe," Paused ")):u("",!0),!r.isConnected&&!s.isSupportedChain?(c(),N(T,{key:2,class:"btn-primary",btnText:"Connect wallet"})):u("",!0),r.isConnected&&!s.isSupportedChain?(c(),N(U,{key:3})):u("",!0)]),n.isMounted?(c(),N(F,{key:3,onProcessFileUrl:s.insertImage,title:"Upload your NFT image",infoText:"Upload the NFT image.",storageType:t.$config.public.fileUploadStorageType,componentId:t.$.uid,maxFileSize:t.$config.public.fileUploadSizeLimit},null,8,["onProcessFileUrl","storageType","componentId","maxFileSize"])):u("",!0)])])],64)}const he=P(G,[["render",me]]);export{he as default};
