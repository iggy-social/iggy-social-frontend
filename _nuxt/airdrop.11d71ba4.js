import{H as S,T as E,M as B}from"./components.356fe1b9.js";import{f as v,I as u,C as h,u as b}from"./ethers.8328e202.js";import{a as g,ae as T,o as d,b as p,f as o,t as c,af as A,ag as D,l as f,i as w,e as r,w as C,ah as _,F as I,r as k}from"./entry.4c969726.js";import{W as $}from"./WaitingToast.460d017b.js";import{u as W}from"./user.d03486f1.js";import"./composables.e96dca6d.js";const P={name:"AirdropDomainHolders",props:["domainChatRewardWei","loadingData"],data(){return{domainName:null,waiting:!1}},computed:{domainChatReward(){return Math.floor(Number(v(this.domainChatRewardWei)))}},methods:{async claim(){this.waiting=!0;const t=this.domainName.replace(this.$config.public.tldName,"").trim().toLowerCase();console.log(t);const a=new u(["function claim(string calldata _domainName) external"]),n=new h(this.$config.public.airdropClaimDomainsAddress,a,this.signer);try{const i=await n.claim(t),e=this.toast({component:$,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+i.hash,"_blank").focus()}),s=await i.wait();s.status===1?(this.toast.dismiss(e),this.toast("Airdrop for "+t+this.$config.public.tldName+" has been successfully claimed!",{type:"success",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+i.hash,"_blank").focus()}),this.userStore.addToChatTokenBalanceWei(this.domainChatRewardWei),this.waiting=!1):(this.toast.dismiss(e),this.waiting=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+i.hash,"_blank").focus()}),console.log(s))}catch(i){console.error(i);try{let e=i.message.split("Details:")[1];e=e.split("Version: viem@2.9.4")[0],e=e.replace(/"/g,""),e=e.replace("execution reverted:","Error:"),e=e.replace("ChatTokenClaimDomains: ",""),console.log(e),this.toast(e,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waiting=!1}}},setup(){const{address:t,signer:a}=b(),n=T(),i=W();return{address:t,signer:a,toast:n,userStore:i}}},U={class:"text-center"},j={class:"input-group mt-5"},M={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},H={class:"d-flex justify-content-center mt-4 mb-4"},V=["disabled"],Z={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},F=o("hr",null,null,-1),z={class:"text-center"};function L(t,a,n,i,e,s){return d(),p("div",null,[o("p",U," Claim "+c(s.domainChatReward)+" "+c(t.$config.public.chatTokenSymbol)+" airdrop for each "+c(t.$config.public.tldName)+" domain that you hold. ",1),o("div",j,[A(o("input",{"onUpdate:modelValue":a[0]||(a[0]=l=>e.domainName=l),type:"text",placeholder:"Enter domain name",class:"form-control"},null,512),[[D,e.domainName]]),o("button",M,c(t.$config.public.tldName),1)]),o("div",H,[o("button",{disabled:e.waiting||n.loadingData||!e.domainName,class:"btn btn-outline-primary",type:"button",onClick:a[1]||(a[1]=(...l)=>s.claim&&s.claim(...l))},[n.loadingData||e.waiting?(d(),p("span",Z)):f("",!0),w(" Claim ")],8,V)]),F,o("p",z,[o("small",null," Note that someone else can claim tokens (for a given domain) for you and save you on gas fees. You will still receive the same amount of "+c(t.$config.public.chatTokenSymbol)+" tokens as if you've made the claim yourself. ",1)])])}const Y=g(P,[["render",L]]),q={name:"AirdropActivityPoints",props:["airdropApWei","loadingData"],emits:["setDomainChatRewardWeiToZero"],data(){return{waiting:!1}},computed:{airdropAp(){return Math.round(Number(v(this.airdropApWei)))}},methods:{async claim(){this.waiting=!0;const t=new u(["function claim() external"]),a=new h(this.$config.public.airdropApAddress,t,this.signer);try{const n=await a.claim(),i=this.toast({component:$,props:{text:"Please wait for your transaction to confirm. Click on this notification to see transaction in the block explorer."}},{type:"info",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+n.hash,"_blank").focus()}),e=await n.wait();e.status===1?(this.toast.dismiss(i),this.userStore.addToChatTokenBalanceWei(this.airdropApWei),this.$emit("setDomainChatRewardWeiToZero"),this.toast("Airdrop for past APs has been successfully claimed!",{type:"success",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+n.hash,"_blank").focus()}),this.waiting=!1):(this.toast.dismiss(i),this.waiting=!1,this.toast("Transaction has failed.",{type:"error",onClick:()=>window.open(this.$config.public.blockExplorerBaseUrl+"/tx/"+n.hash,"_blank").focus()}),console.log(e))}catch(n){console.error(n);try{let i=n.message.split("reason=")[1];i=i.split(", method=")[0],i=i.replace(/"/g,""),i=i.replace("execution reverted:","Error:"),i=i.replace("ChatTokenClaimActivityPoints: ",""),console.log(i),this.toast(i,{type:"error"})}catch{this.toast("Transaction has failed.",{type:"error"})}this.waiting=!1}}},setup(){const{address:t,signer:a}=b(),n=T(),i=W();return{address:t,signer:a,toast:n,userStore:i}}},G={class:"text-center"},J={class:"input-group mt-5"},K={class:"btn btn-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},O={class:"d-flex justify-content-center mt-4 mb-4"},Q=["disabled"],X={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},tt=o("hr",null,null,-1),et={class:"text-center"};function ot(t,a,n,i,e,s){return d(),p("div",null,[o("p",G,"Claim "+c(s.airdropAp)+" "+c(t.$config.public.chatTokenSymbol)+" airdrop for past activity points.",1),o("div",J,[A(o("input",{"onUpdate:modelValue":a[0]||(a[0]=l=>s.airdropAp=l),type:"text",class:"form-control",disabled:""},null,512),[[D,s.airdropAp]]),o("button",K,c(t.$config.public.chatTokenSymbol),1)]),o("div",O,[o("button",{disabled:e.waiting||n.loadingData||s.airdropAp==0,class:"btn btn-outline-primary",type:"button",onClick:a[1]||(a[1]=(...l)=>s.claim&&s.claim(...l))},[n.loadingData||e.waiting?(d(),p("span",X)):f("",!0),w(" Claim ")],8,Q)]),tt,o("p",et,[o("small",null," If you're not eligible, or have already claimed the airdrop, the amount of "+c(t.$config.public.chatTokenSymbol)+" tokens shown is 0. ",1)])])}const it=g(q,[["render",ot]]),at={name:"Airdrop",data(){return{airdropApWei:0,currentTab:"domain",domainChatRewardWei:1e14,fetchingData:!1}},components:{AirdropDomainHolders:Y,AirdropActivityPoints:it},mounted(){this.currentTab=localStorage.getItem("airdropCurrentTab"),this.currentTab||(this.currentTab="domain"),this.address&&this.fetchAirdropData()},methods:{changeCurrentTab(t){this.currentTab=t,localStorage.setItem("airdropCurrentTab",t)},async fetchAirdropData(){this.fetchingData=!0;const t=new u(["function chatReward() external view returns (uint256)"]),a=new h(this.$config.public.airdropClaimDomainsAddress,t,this.signer);this.domainChatRewardWei=await a.chatReward();const n=new u(["function claimPreview(address _address) public view returns (uint256)"]),i=new h(this.$config.public.airdropApAddress,n,this.signer);this.airdropApWei=await i.claimPreview(this.address),this.fetchingData=!1},setDomainChatRewardWeiToZero(){this.domainChatRewardWei=0}},setup(){const{address:t,signer:a}=b();return{address:t,signer:a}},watch:{address(){this.fetchAirdropData()}}},nt={class:"card border scroll-500"},st={class:"card-body"},rt={class:"fs-3"},ct={class:"nav nav-tabs nav-fill"},lt={class:"nav-item"},dt={class:"nav-item"},pt={class:"tab-content mt-3"},mt={key:0},ut={class:"d-flex justify-content-center mt-5"},ht={class:"col-12 col-lg-8"},ft={key:1},bt={class:"d-flex justify-content-center mt-5"},gt={class:"col-12 col-lg-8"};function wt(t,a,n,i,e,s){const l=E,m=B,x=S,N=k("AirdropDomainHolders"),R=k("AirdropActivityPoints");return d(),p(I,null,[r(x,null,{default:C(()=>[r(l,null,{default:C(()=>[w("Airdrop | "+c(t.$config.public.projectMetadataTitle),1)]),_:1}),r(m,{property:"og:title",content:"Airdrop"}),r(m,{name:"description",content:"Claim your "+t.$config.public.chatTokenSymbol+" token airdrop on "+t.$config.public.projectName+"!"},null,8,["content"]),r(m,{property:"og:image",content:t.$config.public.projectUrl+t.$config.public.previewImageAirdrop},null,8,["content"]),r(m,{property:"og:description",content:"Claim your "+t.$config.public.chatTokenSymbol+" token airdrop on "+t.$config.public.projectName+"!"},null,8,["content"]),r(m,{name:"twitter:image",content:t.$config.public.projectUrl+t.$config.public.previewImageAirdrop},null,8,["content"]),r(m,{name:"twitter:description",content:"Claim your "+t.$config.public.chatTokenSymbol+" token airdrop on "+t.$config.public.projectName+"!"},null,8,["content"])]),_:1}),o("div",nt,[o("div",st,[o("p",rt,[o("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:a[0]||(a[0]=y=>t.$router.back())})]),o("ul",ct,[o("li",lt,[o("button",{class:_(["nav-link",e.currentTab==="domain"?"active":""]),onClick:a[1]||(a[1]=y=>s.changeCurrentTab("domain"))}," Domain holders ",2)]),o("li",dt,[o("button",{class:_(["nav-link",e.currentTab==="ap"?"active":""]),onClick:a[2]||(a[2]=y=>s.changeCurrentTab("ap"))}," Activity Points ",2)])]),o("div",pt,[e.currentTab==="domain"?(d(),p("div",mt,[o("div",ut,[o("div",ht,[r(N,{domainChatRewardWei:e.domainChatRewardWei,loadingData:e.fetchingData},null,8,["domainChatRewardWei","loadingData"])])])])):f("",!0),e.currentTab==="ap"?(d(),p("div",ft,[o("div",bt,[o("div",gt,[r(R,{airdropApWei:e.airdropApWei,loadingData:e.fetchingData,onSetDomainChatRewardWeiToZero:s.setDomainChatRewardWeiToZero},null,8,["airdropApWei","loadingData","onSetDomainChatRewardWeiToZero"])])])])):f("",!0)])])])],64)}const At=g(at,[["render",wt]]);export{At as default};
