import{_ as f,r as d,c as g,o as s,a as M,b as r,w as m,M as b,H as I,f as l,g as u,d as x,e as T,F as _,h as N,i as k,j as w}from"#entry";import{C as v,a as R}from"./4QSncEQG.js";import"./BxMuM4Bt.js";import"./CbD9lqld.js";import"./DxRcewtf.js";const F={data(){return{message:null,reply:null}},components:{ChatFeed:R,ChatMessage:v},created(){this.getMessage()},computed:{getChatContext(){return this.route.query.context},getMessageId(){return this.route.query.id},getReplyId(){return this.route.query.reply},isReply(){return!!this.route.query.reply},mainMessagePage(){return`/post/?id=${this.getMessageId}&context=${this.getChatContext}`}},methods:{async getMessage(){this.message=null,this.reply=null;try{const t={address:this.getChatContext,abi:[{inputs:[{internalType:"uint256",name:"mainMsgIndex_",type:"uint256"}],name:"getMainMessage",outputs:[{components:[{internalType:"address",name:"author",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"bool",name:"deleted",type:"bool"},{internalType:"uint256",name:"index",type:"uint256"},{internalType:"uint256",name:"repliesCount",type:"uint256"},{internalType:"string",name:"url",type:"string"}],internalType:"struct ChatFeed.Message",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"mainMsgIndex_",type:"uint256"},{internalType:"uint256",name:"replyMsgIndex_",type:"uint256"}],name:"getReply",outputs:[{components:[{internalType:"address",name:"author",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"bool",name:"deleted",type:"bool"},{internalType:"uint256",name:"index",type:"uint256"},{internalType:"uint256",name:"repliesCount",type:"uint256"},{internalType:"string",name:"url",type:"string"}],internalType:"struct ChatFeed.Message",name:"",type:"tuple"}],stateMutability:"view",type:"function"}],functionName:"getMainMessage",args:[BigInt(this.getMessageId)]};let e,n;if(e=await this.readData(t),this.isReply){const p={...t,functionName:"getReply",args:[BigInt(this.getMessageId),BigInt(this.getReplyId)]};n=await this.readData(p)}e&&!e.deleted?this.message={author:e.author,url:e.url,createdAt:Number(e.createdAt),deleted:e.deleted,repliesCount:Number(e.repliesCount),index:Number(e.index)}:e&&e.deleted&&this.toast("This message has been deleted.",{type:"info"}),n&&(n.deleted?this.toast("This reply has been deleted.",{type:"info"}):this.reply={author:n.author,url:n.url,createdAt:Number(n.createdAt),deleted:n.deleted,repliesCount:Number(n.repliesCount),index:Number(n.index)})}catch(t){console.error(t),this.toast("Failed to load the message",{type:"error"})}}},setup(){const t=N(),e=k(),{readData:n}=w();return{route:t,toast:e,readData:n}},watch:{getChatContext(t,e){this.getMessage()},getMessageId(t,e){this.getMessage()},getReplyId(t,e){this.getMessage()}}};function j(t,e,n,p,i,a){const o=b,y=I,c=d("ChatMessage"),h=d("ChatFeed"),C=T;return s(),g(_,null,[M("div",null,[r(y,null,{default:m(()=>[r(o,{name:"description",content:"Check out this chat post on "+t.$config.public.projectName+"!"},null,8,["content"]),r(o,{property:"og:image",content:t.$config.public.projectUrl+t.$config.public.previewImagePost},null,8,["content"]),r(o,{property:"og:description",content:"Check out this chat post on "+t.$config.public.projectName+"!"},null,8,["content"]),r(o,{name:"twitter:image",content:t.$config.public.projectUrl+t.$config.public.previewImagePost},null,8,["content"]),r(o,{name:"twitter:description",content:"Check out this chat post on "+t.$config.public.projectName+"!"},null,8,["content"])]),_:1})]),(s(),g("div",{key:i.message?.url},[i.message?(s(),l(c,{key:0,message:i.message,chatContext:a.getChatContext},null,8,["message","chatContext"])):u("",!0),i.reply?(s(),l(c,{key:1,message:i.reply,mainItemId:a.getMessageId,chatContext:a.getChatContext},null,8,["message","mainItemId","chatContext"])):u("",!0),a.isReply?u("",!0):(s(),l(h,{key:2,chatContext:a.getChatContext,mainItemId:a.getMessageId},null,8,["chatContext","mainItemId"])),a.isReply?(s(),l(C,{key:3,to:a.mainMessagePage,class:"btn btn-primary"},{default:m(()=>[...e[0]||(e[0]=[x("See other replies",-1)])]),_:1},8,["to"])):u("",!0)]))],64)}const D=f(F,[["render",j]]);export{D as default};
