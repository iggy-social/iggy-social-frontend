import{H as y,T as P,M as C}from"./components.2b193be1.js";import{C as x}from"./ChatPost.01562dec.js";import{a as u,x as w,o as n,b as a,f as s,y as v,z as T,E as L,F as m,G as k,c as M,m as c,r as p,e as l,w as h,i as S,t as q}from"./entry.c5a6be60.js";import"./composables.45600cfe.js";import"./user.9814cc04.js";import"./domainUtils.2b7d1dbf.js";import"./MintedPostImage.29347d49.js";import"./WaitingToast.068afcbb.js";import"./textUtils.77ea9a9a.js";import"./storageUtils.9fb65d58.js";const $={name:"SearchPosts",data(){return{orbisPosts:[],pageCounter:0,queryTerm:null,searched:!1,selectedContext:this.$config.chatChannels.general,showLoadMore:!1,waitingLoadPosts:!1}},components:{ChatPost:x},methods:{async search(){this.waitingLoadPosts=!0;let{data:r,error:t}=await this.$orbis.getPosts({context:this.selectedContext,term:this.queryTerm},this.pageCounter,this.$config.getPostsLimit,!1);t&&(this.toast("Error fetching posts from the Orbis/Ceramic node.",{type:"error"}),console.log(t)),r.length<this.$config.getPostsLimit?this.showLoadMore=!1:r.length===this.$config.getPostsLimit&&(this.showLoadMore=!0),this.orbisPosts.push(...r),this.pageCounter++,this.waitingLoadPosts=!1,this.searched=!0}},setup(){return{toast:w()}},watch:{queryTerm(r,t){r!==t&&(this.orbisPosts=[],this.pageCounter=0,this.searched=!1)}}},j={class:"input-group mb-3"},N={class:"text-center"},V=["disabled"],B={key:0},E={key:1,class:"d-flex justify-content-center mt-5 mb-4"},H=s("p",null,"No posts. Try a different query.",-1),D=[H],F={key:2,class:"d-flex justify-content-center mb-3"},K=s("span",{class:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"},null,-1),z=[K],G={key:3,class:"d-grid gap-2 col-6 mx-auto mb-5"};function O(r,t,_,f,e,i){const d=p("ChatPost");return n(),a("div",null,[s("div",j,[v(s("input",{type:"text",class:"form-control text-center",placeholder:"enter a search term","onUpdate:modelValue":t[0]||(t[0]=o=>e.queryTerm=o),onKeyup:t[1]||(t[1]=L((...o)=>i.search&&i.search(...o),["enter"]))},null,544),[[T,e.queryTerm]])]),s("div",N,[s("button",{class:"btn btn-primary mt-2 mb-4",disabled:!e.queryTerm||e.waitingLoadPosts,onClick:t[2]||(t[2]=(...o)=>i.search&&i.search(...o))}," Search ",8,V)]),e.orbisPosts?(n(),a("div",B,[(n(!0),a(m,null,k(e.orbisPosts,o=>(n(),M(d,{key:o.stream_id,post:o,orbisContext:e.selectedContext},null,8,["post","orbisContext"]))),128))])):c("",!0),e.searched&&e.queryTerm&&e.orbisPosts.length===0&&!e.waitingLoadPosts?(n(),a("div",E,D)):c("",!0),e.waitingLoadPosts?(n(),a("div",F,z)):c("",!0),e.showLoadMore?(n(),a("div",G,[s("button",{class:"btn btn-primary",type:"button",onClick:t[3]||(t[3]=(...o)=>i.search&&i.search(...o))},"Load more posts")])):c("",!0)])}const U=u($,[["render",O]]),A={name:"SearchPostsPage",components:{SearchPosts:U}},I={class:"scroll-500"},J={class:"card border"},Q={class:"card-body mb-3"},R={class:"fs-3"},W=s("h3",{class:"mt-3"},"Search posts",-1),X={class:"d-flex justify-content-center mt-5"},Y={class:"col-12 col-lg-8"};function Z(r,t,_,f,e,i){const d=P,o=C,g=y,b=p("SearchPosts",!0);return n(),a(m,null,[l(g,null,{default:h(()=>[l(d,null,{default:h(()=>[S("Search posts | "+q(r.$config.projectMetadataTitle),1)]),_:1}),l(o,{property:"og:title",content:"Search posts | "+r.$config.projectMetadataTitle},null,8,["content"])]),_:1}),s("div",I,[s("div",J,[s("div",Q,[s("p",R,[s("i",{class:"bi bi-arrow-left-circle cursor-pointer",onClick:t[0]||(t[0]=tt=>r.$router.back())})]),W,s("div",X,[s("div",Y,[l(b)])])])])])],64)}const ht=u(A,[["render",Z]]);export{ht as default};
