import{I as u,g as o}from"./Image.4021538c.js";import{I as c,C as m,u as f}from"./ethers.8328e202.js";import{f as l,s as g}from"./storageUtils.15eadf2e.js";import{a as h,o as p,b as w,ac as d}from"./entry.4c969726.js";const P={name:"ProfileImage",props:["domain","image"],components:{Image:u},data(){return{imgPath:null,defaultImage:"/img/user/anon.svg"}},created(){this.imgPath=this.defaultImage},mounted(){this.fetchProfilePicture()},computed:{domainName(){return this.domain?this.domain.replace(this.$config.public.tldName,""):null}},methods:{async fetchProfilePicture(){if(this.image){const t=await o(this.image);if(t.success)return this.imgPath=t.url}if(this.domainName){const t=l(window,this.domainName,"img",this.$config.public.expiryPfps);if(t){const e=await o(t.image);if(e.success)return this.imgPath=e.url}else{let e=this.$getFallbackProvider(this.$config.public.supportedChainId);this.isActivated&&this.chainId===this.$config.public.supportedChainId&&(e=this.signer);const i=new c(["function getDomainData(string calldata _domainName) public view returns(string memory) "]),n=new m(this.$config.public.punkTldAddress,i,e);try{const a=await n.getDomainData(String(this.domainName).toLowerCase());if(a){const s=JSON.parse(a);if(s?.image){const r=await o(s.image);if(r.success)return this.imgPath=r.url,g(window,this.domainName,{image:s.image},"img")}}}catch(a){console.error("Error fetching domain data:",a)}}}return this.imgPath=this.defaultImage}},setup(){const{signer:t,chainId:e,isActivated:i}=f();return{signer:t,chainId:e,isActivated:i}},watch:{domain(t,e){t!=e&&this.fetchProfilePicture()},image(t,e){t!=e&&(this.imgPath="https://placeholder.pics/svg/300/32BBFF/ffffff/loading",this.fetchProfilePicture())}}},I=["src","alt"];function b(t,e,i,n,a,s){return p(),w("img",{src:a.imgPath,alt:s.domainName,class:"rounded-circle"},null,8,I)}const k=h(P,[["render",b]]);async function $(t,e){const i=d();let n=e;const a=new c(["function defaultNames(address) view returns (string)"]);return await new m(i.public.punkTldAddress,a,n).defaultNames(t)}async function y(t,e){const i=d();let n=e;t.includes(i.public.tldName)&&(t=t.replace(i.public.tldName,""));const a=new c(["function getDomainHolder(string memory) public view returns(address)"]);return await new m(i.public.punkTldAddress,a,n).getDomainHolder(t)}export{k as P,y as a,$ as g};
