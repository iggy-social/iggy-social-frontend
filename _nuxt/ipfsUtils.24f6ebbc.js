var An=Object.defineProperty;var En=(e,t,i)=>t in e?An(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var ot=(e,t,i)=>(En(e,typeof t!="symbol"?t+"":t,i),i);import{N as Yt,O as Qt,P as In,Q as Zt,R as et,S as On,T as gt,U as Cn,V as Un,X as Nn,Y as Dt,E as Wn}from"./entry.2c2a56fd.js";function $n(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let i=0;i<e.byteLength;i++)if(e[i]!==t[i])return!1;return!0}const Fn=Object.freeze(Object.defineProperty({__proto__:null,equals:$n},Symbol.toStringTag,{value:"Module"}));var en={exports:{}},R={};const tn=Yt,{toString:Bn}=Qt,{fromString:Dn}=In;var nn={numberToUint8Array:Rn,uint8ArrayToNumber:rn,varintUint8ArrayEncode:Ln,varintEncode:Hn};function rn(e){return parseInt(Bn(e,"base16"),16)}function Rn(e){let t=e.toString(16);return t.length%2===1&&(t="0"+t),Dn(t,"base16")}function Ln(e){return Uint8Array.from(tn.encode(rn(e)))}function Hn(e){return Uint8Array.from(tn.encode(e))}const jn=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"eth-receipt-log-trie":153,"eth-reciept-log":154,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,"caip-50":202,streamid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,thread:406,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,noise:454,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,"swhid-1-snp":496,json:512,messagepack:513,"libp2p-peer-record":769,"libp2p-relay-rsvp":770,"car-index-sorted":1024,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,"secp256k1-priv":4865,"x25519-priv":4866,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056,"arweave-ns":11704592});var Pn={baseTable:jn};const{baseTable:ut}=Pn,Mn=nn.varintEncode,mt={},yt={},Ve={};for(const e in ut){const t=e,i=ut[t];mt[t]=Mn(i);const r=t.toUpperCase().replace(/-/g,"_");yt[r]=i,Ve[i]||(Ve[i]=t)}Object.freeze(mt);Object.freeze(yt);Object.freeze(Ve);const Kn=Object.freeze(ut);var zn={nameToVarint:mt,constantToCode:yt,nameToCode:Kn,codeToName:Ve};const Ge=Yt,{concat:qn}=Zt,sn=nn,{nameToVarint:Xe,constantToCode:Vn,nameToCode:on,codeToName:wt}=zn;function Gn(e,t){let i;if(e instanceof Uint8Array)i=sn.varintUint8ArrayEncode(e);else if(Xe[e])i=Xe[e];else throw new Error("multicodec not recognized");return qn([i,t],i.length+t.length)}function Xn(e){return Ge.decode(e),e.slice(Ge.decode.bytes)}function an(e){const t=Ge.decode(e),i=wt[t];if(i===void 0)throw new Error(`Code "${t}" not found`);return i}function cn(e){return wt[e]}function ln(e){const t=on[e];if(t===void 0)throw new Error(`Codec "${e}" not found`);return t}function bn(e){return Ge.decode(e)}function fn(e){const t=Xe[e];if(t===void 0)throw new Error(`Codec "${e}" not found`);return t}function un(e){return sn.varintEncode(e)}function Jn(e){return an(e)}function Yn(e){return cn(e)}function Qn(e){return ln(e)}function Zn(e){return bn(e)}function ei(e){return fn(e)}function ti(e){return Array.from(un(e))}var ni={addPrefix:Gn,rmPrefix:Xn,getNameFromData:an,getNameFromCode:cn,getCodeFromName:ln,getCodeFromData:bn,getVarintFromName:fn,getVarintFromCode:un,getCodec:Jn,getName:Yn,getNumber:Qn,getCode:Zn,getCodeVarint:ei,getVarint:ti,...Vn,nameToVarint:Xe,nameToCode:on,codeToName:wt};const ii=et,ri={checkCIDComponents:function(e){if(e==null)return"null values are not valid CIDs";if(!(e.version===0||e.version===1))return"Invalid version, must be a number equal to 1 or 0";if(typeof e.codec!="string")return"codec must be string";if(e.version===0){if(e.codec!=="dag-pb")return"codec must be 'dag-pb' for CIDv0";if(e.multibaseName!=="base58btc")return"multibaseName must be 'base58btc' for CIDv0"}if(!(e.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{ii.validate(e.multihash)}catch(t){let i=t.message;return i||(i="Multihash validation failed"),i}}};var si=ri;const oi=On(Fn),ze=et,at=gt.exports,W=ni,ai=si,{concat:Rt}=Zt,{toString:ci}=Qt,{equals:li}=oi,Je=W.nameToCode,bi=Object.keys(Je).reduce((e,t)=>(e[Je[t]]=t,e),{}),Lt=Symbol.for("@ipld/js-cid/CID");class I{constructor(t,i,r,s){if(this.version,this.codec,this.multihash,Object.defineProperty(this,Lt,{value:!0}),I.isCID(t)){const c=t;this.version=c.version,this.codec=c.codec,this.multihash=c.multihash,this.multibaseName=c.multibaseName||(c.version===0?"base58btc":"base32");return}if(typeof t=="string"){const c=at.isEncoded(t);if(c){const o=at.decode(t);this.version=parseInt(o[0].toString(),16),this.codec=W.getCodec(o.slice(1)),this.multihash=W.rmPrefix(o.slice(1)),this.multibaseName=c}else this.version=0,this.codec="dag-pb",this.multihash=ze.fromB58String(t),this.multibaseName="base58btc";I.validateCID(this),Object.defineProperty(this,"string",{value:t});return}if(t instanceof Uint8Array){const c=parseInt(t[0].toString(),16);if(c===1){const o=t;this.version=c,this.codec=W.getCodec(o.slice(1)),this.multihash=W.rmPrefix(o.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=t,this.multibaseName="base58btc";I.validateCID(this);return}this.version=t,typeof i=="number"&&(i=bi[i]),this.codec=i,this.multihash=r,this.multibaseName=s||(t===0?"base58btc":"base32"),I.validateCID(this)}get bytes(){let t=this._bytes;if(!t){if(this.version===0)t=this.multihash;else if(this.version===1){const i=W.getCodeVarint(this.codec);t=Rt([[1],i,this.multihash],1+i.byteLength+this.multihash.byteLength)}else throw new Error("unsupported version");Object.defineProperty(this,"_bytes",{value:t})}return t}get prefix(){const t=W.getCodeVarint(this.codec),i=ze.prefix(this.multihash);return Rt([[this.version],t,i],1+t.byteLength+i.byteLength)}get code(){return Je[this.codec]}toV0(){if(this.codec!=="dag-pb")throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:t,length:i}=ze.decode(this.multihash);if(t!=="sha2-256")throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(i!==32)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new I(0,this.codec,this.multihash)}toV1(){return new I(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(t=this.multibaseName){if(this.string&&this.string.length!==0&&t===this.multibaseName)return this.string;let i;if(this.version===0){if(t!=="base58btc")throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");i=ze.toB58String(this.multihash)}else if(this.version===1)i=ci(at.encode(t,this.bytes));else throw new Error("unsupported version");return t===this.multibaseName&&Object.defineProperty(this,"string",{value:i}),i}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(t){return this.toBaseEncodedString(t)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(t){return this.codec===t.codec&&this.version===t.version&&li(this.multihash,t.multihash)}static validateCID(t){const i=ai.checkCIDComponents(t);if(i)throw new Error(i)}static isCID(t){return t instanceof I||Boolean(t&&t[Lt])}}I.codecs=Je;var vt=I,_t={exports:{}};function Ht(e){if(e.stack&&e.name&&e.message)return e.stack.substring(e.name.length+3+e.message.length).split(`
`);if(e.stack)return e.stack.split(`
`)}function fi(e,t){return e.filter(function(i){return!~t.indexOf(i)})}_t.exports=function(e,t){if(!(e.stack&&e.name&&e.message))return console.error(new Error("stackless error")),e;var i=new Error(t),r=fi(Ht(i).slice(1),Ht(e)).join(`
`);return i.__proto__=e,i.stack=i.name+": "+i.message+`
`+r+`
  `+e.stack,i};const ui=vt,di=_t.exports;var hi=function(t){try{t=new ui(t)}catch(i){throw di(i,`invalid cid: ${t}`)}return t.version!==1&&(t=t.toV1()),t.toBaseEncodedString("base32")};const xi=gt.exports;var dn=function(){const t=[];for(const i of Object.values(xi.names))t.push({name:i.name,code:i.code});return t};const pi=vt;var hn=function(){const t=[];for(const[i,r]of Object.entries(pi.codecs))t.push({name:i,code:r});return t};const{bases:jt}=Cn;function xn(e,t,i,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:i},decoder:{decode:r}}}const Pt=xn("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ct=xn("ascii","a",e=>{let t="a";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},e=>{e=e.substring(1);const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}),ki={utf8:Pt,"utf-8":Pt,hex:jt.base16,latin1:ct,ascii:ct,binary:ct,...jt};var gi=ki;const mi=gi;function yi(e,t="utf8"){const i=mi[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return i.encoder.encode(e).substring(1)}var wi=yi;const vi=vt,_i=dn,Ti=hn,Si=_t.exports,dt=gt.exports,B=et,P=wi;var Ai=function(t,i){i=i||{};let r=i.format||"%s";if(r==="prefix"&&(r="%P"),!Mt(r)||r.indexOf("%")===-1)throw new Error(`invalid format string: ${r}`);const s=t;try{t=new vi(t)}catch(o){throw Si(o,`invalid cid: ${t}`)}if(i.cidVersion!=null&&t.version!==i.cidVersion)if(i.cidVersion===0)t=t.toV0();else if(i.cidVersion===1)t=t.toV1();else throw new Error(`invalid cid version: ${i.cidVersion}`);let c="base58btc";return i.base?c=pn(i.base).name:Mt(s)&&(c=dt.isEncoded(s)||c),r.replace(/%([a-zA-Z%])/g,Ei(t,c))};function Mt(e){return Object.prototype.toString.call(e)==="[object String]"}function Ei(e,t){return(r,s)=>{switch(s){case"%":return"%";case"b":return t;case"B":return pn(t).code;case"v":return`cidv${e.version}`;case"V":return e.version.toString();case"c":return e.codec;case"C":return Ii(e).toString();case"h":return B.decode(e.multihash).name;case"H":return B.decode(e.multihash).code.toString();case"L":return B.decode(e.multihash).length.toString();case"m":return P(dt.encode(t,e.multihash));case"M":return P(e.multihash,t);case"d":return P(dt.encode(t,B.decode(e.multihash).digest));case"D":return P(B.decode(e.multihash).digest,t);case"s":return e.toString(t);case"S":return e.version===1?e.toString(t).slice(1):P(e.bytes,t);case"P":return Oi(e);default:throw new Error(`unrecognized specifier in format string: ${s}`)}}}function pn(e){const t=_i().find(i=>i.code===e||i.name===e);if(!t)throw new Error(`invalid multibase: ${e}`);return t}function Ii(e){const t=Ti().find(i=>i.name===e.codec);if(!t)throw new Error(`invalid codec: ${e.codec}`);return t.code}function Oi(e){const{name:t,length:i}=B.decode(e.multihash);return`cidv${e.version}-${e.codec}-${t}-${i}`}const Ci=et;var Ui=function(){const t=[];for(const[i,r]of Object.entries(Ci.names))t.push({name:i,code:r});return t};R.base32=hi;R.bases=dn;R.codecs=hn;R.format=Ai;R.hashes=Ui;(function(e){e.exports=R})(en);const Ni=Un(en.exports);function Wi(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function kn(e,...t){if(!Wi(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Kt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $i(e,t){kn(e);const i=t.outputLen;if(e.length<i)throw new Error(`digestInto() expects output buffer of length at least ${i}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),E=(e,t)=>e<<32-t|e>>>t;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Fi(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function gn(e){return typeof e=="string"&&(e=Fi(e)),kn(e),e}class Bi{clone(){return this._cloneInto()}}function Di(e){const t=r=>e().update(gn(r)).digest(),i=e();return t.outputLen=i.outputLen,t.blockLen=i.blockLen,t.create=()=>e(),t}function Ri(e,t,i,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,i,r);const s=BigInt(32),c=BigInt(4294967295),o=Number(i>>s&c),f=Number(i&c),x=r?4:0,p=r?0:4;e.setUint32(t+x,o,r),e.setUint32(t+p,f,r)}const Li=(e,t,i)=>e&t^~e&i,Hi=(e,t,i)=>e&t^e&i^t&i;class ji extends Bi{constructor(t,i,r,s){super(),this.blockLen=t,this.outputLen=i,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=lt(this.buffer)}update(t){Kt(this);const{view:i,buffer:r,blockLen:s}=this;t=gn(t);const c=t.length;for(let o=0;o<c;){const f=Math.min(s-this.pos,c-o);if(f===s){const x=lt(t);for(;s<=c-o;o+=s)this.process(x,o);continue}r.set(t.subarray(o,o+f),this.pos),this.pos+=f,o+=f,this.pos===s&&(this.process(i,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Kt(this),$i(t,this),this.finished=!0;const{buffer:i,view:r,blockLen:s,isLE:c}=this;let{pos:o}=this;i[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let k=o;k<s;k++)i[k]=0;Ri(r,s-8,BigInt(this.length*8),c),this.process(r,0);const f=lt(t),x=this.outputLen;if(x%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const p=x/4,w=this.get();if(p>w.length)throw new Error("_sha2: outputLen bigger than state");for(let k=0;k<p;k++)f.setUint32(4*k,w[k],c)}digest(){const{buffer:t,outputLen:i}=this;this.digestInto(t);const r=t.slice(0,i);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:i,buffer:r,length:s,finished:c,destroyed:o,pos:f}=this;return t.length=s,t.pos=f,t.finished=c,t.destroyed=o,s%i&&t.buffer.set(r),t}}const Pi=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),U=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),N=new Uint32Array(64);class Mi extends ji{constructor(){super(64,32,8,!1),this.A=U[0]|0,this.B=U[1]|0,this.C=U[2]|0,this.D=U[3]|0,this.E=U[4]|0,this.F=U[5]|0,this.G=U[6]|0,this.H=U[7]|0}get(){const{A:t,B:i,C:r,D:s,E:c,F:o,G:f,H:x}=this;return[t,i,r,s,c,o,f,x]}set(t,i,r,s,c,o,f,x){this.A=t|0,this.B=i|0,this.C=r|0,this.D=s|0,this.E=c|0,this.F=o|0,this.G=f|0,this.H=x|0}process(t,i){for(let k=0;k<16;k++,i+=4)N[k]=t.getUint32(i,!1);for(let k=16;k<64;k++){const T=N[k-15],A=N[k-2],S=E(T,7)^E(T,18)^T>>>3,$=E(A,17)^E(A,19)^A>>>10;N[k]=$+N[k-7]+S+N[k-16]|0}let{A:r,B:s,C:c,D:o,E:f,F:x,G:p,H:w}=this;for(let k=0;k<64;k++){const T=E(f,6)^E(f,11)^E(f,25),A=w+T+Li(f,x,p)+Pi[k]+N[k]|0,$=(E(r,2)^E(r,13)^E(r,22))+Hi(r,s,c)|0;w=p,p=x,x=f,f=o+A|0,o=c,c=s,s=r,r=A+$|0}r=r+this.A|0,s=s+this.B|0,c=c+this.C|0,o=o+this.D|0,f=f+this.E|0,x=x+this.F|0,p=p+this.G|0,w=w+this.H|0,this.set(r,s,c,o,f,x,p,w)}roundClean(){N.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ki=Di(()=>new Mi);var zi={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.9.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2023
 * @license MIT
 */(function(e){(function(){var t="input is invalid type",i="finalize already called",r=typeof window=="object",s=r?window:{};s.JS_SHA3_NO_WINDOW&&(r=!1);var c=!r&&typeof self=="object",o=!s.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?s=Nn:c&&(s=self);for(var f=!s.JS_SHA3_NO_COMMON_JS&&!0&&e.exports,x=!s.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",p="0123456789abcdef".split(""),w=[31,7936,2031616,520093696],k=[4,1024,262144,67108864],T=[1,256,65536,16777216],A=[6,1536,393216,100663296],S=[0,8,16,24],$=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],At=[224,256,384,512],tt=[128,256],Et=["hex","buffer","arrayBuffer","array","digest"],It={128:168,256:136},wn=s.JS_SHA3_NO_NODE_JS||!Array.isArray?function(n){return Object.prototype.toString.call(n)==="[object Array]"}:Array.isArray,vn=x&&(s.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)?function(n){return typeof n=="object"&&n.buffer&&n.buffer.constructor===ArrayBuffer}:ArrayBuffer.isView,nt=function(n){var a=typeof n;if(a==="string")return[n,!0];if(a!=="object"||n===null)throw new Error(t);if(x&&n.constructor===ArrayBuffer)return[new Uint8Array(n),!1];if(!wn(n)&&!vn(n))throw new Error(t);return[n,!1]},Ot=function(n){return nt(n)[0].length===0},it=function(n){for(var a=[],l=0;l<n.length;++l)a[l]=n[l];return a},Ct=function(n,a,l){return function(b){return new v(n,a,n).update(b)[l]()}},Ut=function(n,a,l){return function(b,u){return new v(n,a,u).update(b)[l]()}},Nt=function(n,a,l){return function(b,u,d,g){return O["cshake"+n].update(b,u,d,g)[l]()}},Wt=function(n,a,l){return function(b,u,d,g){return O["kmac"+n].update(b,u,d,g)[l]()}},K=function(n,a,l,b){for(var u=0;u<Et.length;++u){var d=Et[u];n[d]=a(l,b,d)}return n},$t=function(n,a){var l=Ct(n,a,"hex");return l.create=function(){return new v(n,a,n)},l.update=function(b){return l.create().update(b)},K(l,Ct,n,a)},_n=function(n,a){var l=Ut(n,a,"hex");return l.create=function(b){return new v(n,a,b)},l.update=function(b,u){return l.create(u).update(b)},K(l,Ut,n,a)},Tn=function(n,a){var l=It[n],b=Nt(n,a,"hex");return b.create=function(u,d,g){return Ot(d)&&Ot(g)?O["shake"+n].create(u):new v(n,a,u).bytepad([d,g],l)},b.update=function(u,d,g,h){return b.create(d,g,h).update(u)},K(b,Nt,n,a)},Sn=function(n,a){var l=It[n],b=Wt(n,a,"hex");return b.create=function(u,d,g){return new st(n,a,d).bytepad(["KMAC",g],l).bytepad([u],l)},b.update=function(u,d,g,h){return b.create(u,g,h).update(d)},K(b,Wt,n,a)},Ft=[{name:"keccak",padding:T,bits:At,createMethod:$t},{name:"sha3",padding:A,bits:At,createMethod:$t},{name:"shake",padding:w,bits:tt,createMethod:_n},{name:"cshake",padding:k,bits:tt,createMethod:Tn},{name:"kmac",padding:k,bits:tt,createMethod:Sn}],O={},L=[],C=0;C<Ft.length;++C)for(var F=Ft[C],z=F.bits,H=0;H<z.length;++H){var rt=F.name+"_"+z[H];if(L.push(rt),O[rt]=F.createMethod(z[H],F.padding),F.name!=="sha3"){var Bt=F.name+z[H];L.push(Bt),O[Bt]=O[rt]}}function v(n,a,l){this.blocks=[],this.s=[],this.padding=a,this.outputBits=l,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(n<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=l>>5,this.extraBytes=(l&31)>>3;for(var b=0;b<50;++b)this.s[b]=0}v.prototype.update=function(n){if(this.finalized)throw new Error(i);var a=nt(n);n=a[0];for(var l=a[1],b=this.blocks,u=this.byteCount,d=n.length,g=this.blockCount,h=0,_=this.s,m,y;h<d;){if(this.reset)for(this.reset=!1,b[0]=this.block,m=1;m<g+1;++m)b[m]=0;if(l)for(m=this.start;h<d&&m<u;++h)y=n.charCodeAt(h),y<128?b[m>>2]|=y<<S[m++&3]:y<2048?(b[m>>2]|=(192|y>>6)<<S[m++&3],b[m>>2]|=(128|y&63)<<S[m++&3]):y<55296||y>=57344?(b[m>>2]|=(224|y>>12)<<S[m++&3],b[m>>2]|=(128|y>>6&63)<<S[m++&3],b[m>>2]|=(128|y&63)<<S[m++&3]):(y=65536+((y&1023)<<10|n.charCodeAt(++h)&1023),b[m>>2]|=(240|y>>18)<<S[m++&3],b[m>>2]|=(128|y>>12&63)<<S[m++&3],b[m>>2]|=(128|y>>6&63)<<S[m++&3],b[m>>2]|=(128|y&63)<<S[m++&3]);else for(m=this.start;h<d&&m<u;++h)b[m>>2]|=n[h]<<S[m++&3];if(this.lastByteIndex=m,m>=u){for(this.start=m-u,this.block=b[g],m=0;m<g;++m)_[m]^=b[m];j(_),this.reset=!0}else this.start=m}return this},v.prototype.encode=function(n,a){var l=n&255,b=1,u=[l];for(n=n>>8,l=n&255;l>0;)u.unshift(l),n=n>>8,l=n&255,++b;return a?u.push(b):u.unshift(b),this.update(u),u.length},v.prototype.encodeString=function(n){var a=nt(n);n=a[0];var l=a[1],b=0,u=n.length;if(l)for(var d=0;d<n.length;++d){var g=n.charCodeAt(d);g<128?b+=1:g<2048?b+=2:g<55296||g>=57344?b+=3:(g=65536+((g&1023)<<10|n.charCodeAt(++d)&1023),b+=4)}else b=u;return b+=this.encode(b*8),this.update(n),b},v.prototype.bytepad=function(n,a){for(var l=this.encode(a),b=0;b<n.length;++b)l+=this.encodeString(n[b]);var u=(a-l%a)%a,d=[];return d.length=u,this.update(d),this},v.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,a=this.lastByteIndex,l=this.blockCount,b=this.s;if(n[a>>2]|=this.padding[a&3],this.lastByteIndex===this.byteCount)for(n[0]=n[l],a=1;a<l+1;++a)n[a]=0;for(n[l-1]|=2147483648,a=0;a<l;++a)b[a]^=n[a];j(b)}},v.prototype.toString=v.prototype.hex=function(){this.finalize();for(var n=this.blockCount,a=this.s,l=this.outputBlocks,b=this.extraBytes,u=0,d=0,g="",h;d<l;){for(u=0;u<n&&d<l;++u,++d)h=a[u],g+=p[h>>4&15]+p[h&15]+p[h>>12&15]+p[h>>8&15]+p[h>>20&15]+p[h>>16&15]+p[h>>28&15]+p[h>>24&15];d%n===0&&(a=it(a),j(a),u=0)}return b&&(h=a[u],g+=p[h>>4&15]+p[h&15],b>1&&(g+=p[h>>12&15]+p[h>>8&15]),b>2&&(g+=p[h>>20&15]+p[h>>16&15])),g},v.prototype.arrayBuffer=function(){this.finalize();var n=this.blockCount,a=this.s,l=this.outputBlocks,b=this.extraBytes,u=0,d=0,g=this.outputBits>>3,h;b?h=new ArrayBuffer(l+1<<2):h=new ArrayBuffer(g);for(var _=new Uint32Array(h);d<l;){for(u=0;u<n&&d<l;++u,++d)_[d]=a[u];d%n===0&&(a=it(a),j(a))}return b&&(_[d]=a[u],h=h.slice(0,g)),h},v.prototype.buffer=v.prototype.arrayBuffer,v.prototype.digest=v.prototype.array=function(){this.finalize();for(var n=this.blockCount,a=this.s,l=this.outputBlocks,b=this.extraBytes,u=0,d=0,g=[],h,_;d<l;){for(u=0;u<n&&d<l;++u,++d)h=d<<2,_=a[u],g[h]=_&255,g[h+1]=_>>8&255,g[h+2]=_>>16&255,g[h+3]=_>>24&255;d%n===0&&(a=it(a),j(a))}return b&&(h=d<<2,_=a[u],g[h]=_&255,b>1&&(g[h+1]=_>>8&255),b>2&&(g[h+2]=_>>16&255)),g};function st(n,a,l){v.call(this,n,a,l)}st.prototype=new v,st.prototype.finalize=function(){return this.encode(this.outputBits,!0),v.prototype.finalize.call(this)};var j=function(n){var a,l,b,u,d,g,h,_,m,y,q,V,G,X,J,Y,Q,Z,ee,te,ne,ie,re,se,oe,ae,ce,le,be,fe,ue,de,he,xe,pe,ke,ge,me,ye,we,ve,_e,Te,Se,Ae,Ee,Ie,Oe,Ce,Ue,Ne,We,$e,Fe,Be,De,Re,Le,He,je,Pe,Me,Ke;for(b=0;b<48;b+=2)u=n[0]^n[10]^n[20]^n[30]^n[40],d=n[1]^n[11]^n[21]^n[31]^n[41],g=n[2]^n[12]^n[22]^n[32]^n[42],h=n[3]^n[13]^n[23]^n[33]^n[43],_=n[4]^n[14]^n[24]^n[34]^n[44],m=n[5]^n[15]^n[25]^n[35]^n[45],y=n[6]^n[16]^n[26]^n[36]^n[46],q=n[7]^n[17]^n[27]^n[37]^n[47],V=n[8]^n[18]^n[28]^n[38]^n[48],G=n[9]^n[19]^n[29]^n[39]^n[49],a=V^(g<<1|h>>>31),l=G^(h<<1|g>>>31),n[0]^=a,n[1]^=l,n[10]^=a,n[11]^=l,n[20]^=a,n[21]^=l,n[30]^=a,n[31]^=l,n[40]^=a,n[41]^=l,a=u^(_<<1|m>>>31),l=d^(m<<1|_>>>31),n[2]^=a,n[3]^=l,n[12]^=a,n[13]^=l,n[22]^=a,n[23]^=l,n[32]^=a,n[33]^=l,n[42]^=a,n[43]^=l,a=g^(y<<1|q>>>31),l=h^(q<<1|y>>>31),n[4]^=a,n[5]^=l,n[14]^=a,n[15]^=l,n[24]^=a,n[25]^=l,n[34]^=a,n[35]^=l,n[44]^=a,n[45]^=l,a=_^(V<<1|G>>>31),l=m^(G<<1|V>>>31),n[6]^=a,n[7]^=l,n[16]^=a,n[17]^=l,n[26]^=a,n[27]^=l,n[36]^=a,n[37]^=l,n[46]^=a,n[47]^=l,a=y^(u<<1|d>>>31),l=q^(d<<1|u>>>31),n[8]^=a,n[9]^=l,n[18]^=a,n[19]^=l,n[28]^=a,n[29]^=l,n[38]^=a,n[39]^=l,n[48]^=a,n[49]^=l,X=n[0],J=n[1],Ee=n[11]<<4|n[10]>>>28,Ie=n[10]<<4|n[11]>>>28,le=n[20]<<3|n[21]>>>29,be=n[21]<<3|n[20]>>>29,je=n[31]<<9|n[30]>>>23,Pe=n[30]<<9|n[31]>>>23,_e=n[40]<<18|n[41]>>>14,Te=n[41]<<18|n[40]>>>14,xe=n[2]<<1|n[3]>>>31,pe=n[3]<<1|n[2]>>>31,Y=n[13]<<12|n[12]>>>20,Q=n[12]<<12|n[13]>>>20,Oe=n[22]<<10|n[23]>>>22,Ce=n[23]<<10|n[22]>>>22,fe=n[33]<<13|n[32]>>>19,ue=n[32]<<13|n[33]>>>19,Me=n[42]<<2|n[43]>>>30,Ke=n[43]<<2|n[42]>>>30,Fe=n[5]<<30|n[4]>>>2,Be=n[4]<<30|n[5]>>>2,ke=n[14]<<6|n[15]>>>26,ge=n[15]<<6|n[14]>>>26,Z=n[25]<<11|n[24]>>>21,ee=n[24]<<11|n[25]>>>21,Ue=n[34]<<15|n[35]>>>17,Ne=n[35]<<15|n[34]>>>17,de=n[45]<<29|n[44]>>>3,he=n[44]<<29|n[45]>>>3,se=n[6]<<28|n[7]>>>4,oe=n[7]<<28|n[6]>>>4,De=n[17]<<23|n[16]>>>9,Re=n[16]<<23|n[17]>>>9,me=n[26]<<25|n[27]>>>7,ye=n[27]<<25|n[26]>>>7,te=n[36]<<21|n[37]>>>11,ne=n[37]<<21|n[36]>>>11,We=n[47]<<24|n[46]>>>8,$e=n[46]<<24|n[47]>>>8,Se=n[8]<<27|n[9]>>>5,Ae=n[9]<<27|n[8]>>>5,ae=n[18]<<20|n[19]>>>12,ce=n[19]<<20|n[18]>>>12,Le=n[29]<<7|n[28]>>>25,He=n[28]<<7|n[29]>>>25,we=n[38]<<8|n[39]>>>24,ve=n[39]<<8|n[38]>>>24,ie=n[48]<<14|n[49]>>>18,re=n[49]<<14|n[48]>>>18,n[0]=X^~Y&Z,n[1]=J^~Q&ee,n[10]=se^~ae&le,n[11]=oe^~ce&be,n[20]=xe^~ke&me,n[21]=pe^~ge&ye,n[30]=Se^~Ee&Oe,n[31]=Ae^~Ie&Ce,n[40]=Fe^~De&Le,n[41]=Be^~Re&He,n[2]=Y^~Z&te,n[3]=Q^~ee&ne,n[12]=ae^~le&fe,n[13]=ce^~be&ue,n[22]=ke^~me&we,n[23]=ge^~ye&ve,n[32]=Ee^~Oe&Ue,n[33]=Ie^~Ce&Ne,n[42]=De^~Le&je,n[43]=Re^~He&Pe,n[4]=Z^~te&ie,n[5]=ee^~ne&re,n[14]=le^~fe&de,n[15]=be^~ue&he,n[24]=me^~we&_e,n[25]=ye^~ve&Te,n[34]=Oe^~Ue&We,n[35]=Ce^~Ne&$e,n[44]=Le^~je&Me,n[45]=He^~Pe&Ke,n[6]=te^~ie&X,n[7]=ne^~re&J,n[16]=fe^~de&se,n[17]=ue^~he&oe,n[26]=we^~_e&xe,n[27]=ve^~Te&pe,n[36]=Ue^~We&Se,n[37]=Ne^~$e&Ae,n[46]=je^~Me&Fe,n[47]=Pe^~Ke&Be,n[8]=ie^~X&Y,n[9]=re^~J&Q,n[18]=de^~se&ae,n[19]=he^~oe&ce,n[28]=_e^~xe&ke,n[29]=Te^~pe&ge,n[38]=We^~Se&Ee,n[39]=$e^~Ae&Ie,n[48]=Me^~Fe&De,n[49]=Ke^~Be&Re,n[0]^=$[b],n[1]^=$[b+1]};if(f)e.exports=O;else for(C=0;C<L.length;++C)s[L[C]]=O[L[C]]})()})(zi);const qi=Object.prototype.toString,Vi="[object Uint8Array]";function Gi(e){return e?e.constructor===Uint8Array?!0:qi.call(e)===Vi:!1}function Xi(e){if(!Gi(e))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof e}\``)}const Ji=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Yi(e){Xi(e);let t="";for(let i=0;i<e.length;i++)t+=Ji[e[i]];return t}function Qi(e){return Ki(e)}function Zi(e){return Yi(Qi(e))}var er=typeof self=="object"?self.FormData:window.FormData;function tr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return typeof process<"u"&&process.env[e]?process.env[e]:t}const mn=".ipfscdn.io",nr=".thirdwebstorage-staging.com",ir=[`https://{clientId}${mn}/ipfs/{cid}/{path}`];function bt(e){const t=new URL(e).hostname;return t.endsWith(mn)?!0:t.endsWith(nr)}const rr=["https://{cid}.ipfs.cf-ipfs.com/{path}","https://{cid}.ipfs.dweb.link/{path}","https://ipfs.io/ipfs/{cid}/{path}","https://cloudflare-ipfs.com/ipfs/{cid}/{path}","https://{cid}.ipfs.w3s.link/{path}","https://w3s.link/ipfs/{cid}/{path}","https://nftstorage.link/ipfs/{cid}/{path}","https://gateway.pinata.cloud/ipfs/{cid}/{path}"],sr={"ipfs://":[...ir,...rr]},or=tr("CUSTOM_UPLOAD_SERVER_URL","https://storage.thirdweb.com");function ar(e){return Array.isArray(e)?{"ipfs://":e}:e||{}}function cr(e,t,i){const r=t.split("/"),s=br(r[0]),c=r.slice(1).join("/");let o=e;if(e.includes("{cid}")&&e.includes("{path}")?o=o.replace("{cid}",s).replace("{path}",c):e.includes("{cid}")?o=o.replace("{cid}",s):o+=`${s}/${c}`,e.includes("{clientId}")){if(!i)throw new Error("Cannot use {clientId} in gateway URL without providing a client ID");o=o.replace("{clientId}",i)}return o}function lr(e,t,i){const r={...sr,...e};for(const s of Object.keys(r)){const c=r[s].map(o=>{if(t&&o.includes("{clientId}"))return o.replace("{clientId}",t);if(i&&o.includes("{clientId}")){if(typeof window<"u")throw new Error("Cannot use secretKey in browser context");const x=Zi(i).slice(0,32);return o.replace("{clientId}",x)}else return o.includes("{clientId}")?void 0:o}).filter(o=>o!==void 0);r[s]=c}return r}function br(e){let t="";try{const i=e.split("/")[0];t=Ni.base32(i)}catch{throw new Error(`The CID ${e} is not valid.`)}return t}function zt(){return typeof window<"u"}function Ye(e){return globalThis.File&&e instanceof File}function D(e){return globalThis.Buffer&&e instanceof Buffer}function Qe(e){return!!(e&&e.name&&e.data&&typeof e.name=="string"&&(typeof e.data=="string"||D(e.data)))}function M(e){return Ye(e)||D(e)||Qe(e)}function fr(e,t){if(Ye(e)&&Ye(t)){if(e.name===t.name&&e.lastModified===t.lastModified&&e.size===t.size)return!0}else{if(D(e)&&D(t))return e.equals(t);if(Qe(e)&&Qe(t)&&e.name===t.name){if(typeof e.data=="string"&&typeof t.data=="string")return e.data===t.data;if(D(e.data)&&D(t.data))return e.data.equals(t.data)}}return!1}function ur(e,t){const i=e.replace("{cid}","(?<hash>[^/]+)").replace("{path}","(?<path>[^?#]+)"),r=new RegExp(i),s=t.match(r);if(s){const c=s.groups?.hash,o=s.groups?.path,f=t.includes("?")?t.substring(t.indexOf("?")+1):"";return{hash:c,path:o,query:f}}}function dr(e,t){for(const i of Object.keys(t))for(const r of t[i])if(r.includes("{cid}")){const s=ur(r,e);if(s?.hash&&s?.path){const c=s?.query?`?${s?.query}`:"";return`${i}${s?.hash}/${s?.path}${c}`}else return e}else if(e.startsWith(r))return e.replace(r,i);return e}function Tt(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const s=Object.keys(t).find(f=>e.startsWith(f)),c=s?t[s]:[];if(!s&&i>0||s&&i>=c.length)return;if(!s)return e;const o=e.replace(s,"");try{return cr(c[i],o,r)}catch{console.warn(`The IPFS uri: ${o} is not valid.`);return}}function ht(e,t){return typeof e=="string"?dr(e,t):typeof e=="object"?!e||M(e)?e:Array.isArray(e)?e.map(i=>ht(i,t)):Object.fromEntries(Object.entries(e).map(i=>{let[r,s]=i;return[r,ht(s,t)]})):e}function Ze(e,t,i){return typeof e=="string"?Tt(e,t,0,i):typeof e=="object"?!e||M(e)?e:Array.isArray(e)?e.map(r=>Ze(r,t,i)):Object.fromEntries(Object.entries(e).map(r=>{let[s,c]=r;return[s,Ze(c,t,i)]})):e}function xt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(M(e))return t.push(e),t;if(typeof e=="object"){if(!e)return t;Array.isArray(e)?e.forEach(i=>xt(i,t)):Object.keys(e).map(i=>xt(e[i],t))}return t}function pt(e,t){if(M(e)){if(t.length)return e=t.shift(),e;console.warn("Not enough URIs to replace all files in object.")}return typeof e=="object"?e&&(Array.isArray(e)?e.map(i=>pt(i,t)):Object.fromEntries(Object.entries(e).map(i=>{let[r,s]=i;return[r,pt(s,t)]}))):e}var qe={name:"@thirdweb-dev/storage",version:"2.0.15",main:"dist/thirdweb-dev-storage.cjs.js",module:"dist/thirdweb-dev-storage.esm.js",exports:{".":{module:"./dist/thirdweb-dev-storage.esm.js",default:"./dist/thirdweb-dev-storage.cjs.js"},"./package.json":"./package.json"},repository:"https://github.com/thirdweb-dev/js/tree/main/legacy_packages/storage",author:"thirdweb eng <eng@thirdweb.com>",license:"Apache-2.0",sideEffects:!1,scripts:{format:"prettier --write 'src/**/*'",lint:"eslint src/",fix:"eslint src/ --fix",clean:"rm -rf dist/",build:"tsc && preconstruct build",test:"vitest run",push:"yalc push",typedoc:"node scripts/typedoc.mjs"},files:["dist/"],preconstruct:{exports:!0},devDependencies:{"@microsoft/api-documenter":"^7.24.1","@microsoft/api-extractor":"^7.43.0","@microsoft/tsdoc":"^0.14.2","@preconstruct/cli":"2.7.0","@swc-node/register":"^1.9.0","@thirdweb-dev/tsconfig":"^0.1.7","@types/uuid":"^9.0.8",eslint:"8.57.0","eslint-config-thirdweb":"^0.1.9","eslint-plugin-tsdoc":"^0.2.17",esm:"^3.2.25",rimraf:"5.0.5","typedoc-gen":"^1.0.2",typescript:"5.4.4"},dependencies:{"@thirdweb-dev/crypto":"0.2.6","cid-tool":"^3.0.0","form-data":"^4.0.0",uuid:"^9.0.1"},engines:{node:">=18"}};const qt=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function hr(e){for(let t=0,i=qt.length;t<i;t++){const r=qt[t];if(!r)continue;const[s,c]=r;if(c.exec(e))return s}return null}function Vt(){if(typeof navigator<"u"&&navigator.product==="ReactNative")return"";if(typeof window<"u"){const e=navigator.userAgent;return hr(e)||""}else return process.platform}function yn(e){const t=St();e["x-sdk-version"]=t.x_sdk_version,e["x-sdk-name"]=t.x_sdk_name,e["x-sdk-platform"]=t.x_sdk_platform,e["x-sdk-os"]=t.x_sdk_os,t.app_bundle_id&&(e["x-bundle-id"]=t.app_bundle_id)}function xr(e){const t=St();e.setRequestHeader("x-sdk-version",t.x_sdk_version),e.setRequestHeader("x-sdk-os",t.x_sdk_os),e.setRequestHeader("x-sdk-name",t.x_sdk_name),e.setRequestHeader("x-sdk-platform",t.x_sdk_platform),t.app_bundle_id&&e.setRequestHeader("x-bundle-id",t.app_bundle_id)}function St(){return typeof globalThis>"u"?{x_sdk_name:qe.name,x_sdk_platform:Gt(),x_sdk_version:qe.version,x_sdk_os:Vt(),app_bundle_id:void 0}:(globalThis.X_SDK_NAME===void 0&&(globalThis.X_SDK_NAME=qe.name,globalThis.X_SDK_PLATFORM=Gt(),globalThis.X_SDK_VERSION=qe.version,globalThis.X_SDK_OS=Vt(),globalThis.APP_BUNDLE_ID=void 0),{x_sdk_name:globalThis.X_SDK_NAME,x_sdk_platform:globalThis.X_SDK_PLATFORM,x_sdk_version:globalThis.X_SDK_VERSION,x_sdk_os:globalThis.X_SDK_OS,app_bundle_id:globalThis.APP_BUNDLE_ID||""})}function Gt(){return typeof navigator<"u"&&navigator.product==="ReactNative"?"mobile":typeof window<"u"?"browser":"node"}class pr{constructor(t){ot(this,"DEFAULT_TIMEOUT_IN_SECONDS",60);ot(this,"DEFAULT_MAX_RETRIES",3);this.secretKey=t.secretKey,this.clientId=t.clientId,this.defaultTimeout=t.timeoutInSeconds||this.DEFAULT_TIMEOUT_IN_SECONDS}async download(t,i,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const c=r?.maxRetries||this.DEFAULT_MAX_RETRIES;if(s>c)return console.error("[FAILED_TO_DOWNLOAD_ERROR] Failed to download from URI - too many attempts failed."),new Response(JSON.stringify({error:"Not Found"}),{status:404,headers:{"Content-Type":"application/json"}});let o=Tt(t,i,s,this.clientId);if(o)s>0&&console.warn(`Retrying download with backup gateway URL: ${o}`);else return console.error("[FAILED_TO_DOWNLOAD_ERROR] Unable to download from URI - all gateway URLs failed to respond."),new Response(JSON.stringify({error:"Not Found"}),{status:404,headers:{"Content-Type":"application/json"}});let f={};if(bt(o)){const T=St().app_bundle_id;this.secretKey?f={"x-secret-key":this.secretKey}:this.clientId&&(!o.includes("bundleId")&&T&&(o=o+(T?`?bundleId=${T}`:"")),f["x-client-Id"]=this.clientId),typeof globalThis<"u"&&"TW_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_AUTH_TOKEN=="string"&&(f={...f,authorization:`Bearer ${globalThis.TW_AUTH_TOKEN}`}),typeof globalThis<"u"&&"TW_CLI_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_CLI_AUTH_TOKEN=="string"&&(f={...f,authorization:`Bearer ${globalThis.TW_CLI_AUTH_TOKEN}`},f["x-authorize-wallet"]="true"),yn(f)}if(kr(o))return this.download(t,i,r,s+1);const x=new AbortController,p=r?.timeoutInSeconds||this.defaultTimeout,w=setTimeout(()=>x.abort(),p*1e3),k=await fetch(o,{headers:f,signal:x.signal}).catch(T=>T);if(w&&clearTimeout(w),!("status"in k))throw new Error(`Request timed out after ${p} seconds. ${bt(o)?"You can update the timeoutInSeconds option to increase the timeout.":"You're using a public IPFS gateway, pass in a clientId or secretKey for a reliable IPFS gateway."}`);return k.ok?k:k.status===429?(gr(o,k),this.download(t,i,r,s+1)):k.status===410?(console.error(`Request to ${o} failed because this content seems to be blocklisted. Search VirusTotal for this URL to confirm: ${o} `),k):(console.warn(`Request to ${o} failed with status ${k.status} - ${k.statusText}`),k.status===404&&bt(o)||k.status!==408&&k.status!==429&&k.status<500?k:this.download(t,i,r,s+1))}}const kt=new Map;function kr(e){return kt.has(e)}const ft=new Map;function gr(e,t){ft.has(e)&&clearTimeout(ft.get(e));const i=t.headers.get("Retry-After");let r=5e3;if(i){const s=parseInt(i);isNaN(s)||(r=s*1e3)}kt.set(e,!0),ft.set(e,setTimeout(()=>kt.delete(e),r))}class mr{constructor(t){this.uploadWithGatewayUrl=t?.uploadWithGatewayUrl||!1,this.uploadServerUrl=t?.uploadServerUrl||or,this.clientId=t?.clientId,this.secretKey=t?.secretKey}async uploadBatch(t,i){if(i?.uploadWithoutDirectory&&t.length>1)throw new Error("[UPLOAD_WITHOUT_DIRECTORY_ERROR] Cannot upload more than one file or object without directory!");const r=new er,{form:s,fileNames:c}=this.buildFormData(r,t,i);return zt()?this.uploadBatchBrowser(s,c,i):this.uploadBatchNode(s,c,i)}buildFormData(t,i,r){const s=new Map,c=[];for(let f=0;f<i.length;f++){const x=i[f];let p="",w=x;if(Ye(x))if(r?.rewriteFileNames){let T="";if(x.name){const A=x.name.lastIndexOf(".");A>-1&&(T=x.name.substring(A))}p=`${f+r.rewriteFileNames.fileStartNumber}${T}`}else p=`${x.name}`;else Qe(x)?(w=x.data,r?.rewriteFileNames?p=`${f+r.rewriteFileNames.fileStartNumber}`:p=`${x.name}`):r?.rewriteFileNames?p=`${f+r.rewriteFileNames.fileStartNumber}`:p=`${f}`;const k=r?.uploadWithoutDirectory?"files":`files/${p}`;if(s.has(p)){if(fr(s.get(p),x)){c.push(p);continue}throw new Error(`[DUPLICATE_FILE_NAME_ERROR] File name ${p} was passed for more than one different file.`)}s.set(p,x),c.push(p),zt()?t.append("file",new Blob([w]),k):t.append("file",w,{filepath:k})}const o={name:"Storage SDK",keyvalues:{...r?.metadata}};return t.append("pinataMetadata",JSON.stringify(o)),r?.uploadWithoutDirectory&&t.append("pinataOptions",JSON.stringify({wrapWithDirectory:!1})),{form:t,fileNames:c.map(f=>encodeURIComponent(f))}}async uploadBatchBrowser(t,i,r){return new Promise((s,c)=>{const o=new XMLHttpRequest;let f=setTimeout(()=>{o.abort(),c(new Error("Request to upload timed out! No upload progress received in 30s"))},3e4);o.upload.addEventListener("loadstart",()=>{console.log(`[${Date.now()}] [IPFS] Started`)}),o.upload.addEventListener("progress",x=>{console.log(`[IPFS] Progress Event ${x.loaded}/${x.total}`),clearTimeout(f),x.loaded<x.total?f=setTimeout(()=>{o.abort(),c(new Error("Request to upload timed out! No upload progress received in 30s"))},3e4):console.log(`[${Date.now()}] [IPFS] Uploaded files. Waiting for response.`),x.lengthComputable&&r?.onProgress&&r?.onProgress({progress:x.loaded,total:x.total})}),o.addEventListener("load",()=>{if(console.log(`[${Date.now()}] [IPFS] Load`),clearTimeout(f),o.status>=200&&o.status<300){let x;try{x=JSON.parse(o.responseText)}catch{return c(new Error("Failed to parse JSON from upload response"))}const p=x.IpfsHash;if(!p)throw new Error("Failed to get IPFS hash from upload response");return r?.uploadWithoutDirectory?s([`ipfs://${p}`]):s(i.map(w=>`ipfs://${p}/${w}`))}return c(new Error(`Upload failed with status ${o.status} - ${o.responseText}`))}),o.addEventListener("error",()=>(console.log("[IPFS] Load"),clearTimeout(f),o.readyState!==0&&o.readyState!==4||o.status===0?c(new Error("Upload failed due to a network error.")):c(new Error("Unknown upload error occured")))),o.open("POST",`${this.uploadServerUrl}/ipfs/upload`),this.secretKey?o.setRequestHeader("x-secret-key",this.secretKey):this.clientId&&o.setRequestHeader("x-client-id",this.clientId),xr(o),typeof globalThis<"u"&&"TW_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_AUTH_TOKEN=="string"&&o.setRequestHeader("authorization",`Bearer ${globalThis.TW_AUTH_TOKEN}`),typeof globalThis<"u"&&"TW_CLI_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_CLI_AUTH_TOKEN=="string"&&(o.setRequestHeader("authorization",`Bearer ${globalThis.TW_CLI_AUTH_TOKEN}`),o.setRequestHeader("x-authorize-wallet","true")),o.send(t)})}async uploadBatchNode(t,i,r){r?.onProgress&&console.warn("The onProgress option is only supported in the browser");const s={};this.secretKey?s["x-secret-key"]=this.secretKey:this.clientId&&(s["x-client-id"]=this.clientId),typeof globalThis<"u"&&"TW_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_AUTH_TOKEN=="string"&&(s.authorization=`Bearer ${globalThis.TW_AUTH_TOKEN}`),typeof globalThis<"u"&&"TW_CLI_AUTH_TOKEN"in globalThis&&typeof globalThis.TW_CLI_AUTH_TOKEN=="string"&&(s.authorization=`Bearer ${globalThis.TW_CLI_AUTH_TOKEN}`,s["x-authorize-wallet"]="true"),yn(s);const c=await fetch(`${this.uploadServerUrl}/ipfs/upload`,{method:"POST",headers:{...s,...t.getHeaders()},body:t.getBuffer()});if(!c.ok)throw c.status===401?new Error("Unauthorized - You don't have permission to use this service."):new Error(`Failed to upload files to IPFS - ${c.status} - ${c.statusText} - ${await c.text()}`);const f=(await c.json()).IpfsHash;if(!f)throw new Error("Failed to upload files to IPFS - Bad CID");return r?.uploadWithoutDirectory?[`ipfs://${f}`]:i.map(x=>`ipfs://${f}/${x}`)}}class yr{constructor(t){this.uploader=t?.uploader||new mr({clientId:t?.clientId,secretKey:t?.secretKey,uploadServerUrl:t?.uploadServerUrl}),this.downloader=t?.downloader||new pr({secretKey:t?.secretKey,clientId:t?.clientId}),this.gatewayUrls=lr(ar(t?.gatewayUrls),t?.clientId,t?.secretKey),this.clientId=t?.clientId}resolveScheme(t){return Tt(t,this.gatewayUrls,0,this.clientId)}async download(t,i){return this.downloader.download(t,this.gatewayUrls,i)}async downloadJSON(t,i){const s=await(await this.download(t,i)).json();return Ze(s,this.gatewayUrls,this.clientId)}async upload(t,i){const[r]=await this.uploadBatch([t],i);return r}async uploadBatch(t,i){if(t=t.filter(c=>c!==void 0),!t.length)return[];const r=t.map(c=>M(c)||typeof c=="string").every(c=>!!c);let s=[];if(r)s=await this.uploader.uploadBatch(t,i);else{const c=(await this.uploadAndReplaceFilesWithHashes(t,i)).map(o=>typeof o=="string"?o:JSON.stringify(o));s=await this.uploader.uploadBatch(c,i)}return i?.uploadWithGatewayUrl||this.uploader.uploadWithGatewayUrl?s.map(c=>this.resolveScheme(c)):s}getGatewayUrls(){return this.gatewayUrls}async uploadAndReplaceFilesWithHashes(t,i){let r=t;r=ht(r,this.gatewayUrls);const s=xt(r);if(s.length){const c=await this.uploader.uploadBatch(s,i);r=pt(r,c)}return(i?.uploadWithGatewayUrl||this.uploader.uploadWithGatewayUrl)&&(r=Ze(r,this.gatewayUrls,this.clientId)),r}}const Xt=5e3;async function _r(e){const t=Wn();return await new yr({clientId:t.thirdwebClientId}).upload(e)}function Jt(e){let t;return e.startsWith("https://ipfs.io/ipfs/")?t=e.replace("https://ipfs.io/ipfs/",""):e.startsWith("https://cloudflare-ipfs.com/ipfs/")?t=e.replace("https://cloudflare-ipfs.com/ipfs/",""):e.startsWith("https://gateway.pinata.cloud/ipfs/")?t=e.replace("https://gateway.pinata.cloud/ipfs/",""):e.startsWith("https://ipfs.infura.io/ipfs/")?t=e.replace("https://ipfs.infura.io/ipfs/",""):e.startsWith("https://ipfs.fleek.co/ipfs/")?t=e.replace("https://ipfs.fleek.co/ipfs/",""):e.startsWith("https://dweb.link/ipfs/")?t=e.replace("https://dweb.link/ipfs/",""):e.startsWith("https://ipfs.itslit.org/ipfs/")?t=e.replace("https://ipfs.itslit.org/ipfs/",""):e.startsWith("https://ipfs.dylmusic.com/ipfs/")?t=e.replace("https://ipfs.dylmusic.com/ipfs/",""):e.startsWith("https://ipfs.filebase.io/ipfs/")?t=e.replace("https://ipfs.filebase.io/ipfs/",""):e.includes("pinata.cloud/ipfs/")?(t=e.split(".pinata.cloud/ipfs/")[1],t=t.replace("http://",""),t=t.replace("https://","")):e.includes(".ipfs.sphn.link/")&&(t=e.split(".ipfs.sphn.link/")[1],t=t.replace("http://",""),t=t.replace("https://","")),t?String("ipfs://"+t):null}async function Tr(e){let t=e;if(e.startsWith("http"))try{const r=await Dt.head(e,{signal:AbortSignal.timeout(Xt)});if(r.status===200)return{success:!0,url:e,format:r.headers["content-type"]};t=Jt(e)}catch{t=Jt(e)}if(!t)return e;const i=["https://ipfs.io/ipfs/","https://nftdegeniggy.myfilebase.com/ipfs/","https://ipfs.filebase.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://ipfs.itslit.org/ipfs/","https://ipfs.dylmusic.com/ipfs/"];if(t.startsWith("ipfs://")){const r=t.replace("ipfs://","");for(let s=0;s<i.length;s++){const c=i[s]+r;try{const o=await Dt.head(c,{signal:AbortSignal.timeout(Xt)});if(o.status===200)return{success:!0,url:c,format:o.headers["content-type"]}}catch{continue}}}return e}export{Jt as a,Tr as g,_r as u};
